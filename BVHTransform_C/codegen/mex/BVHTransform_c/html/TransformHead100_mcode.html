<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,301" id="srcline301">301</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,302" id="srcline302">302</a></span><span class="line"><span class="comment">%% TransformHead</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,303" id="srcline303">303</a></span><span class="line"><span class="comment">% E_spine_head: euler from spine3 to head</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,304" id="srcline304">304</a></span><span class="line"><span class="comment">% rotateOrder : rotate order of "E_spine_head"</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,305" id="srcline305">305</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S311T3U1489">HeadYaw</span>,<span class="var type1" id="S312T3U1490">HeadPitch</span>,<span class="var type1" id="S313T7U1491">Head_new</span> ] = TransformHead(  <span class="var type1" id="S314T20U1494">C_Spine_Head</span>,<span class="var type1" id="S315T20U1495">C_Spine_NeckNew</span>,<span class="var type1" id="S316T3U1496">rotateOrder_BVH</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,306" id="srcline306">306</a></span><span class="line">coder.inline(<span class="string">'never'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,307" id="srcline307">307</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,308" id="srcline308">308</a></span><span class="line"><span class="mxinfo" id="T7:U7"><span class="var type1" id="S318T7U1505">rotateDirection_BVH</span> = <span class="mxinfo" id="T7:U9">[1,1,1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,309" id="srcline309">309</a></span><span class="line"><span class="mxinfo" id="T3:U10"><span class="var type1" id="S319T3U1513">Head_rotateOrder</span> = <span class="mxinfo" id="T3:U12">213</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,310" id="srcline310">310</a></span><span class="line"><span class="mxinfo" id="T20:U13"><span class="var type1" id="S320T20U1517">C_NeckNew_Spine</span> = <span class="mxinfo" id="T20:U15"><span class="fcn" id="F81N13:B1519">InverseC_Multi</span>( <span class="var type1" id="S315T20U1520">C_Spine_NeckNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,311" id="srcline311">311</a></span><span class="line"><span class="mxinfo" id="T20:U17"><span class="var type1" id="S322T20U1523">C_NeckNew_Head</span> = <span class="mxinfo" id="T20:U19"><span class="fcn" id="F78N5:B1525">CalculateC_Multi</span>( <span class="var type1" id="S320T20U1526">C_NeckNew_Spine</span>,<span class="var type1" id="S314T20U1527">C_Spine_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,312" id="srcline312">312</a></span><span class="line"><span class="mxinfo" id="T7:U22"><span class="var type1" id="S324T7U1530">E_Spine_Head</span> = <span class="mxinfo" id="T7:U24"><span class="fcn" id="F99N4:B1532">CToEuler_c</span>( <span class="var type1" id="S322T20U1533">C_NeckNew_Head</span>,<span class="mxinfo" id="T3:U26"><span class="var type1" id="S319T3U1534">Head_rotateOrder</span></span>,<span class="mxinfo" id="T7:U28"><span class="var type1" id="S318T7U1535">rotateDirection_BVH</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,313" id="srcline313">313</a></span><span class="line"><span class="mxinfo" id="T3:U30"><span class="mxinfo" id="T3:U31"><span class="var type1" id="S324T7U1539">E_Spine_Head</span>(:,<span class="mxinfo" id="T3:U33">3</span>)</span> = <span class="mxinfo" id="T3:U34">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,314" id="srcline314">314</a></span><span class="line"><span class="mxinfo" id="T3:U35"><span class="var type1" id="S311T3U1545">HeadYaw</span> = <span class="mxinfo" id="T3:U37"><span class="var type1" id="S324T7U1548">E_Spine_Head</span>(:,<span class="mxinfo" id="T3:U39">1</span>)</span>'</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,315" id="srcline315">315</a></span><span class="line"><span class="mxinfo" id="T3:U40"><span class="var type1" id="S312T3U1553">HeadPitch</span> = <span class="mxinfo" id="T3:U42"><span class="var type1" id="S324T7U1556">E_Spine_Head</span>(:,<span class="mxinfo" id="T3:U44">2</span>)</span>'</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,316" id="srcline316">316</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,317" id="srcline317">317</a></span><span class="line"><span class="comment">%%% get new BVH</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,318" id="srcline318">318</a></span><span class="line"><span class="mxinfo" id="T20:U45"><span class="var type1" id="S326T20U1561">C_Spine_HeadNew</span> = <span class="mxinfo" id="T20:U47"><span class="fcn" id="F48N11:B1563">EulerToC_c</span>( <span class="var type1" id="S324T7U1564">E_Spine_Head</span>,<span class="mxinfo" id="T3:U49"><span class="var type1" id="S319T3U1565">Head_rotateOrder</span></span> ,<span class="mxinfo" id="T7:U51">[1,1,1]</span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,319" id="srcline319">319</a></span><span class="line"><span class="mxinfo" id="T7:U52"><span class="var type1" id="S313T7U1573">Head_new</span> = <span class="mxinfo" id="T7:U54"><span class="fcn" id="F99N4:B1575">CToEuler_c</span>( <span class="var type1" id="S326T20U1576">C_Spine_HeadNew</span>,<span class="var type1" id="S316T3U1577">rotateOrder_BVH</span>,<span class="mxinfo" id="T7:U57"><span class="var type1" id="S318T7U1578">rotateDirection_BVH</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,320" id="srcline320">320</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,321" id="srcline321">321</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,322" id="srcline322">322</a></span><span class="line"><span class="comment">%% RightShoulder</span></span></span>
</pre>
