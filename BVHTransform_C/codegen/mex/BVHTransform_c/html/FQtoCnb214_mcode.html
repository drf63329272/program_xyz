<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,929" id="srcline929">929</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,930" id="srcline930">930</a></span><span class="line"><span class="comment">%% 四元数 -&gt; 方向余弦矩阵</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,931" id="srcline931">931</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S799T13U5850">Cnb</span> = FQtoCnb(<span class="var type1" id="S800T38U5853">Q</span>) <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,932" id="srcline932">932</a></span><span class="line">coder.inline(<span class="string">'never'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,933" id="srcline933">933</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,934" id="srcline934">934</a></span><span class="line"><span class="mxinfo" id="T38:U3"><span class="var type1" id="S800T38U5862">Q</span>=<span class="mxinfo" id="T38:U5"><span class="var type1" id="S800T38U5864">Q</span>/<span class="mxinfo" id="T3:U7">norm(<span class="var type1" id="S800T38U5867">Q</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,935" id="srcline935">935</a></span><span class="line"><span class="mxinfo" id="T3:U9"><span class="var type1" id="S803T3U5870">q0</span> = <span class="mxinfo" id="T3:U11"><span class="var type1" id="S800T38U5872">Q</span>(<span class="mxinfo" id="T3:U13">1</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,936" id="srcline936">936</a></span><span class="line"><span class="mxinfo" id="T3:U14"><span class="var type1" id="S804T3U5876">q1</span> = <span class="mxinfo" id="T3:U16"><span class="var type1" id="S800T38U5878">Q</span>(<span class="mxinfo" id="T3:U18">2</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,937" id="srcline937">937</a></span><span class="line"><span class="mxinfo" id="T3:U19"><span class="var type1" id="S805T3U5882">q2</span> = <span class="mxinfo" id="T3:U21"><span class="var type1" id="S800T38U5884">Q</span>(<span class="mxinfo" id="T3:U23">3</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,938" id="srcline938">938</a></span><span class="line"><span class="mxinfo" id="T3:U24"><span class="var type1" id="S806T3U5888">q3</span> = <span class="mxinfo" id="T3:U26"><span class="var type1" id="S800T38U5890">Q</span>(<span class="mxinfo" id="T3:U28">4</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,939" id="srcline939">939</a></span><span class="line"><span class="mxinfo" id="T13:U29"><span class="var type1" id="S799T13U5894">Cnb</span>=<span class="mxinfo" id="T13:U31">[   <span class="mxinfo" id="T7:U32"><span class="mxinfo" id="T3:U33"><span class="mxinfo" id="T3:U34"><span class="mxinfo" id="T3:U35"><span class="mxinfo" id="T3:U36"><span class="var type1" id="S803T3U5901">q0</span>^2</span>+<span class="mxinfo" id="T3:U38"><span class="var type1" id="S804T3U5904">q1</span>^2</span></span>-<span class="mxinfo" id="T3:U40"><span class="var type1" id="S805T3U5907">q2</span>^2</span></span>-<span class="mxinfo" id="T3:U42"><span class="var type1" id="S806T3U5910">q3</span>^2</span></span>,    <span class="mxinfo" id="T3:U44"><span class="mxinfo" id="T3:U45">2</span>*(<span class="mxinfo" id="T3:U46"><span class="mxinfo" id="T3:U47"><span class="var type1" id="S804T3U5917">q1</span>*<span class="var type1" id="S805T3U5918">q2</span></span>+<span class="mxinfo" id="T3:U50"><span class="var type1" id="S803T3U5920">q0</span>*<span class="var type1" id="S806T3U5921">q3</span></span></span>)</span>,            <span class="mxinfo" id="T3:U53"><span class="mxinfo" id="T3:U54">2</span>*(<span class="mxinfo" id="T3:U55"><span class="mxinfo" id="T3:U56"><span class="var type1" id="S804T3U5927">q1</span>*<span class="var type1" id="S806T3U5928">q3</span></span>-<span class="mxinfo" id="T3:U59"><span class="var type1" id="S803T3U5930">q0</span>*<span class="var type1" id="S805T3U5931">q2</span></span></span>)</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,940" id="srcline940">940</a></span><span class="line"><span class="mxinfo" id="T13:U29"><span class="mxinfo" id="T13:U31">        <span class="mxinfo" id="T7:U62"><span class="mxinfo" id="T3:U63"><span class="mxinfo" id="T3:U64">2</span>*(<span class="mxinfo" id="T3:U65"><span class="mxinfo" id="T3:U66"><span class="var type1" id="S804T3U5938">q1</span>*<span class="var type1" id="S805T3U5939">q2</span></span>-<span class="mxinfo" id="T3:U69"><span class="var type1" id="S803T3U5941">q0</span>*<span class="var type1" id="S806T3U5942">q3</span></span></span>)</span>,        <span class="mxinfo" id="T3:U72"><span class="mxinfo" id="T3:U73"><span class="mxinfo" id="T3:U74"><span class="mxinfo" id="T3:U75"><span class="var type1" id="S803T3U5947">q0</span>*<span class="var type1" id="S803T3U5948">q0</span></span>-<span class="mxinfo" id="T3:U78"><span class="var type1" id="S804T3U5950">q1</span>*<span class="var type1" id="S804T3U5951">q1</span></span></span>+<span class="mxinfo" id="T3:U81"><span class="var type1" id="S805T3U5953">q2</span>*<span class="var type1" id="S805T3U5954">q2</span></span></span>-<span class="mxinfo" id="T3:U84"><span class="var type1" id="S806T3U5956">q3</span>*<span class="var type1" id="S806T3U5957">q3</span></span></span>,    <span class="mxinfo" id="T3:U87"><span class="mxinfo" id="T3:U88">2</span>*(<span class="mxinfo" id="T3:U89"><span class="mxinfo" id="T3:U90"><span class="var type1" id="S805T3U5963">q2</span>*<span class="var type1" id="S806T3U5964">q3</span></span>+<span class="mxinfo" id="T3:U93"><span class="var type1" id="S803T3U5966">q0</span>*<span class="var type1" id="S804T3U5967">q1</span></span></span>)</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,941" id="srcline941">941</a></span><span class="line"><span class="mxinfo" id="T13:U29"><span class="mxinfo" id="T13:U31">        <span class="mxinfo" id="T7:U96"><span class="mxinfo" id="T3:U97"><span class="mxinfo" id="T3:U98">2</span>*(<span class="mxinfo" id="T3:U99"><span class="mxinfo" id="T3:U100"><span class="var type1" id="S804T3U5974">q1</span>*<span class="var type1" id="S806T3U5975">q3</span></span>+<span class="mxinfo" id="T3:U103"><span class="var type1" id="S803T3U5977">q0</span>*<span class="var type1" id="S805T3U5978">q2</span></span></span>)</span>,        <span class="mxinfo" id="T3:U106"><span class="mxinfo" id="T3:U107">2</span>*(<span class="mxinfo" id="T3:U108"><span class="mxinfo" id="T3:U109"><span class="var type1" id="S805T3U5984">q2</span>*<span class="var type1" id="S806T3U5985">q3</span></span>-<span class="mxinfo" id="T3:U112"><span class="var type1" id="S803T3U5987">q0</span>*<span class="var type1" id="S804T3U5988">q1</span></span></span>)</span>,            <span class="mxinfo" id="T3:U115"><span class="mxinfo" id="T3:U116"><span class="mxinfo" id="T3:U117"><span class="mxinfo" id="T3:U118"><span class="var type1" id="S803T3U5993">q0</span>*<span class="var type1" id="S803T3U5994">q0</span></span>-<span class="mxinfo" id="T3:U121"><span class="var type1" id="S804T3U5996">q1</span>*<span class="var type1" id="S804T3U5997">q1</span></span></span>-<span class="mxinfo" id="T3:U124"><span class="var type1" id="S805T3U5999">q2</span>*<span class="var type1" id="S805T3U6000">q2</span></span></span>+<span class="mxinfo" id="T3:U127"><span class="var type1" id="S806T3U6002">q3</span>*<span class="var type1" id="S806T3U6003">q3</span></span></span></span>     ]</span></span>;</span></span>
</pre>
