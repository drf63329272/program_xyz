<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="comment">%% xyz  2015.3.25</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% Transform BVH data Format</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% BVHData: 1*354  degree</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% NaoData: 25*1 degree</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%   function NaoData = BVHTransform_c( BVHData )</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T39U3">NaoData</span>,<span class="var type1" id="S3T7U4">ROOT_Hips_RotationNew</span> ] = BVHTransform_c( <span class="var type1" id="S4T1U7">BVHData</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="mxinfo" id="T2:U4"><span class="var type1" id="S4T2U10">BVHData</span> = <span class="mxinfo" id="T2:U6">double(<span class="var type1" id="S4T1U13">BVHData</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="mxinfo" id="T7:U8"><span class="var type1" id="S6T7U16">ROOT_Hips_Position</span> = <span class="mxinfo" id="T7:U10"><span class="var type1" id="S4T2U18">BVHData</span>(:,<span class="mxinfo" id="T7:U12"><span class="mxinfo" id="T3:U13">1</span>:<span class="mxinfo" id="T3:U14">3</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="mxinfo" id="T2:U15"><span class="var type1" id="S4T2U25">BVHData</span> = <span class="mxinfo" id="T2:U17"><span class="mxinfo" id="T2:U18"><span class="var type1" id="S4T2U28">BVHData</span>*<span class="mxinfo" id="T3:U20">pi</span></span>/<span class="mxinfo" id="T3:U21">180</span></span></span> ; </span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="mxinfo" id="T7:U22"><span class="mxinfo" id="T7:U23"><span class="var type1" id="S4T2U35">BVHData</span>(:,<span class="mxinfo" id="T7:U25"><span class="mxinfo" id="T3:U26">1</span>:<span class="mxinfo" id="T3:U27">3</span></span>)</span> = <span class="var type1" id="S6T7U40">ROOT_Hips_Position</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="mxinfo" id="T3:U29"><span class="var type1" id="S8T3U43">Nframes</span> = <span class="mxinfo" id="T3:U31">size(<span class="var type1" id="S4T2U46">BVHData</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="mxinfo" id="T3:U33"><span class="var type1" id="S10T3U50">rotateOrder_BVH</span> = <span class="mxinfo" id="T3:U35">213</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="mxinfo" id="T7:U36"><span class="var type1" id="S11T7U54">rotateDirection_BVH</span> = <span class="mxinfo" id="T7:U38">[1,1,1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo" id="T20:U39">[ <span class="var type1" id="S12T20U63">C_World_Hip</span>,<span class="var type1" id="S13T20U64">C_Hip_Spine</span>,<span class="var type1" id="S14T20U65">C_Spine_Spine1</span>,<span class="var type1" id="S15T20U66">C_Spine1_Spine2</span>,<span class="var type1" id="S16T20U67">C_Spine2_Spine3</span>,<span class="var type1" id="S17T20U68">C_Spine3_Neck</span>,<span class="var type1" id="S18T20U69">C_Neck_Head</span>,<span class="var type1" id="S19T20U70">C_Spine3_LShoulder</span>,<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="mxinfo" id="T20:U39"><span class="var type1" id="S20T20U71">C_LShoulder_LArm</span>,<span class="var type1" id="S21T20U72">C_LArm_LForeArm</span>,<span class="var type1" id="S22T20U73">C_LForeArm_LHand</span>,<span class="var type1" id="S23T20U74">C_Spine3_RShoulder</span>,<span class="var type1" id="S24T20U75">C_RShoulder_RArm</span>,<span class="var type1" id="S25T20U76">C_RArm_RForeArm</span>,<span class="var type1" id="S26T20U77">C_RForeArm_RHand</span>,<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo" id="T20:U39"><span class="var type1" id="S27T20U78">C_Hip_RUpLeg</span>,<span class="var type1" id="S28T20U79">C_RUpLeg_RLeg</span>,<span class="var type1" id="S29T20U80">C_RLeg_RFoot</span>,<span class="var type1" id="S30T20U81">C_Hip_LUpLeg</span>,<span class="var type1" id="S31T20U82">C_LUpLeg_LLeg</span>,<span class="var type1" id="S32T20U83">C_LLeg_LFoot</span> ] = <span class="fcn" id="F49N3:B85">BVHDataToRotate_c</span>( <span class="var type1" id="S4T2U86">BVHData</span>,<span class="mxinfo" id="T3:U62"><span class="var type1" id="S10T3U87">rotateOrder_BVH</span></span>,<span class="mxinfo" id="T7:U64"><span class="var type1" id="S11T7U88">rotateDirection_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%% 所有BVH的旋转数据</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="mxinfo" id="T20:U66">[ <span class="var type1" id="S34T20U92">C_Hip_Spine2</span>,<span class="var type1" id="S35T20U93">C_Hip_Spine3</span>,<span class="var type1" id="S36T20U94">C_Spine_Spine3</span>, <span class="var type1" id="S37T20U95">C_Hip_LArm</span>,<span class="var type1" id="S38T20U96">C_Hip_LForeArm</span>,<span class="var type1" id="S39T20U97">C_Hip_LHand</span>, <span class="var type1" id="S40T20U98">C_Spine_LArm</span>,<span class="var type1" id="S41T20U99">C_Spine_LForeArm</span>,<span class="var type1" id="S42T20U100">C_Spine_LHand</span>, <span class="var type1" id="S43T20U101">C_Spine2_LArm</span>,<span class="var type1" id="S44T20U102">C_Spine2_LForeArm</span>,<span class="var type1" id="S45T20U103">C_Spine2_LHand</span>,<span class="var type1" id="S46T20U104">C_Spine3_LArm</span>,<span class="var type1" id="S47T20U105">C_Spine3_LForeArm</span>,<span class="var type1" id="S48T20U106">C_Spine3_LHand</span> ]  = <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="mxinfo" id="T20:U66">    <span class="fcn" id="F79N7:B108">CalculatedLeftArmRotate</span>( <span class="var type1" id="S13T20U109">C_Hip_Spine</span>,<span class="var type1" id="S14T20U110">C_Spine_Spine1</span>,<span class="var type1" id="S15T20U111">C_Spine1_Spine2</span>,<span class="var type1" id="S16T20U112">C_Spine2_Spine3</span>,<span class="var type1" id="S19T20U113">C_Spine3_LShoulder</span>,<span class="var type1" id="S20T20U114">C_LShoulder_LArm</span>,<span class="var type1" id="S21T20U115">C_LArm_LForeArm</span>,<span class="var type1" id="S22T20U116">C_LForeArm_LHand</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="mxinfo" id="T20:U90">[ <span class="var type1" id="S50T20U120">C_Hip_RArm</span>,<span class="var type1" id="S51T20U121">C_Hip_RForeArm</span>,<span class="var type1" id="S52T20U122">C_Hip_RHand</span>, <span class="var type1" id="S53T20U123">C_Spine_RArm</span>,<span class="var type1" id="S54T20U124">C_Spine_RForeArm</span>,<span class="var type1" id="S55T20U125">C_Spine_RHand</span>, <span class="var type1" id="S56T20U126">C_Spine2_RArm</span>,<span class="var type1" id="S57T20U127">C_Spine2_RForeArm</span>,<span class="var type1" id="S58T20U128">C_Spine2_RHand</span>,<span class="var type1" id="S59T20U129">C_Spine3_RArm</span>,<span class="var type1" id="S60T20U130">C_Spine3_RForeArm</span>,<span class="var type1" id="S61T20U131">C_Spine3_RHand</span> ]  = <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="mxinfo" id="T20:U90">    <span class="fcn" id="F80N9:B133">CalculatedRightArmRotate</span>( <span class="var type1" id="S35T20U134">C_Hip_Spine3</span>,<span class="var type1" id="S16T20U135">C_Spine2_Spine3</span>,<span class="var type1" id="S36T20U136">C_Spine_Spine3</span>,<span class="var type1" id="S23T20U137">C_Spine3_RShoulder</span>,<span class="var type1" id="S24T20U138">C_RShoulder_RArm</span>,<span class="var type1" id="S25T20U139">C_RArm_RForeArm</span>,<span class="var type1" id="S26T20U140">C_RForeArm_RHand</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="mxinfo" id="T20:U110">[ <span class="var type1" id="S63T20U144">C_Hip_LLeg</span>,<span class="var type1" id="S64T20U145">C_Spine2_LLeg</span>,<span class="var type1" id="S65T20U146">C_Spine3_LLeg</span> ] = <span class="fcn" id="F82N6:B148">CalculatedLLegRotate</span>( <span class="var type1" id="S34T20U149">C_Hip_Spine2</span>,<span class="var type1" id="S35T20U150">C_Hip_Spine3</span>,<span class="var type1" id="S30T20U151">C_Hip_LUpLeg</span>,<span class="var type1" id="S31T20U152">C_LUpLeg_LLeg</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="mxinfo" id="T20:U118">[ <span class="var type1" id="S67T20U156">C_Hip_RLeg</span>,<span class="var type1" id="S68T20U157">C_Spine2_RLeg</span>,<span class="var type1" id="S69T20U158">C_Spine3_RLeg</span> ] = <span class="fcn" id="F83N8:B160">CalculatedRLegRotate</span>( <span class="var type1" id="S34T20U161">C_Hip_Spine2</span>,<span class="var type1" id="S35T20U162">C_Hip_Spine3</span>,<span class="var type1" id="S27T20U163">C_Hip_RUpLeg</span>,<span class="var type1" id="S28T20U164">C_RUpLeg_RLeg</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="mxinfo" id="T3:U126"><span class="var type1" id="S71T3U167">HipYawPitch</span> = <span class="mxinfo" id="T3:U128">zeros(1,size(<span class="var type1" id="S13T20U173">C_Hip_Spine</span>,1))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">%% common parameters to set</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">% reference joint : 'Hip'  'SPine'  'Spine3'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="mxinfo" id="T28:U130"><span class="var type1" id="S73T28U177">refJoint1</span> = <span class="mxinfo" id="T28:U132"><span class="string">'Spine2'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="mxinfo" id="T28:U133"><span class="var type1" id="S74T28U181">referenceOfHead</span> = <span class="var type1" id="S73T28U182">refJoint1</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo" id="T28:U136"><span class="var type1" id="S75T28U185">referenceOfArm</span> = <span class="var type1" id="S73T28U186">refJoint1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo" id="T28:U139"><span class="var type1" id="S76T28U189">referenceOfForeArm</span> = <span class="var type1" id="S73T28U190">refJoint1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="mxinfo" id="T28:U142"><span class="var type1" id="S77T28U193">referenceOfHand</span> =  <span class="var type1" id="S73T28U194">refJoint1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="mxinfo" id="T7:U145"><span class="var type1" id="S78T7U197">E_0</span> = <span class="mxinfo" id="T7:U147">zeros( <span class="var type1" id="S8T3U200">Nframes</span>,3 )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="mxinfo" id="T7:U149"><span class="var type1" id="S79T7U204">RightShoulder_new</span> = <span class="var type1" id="S78T7U205">E_0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="mxinfo" id="T7:U152"><span class="var type1" id="S80T7U208">LeftShoulder_new</span> = <span class="mxinfo" id="T7:U154"><span class="var type1" id="S78T7U209">E_0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo" id="T7:U156"><span class="var type1" id="S81T7U212">Spine3_new</span> = <span class="var type1" id="S78T7U213">E_0</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="mxinfo" id="T7:U159"><span class="var type1" id="S82T7U216">Spine2_new</span> = <span class="var type1" id="S78T7U217">E_0</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="mxinfo" id="T7:U162"><span class="var type1" id="S83T7U220">Spine_new</span> = <span class="var type1" id="S78T7U221">E_0</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="mxinfo" id="T7:U165"><span class="var type1" id="S84T7U224">Neck_new</span> = <span class="var type1" id="S78T7U225">E_0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="mxinfo" id="T20:U168"><span class="var type1" id="S85T20U228">C_I</span> = <span class="mxinfo" id="T20:U170">zeros( <span class="mxinfo" id="T3:U171"><span class="var type1" id="S8T3U231">Nframes</span></span>,<span class="mxinfo" id="T3:U173">3</span>,<span class="mxinfo" id="T3:U174">3</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S86T3U236">k</span>=<span class="mxinfo" id="T3:U176">1:<span class="var type1" id="S8T3U239">Nframes</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">    <span class="mxinfo" id="T20:U178"><span class="mxinfo" id="T20:U179"><span class="var type1" id="S85T20U243">C_I</span>(<span class="mxinfo" id="T3:U181"><span class="var type1" id="S86T3U244">k</span></span>,:,:)</span> = <span class="mxinfo" id="T13:U183">[<span class="mxinfo" id="T7:U184"><span class="mxinfo" id="T3:U185">1</span> <span class="mxinfo" id="T3:U186">0</span> <span class="mxinfo" id="T3:U187">0</span></span>; <span class="mxinfo" id="T7:U188"><span class="mxinfo" id="T3:U189">0</span> <span class="mxinfo" id="T3:U190">1</span> <span class="mxinfo" id="T3:U191">0</span></span>; <span class="mxinfo" id="T7:U192"><span class="mxinfo" id="T3:U193">0</span> <span class="mxinfo" id="T3:U194">0</span> <span class="mxinfo" id="T3:U195">1</span></span> ]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="mxinfo" id="T20:U196"><span class="var type1" id="S87T20U262">C_Spine3New_NeckNew</span> = <span class="var type1" id="S85T20U263">C_I</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="mxinfo" id="T20:U199"><span class="var type1" id="S88T20U266">C_Spine2New_Spine3New</span> = <span class="var type1" id="S85T20U267">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="mxinfo" id="T20:U202"><span class="var type1" id="S89T20U270">C_SpineNew_Spine3New</span> = <span class="var type1" id="S85T20U271">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="mxinfo" id="T20:U205"><span class="var type1" id="S90T20U274">C_HipNew_Spine3New</span> = <span class="var type1" id="S85T20U275">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="mxinfo" id="T20:U208"><span class="var type1" id="S91T20U278">C_Spine3New_LShoulderNew</span> = <span class="var type1" id="S85T20U279">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="mxinfo" id="T20:U211"><span class="var type1" id="S92T20U282">C_Spine3New_RShoulderNew</span> = <span class="var type1" id="S85T20U283">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"><span class="comment">%%% New Hip</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="mxinfo" id="T20:U214"><span class="var type1" id="S93T20U286">C_World_Spine2</span> = <span class="mxinfo" id="T20:U216"><span class="fcn" id="F78N5:B288">CalculateC_Multi</span>( <span class="var type1" id="S12T20U289">C_World_Hip</span>,<span class="var type1" id="S34T20U290">C_Hip_Spine2</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="mxinfo" id="T7:U219"><span class="var type1" id="S95T7U293">E_World_Spine2</span> = <span class="mxinfo" id="T7:U221"><span class="fcn" id="F99N4:B295">CToEuler_c</span>( <span class="var type1" id="S93T20U296">C_World_Spine2</span>,<span class="mxinfo" id="T3:U223"><span class="var type1" id="S10T3U297">rotateOrder_BVH</span></span>,<span class="mxinfo" id="T7:U225"><span class="var type1" id="S11T7U298">rotateDirection_BVH</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="mxinfo" id="T7:U227"><span class="var type1" id="S3T7U301">ROOT_Hips_RotationNew</span> = <span class="var type1" id="S95T7U302">E_World_Spine2</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="comment">%% head</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="mxinfo" id="T20:U230"><span class="var type1" id="S97T20U305">C_Spine3_Head</span> = <span class="mxinfo" id="T20:U232"><span class="fcn" id="F78N5:B307">CalculateC_Multi</span>( <span class="var type1" id="S17T20U308">C_Spine3_Neck</span>,<span class="var type1" id="S18T20U309">C_Neck_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"><span class="mxinfo" id="T20:U235"><span class="var type1" id="S98T20U312">C_Spine2_Head</span> = <span class="mxinfo" id="T20:U237"><span class="fcn" id="F78N5:B314">CalculateC_Multi</span>( <span class="var type1" id="S16T20U315">C_Spine2_Spine3</span>,<span class="var type1" id="S97T20U316">C_Spine3_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line"><span class="mxinfo" id="T20:U240"><span class="var type1" id="S99T20U319">C_Spine_Head</span> = <span class="mxinfo" id="T20:U242"><span class="fcn" id="F78N5:B321">CalculateC_Multi</span>( <span class="var type1" id="S36T20U322">C_Spine_Spine3</span>,<span class="var type1" id="S97T20U323">C_Spine3_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="mxinfo" id="T20:U245"><span class="var type1" id="S100T20U326">C_Hip_Head</span> = <span class="mxinfo" id="T20:U247"><span class="fcn" id="F78N5:B328">CalculateC_Multi</span>( <span class="var type1" id="S35T20U329">C_Hip_Spine3</span>,<span class="var type1" id="S97T20U330">C_Spine3_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"><span class="mxinfo" id="T20:U250"><span class="var type1" id="S101T20U333">C_Spine2New_NeckNew</span> = <span class="mxinfo" id="T20:U252"><span class="fcn" id="F78N5:B335">CalculateC_Multi</span>( <span class="var type1" id="S88T20U336">C_Spine2New_Spine3New</span>,<span class="var type1" id="S87T20U337">C_Spine3New_NeckNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"><span class="mxinfo" id="T20:U255"><span class="var type1" id="S102T20U340">C_SpineNew_NeckNew</span> = <span class="mxinfo" id="T20:U257"><span class="fcn" id="F78N5:B342">CalculateC_Multi</span>( <span class="var type1" id="S89T20U343">C_SpineNew_Spine3New</span>,<span class="var type1" id="S87T20U344">C_Spine3New_NeckNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="mxinfo" id="T20:U260"><span class="var type1" id="S103T20U347">C_HipNew_NeckNew</span> = <span class="mxinfo" id="T20:U262"><span class="fcn" id="F78N5:B349">CalculateC_Multi</span>( <span class="var type1" id="S90T20U350">C_HipNew_Spine3New</span>,<span class="var type1" id="S87T20U351">C_Spine3New_NeckNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"><span class="mxinfo" id="T20:U265"><span class="var type1" id="S104T20U354">C_RefHead_Head</span> = <span class="var type1" id="S98T20U355">C_Spine2_Head</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"><span class="mxinfo" id="T20:U268"><span class="var type1" id="S105T20U358">C_RefHeadNew_NeckNew</span> = <span class="var type1" id="S101T20U359">C_Spine2New_NeckNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"><span class="mxinfo" id="T3:U271">[ <span class="var type1" id="S106T3U363">HeadYaw</span>,<span class="var type1" id="S107T3U364">HeadPitch</span>,<span class="var type1" id="S108T7U365">Head_new</span> ] = <span class="fcn" id="F100N19:B367">TransformHead</span>(  <span class="var type1" id="S104T20U368">C_RefHead_Head</span>,<span class="var type1" id="S105T20U369">C_RefHeadNew_NeckNew</span>,<span class="mxinfo" id="T3:U277"><span class="var type1" id="S10T3U370">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"><span class="comment">%% Right Shoulder</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"><span class="mxinfo" id="T20:U279"><span class="var type1" id="S110T20U373">C_Spine2New_RShoulderNew</span> = <span class="mxinfo" id="T20:U281"><span class="fcn" id="F78N5:B375">CalculateC_Multi</span>( <span class="var type1" id="S88T20U376">C_Spine2New_Spine3New</span>,<span class="var type1" id="S92T20U377">C_Spine3New_RShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"><span class="mxinfo" id="T20:U284"><span class="var type1" id="S111T20U380">C_SpineNew_RShoulderNew</span> = <span class="mxinfo" id="T20:U286"><span class="fcn" id="F78N5:B382">CalculateC_Multi</span>( <span class="var type1" id="S89T20U383">C_SpineNew_Spine3New</span>,<span class="var type1" id="S92T20U384">C_Spine3New_RShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line"><span class="mxinfo" id="T20:U289"><span class="var type1" id="S112T20U387">C_HipNew_RShoulderNew</span> = <span class="mxinfo" id="T20:U291"><span class="fcn" id="F78N5:B389">CalculateC_Multi</span>( <span class="var type1" id="S90T20U390">C_HipNew_Spine3New</span>,<span class="var type1" id="S92T20U391">C_Spine3New_RShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line"><span class="mxinfo" id="T20:U294"><span class="var type1" id="S113T20U394">C_RefArm_RArm</span> = <span class="var type1" id="S56T20U395">C_Spine2_RArm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"><span class="mxinfo" id="T20:U297"><span class="var type1" id="S114T20U398">C_RefArmNew_RShoulderNew</span> = <span class="var type1" id="S110T20U399">C_Spine2New_RShoulderNew</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line"><span class="comment">% dbstop in TransformRShoulder</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line"><span class="mxinfo" id="T3:U300">[ <span class="var type1" id="S115T3U403">RShoulderPitch</span>,<span class="var type1" id="S116T3U404">RShoulderRoll</span>,<span class="var type1" id="S117T7U405">RightArm_new</span> ] = <span class="fcn" id="F153N30:B407">TransformRShoulder</span>(  <span class="var type1" id="S114T20U408">C_RefArmNew_RShoulderNew</span>,<span class="var type1" id="S113T20U409">C_RefArm_RArm</span>,<span class="mxinfo" id="T3:U306"><span class="var type1" id="S10T3U410">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line"><span class="comment">%% Right Elbow</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line"><span class="mxinfo" id="T20:U308"><span class="var type1" id="S119T20U413">C_RShoulderNew_RArmNew</span> = <span class="mxinfo" id="T20:U310"><span class="fcn" id="F48N11:B415">EulerToC_c</span>( <span class="var type1" id="S117T7U416">RightArm_new</span>,<span class="mxinfo" id="T3:U312"><span class="var type1" id="S10T3U417">rotateOrder_BVH</span></span>,<span class="mxinfo" id="T7:U314">[1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line"><span class="mxinfo" id="T20:U315"><span class="var type1" id="S121T20U425">C_Spine3New_RArmNew</span> = <span class="mxinfo" id="T20:U317"><span class="fcn" id="F78N5:B427">CalculateC_Multi</span>( <span class="var type1" id="S92T20U428">C_Spine3New_RShoulderNew</span>,<span class="var type1" id="S119T20U429">C_RShoulderNew_RArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"><span class="mxinfo" id="T20:U320"><span class="var type1" id="S122T20U432">C_Spine2New_RArmNew</span> = <span class="mxinfo" id="T20:U322"><span class="fcn" id="F78N5:B434">CalculateC_Multi</span>( <span class="var type1" id="S110T20U435">C_Spine2New_RShoulderNew</span>,<span class="var type1" id="S119T20U436">C_RShoulderNew_RArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line"><span class="mxinfo" id="T20:U325"><span class="var type1" id="S123T20U439">C_SpineNew_RArmNew</span> = <span class="mxinfo" id="T20:U327"><span class="fcn" id="F78N5:B441">CalculateC_Multi</span>( <span class="var type1" id="S89T20U442">C_SpineNew_Spine3New</span>,<span class="var type1" id="S121T20U443">C_Spine3New_RArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line"><span class="mxinfo" id="T20:U330"><span class="var type1" id="S124T20U446">C_HipNew_RArmNew</span> = <span class="mxinfo" id="T20:U332"><span class="fcn" id="F78N5:B448">CalculateC_Multi</span>( <span class="var type1" id="S90T20U449">C_HipNew_Spine3New</span>,<span class="var type1" id="S121T20U450">C_Spine3New_RArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line"><span class="mxinfo" id="T20:U335"><span class="var type1" id="S125T20U453">C_RefArm_RForeArm</span> = <span class="var type1" id="S57T20U454">C_Spine2_RForeArm</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line"><span class="mxinfo" id="T20:U338"><span class="var type1" id="S126T20U457">C_RefArmNew_RArmNew</span> = <span class="var type1" id="S122T20U458">C_Spine2New_RArmNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line"><span class="mxinfo" id="T7:U341">[ <span class="var type1" id="S127T7U462">RElbow_Nao</span>,<span class="var type1" id="S128T7U463">RightForeArm_new</span> ] = <span class="fcn" id="F168N26:B465">TransformRElbow</span>( <span class="var type1" id="S125T20U466">C_RefArm_RForeArm</span>,<span class="var type1" id="S126T20U467">C_RefArmNew_RArmNew</span>,<span class="mxinfo" id="T3:U346"><span class="var type1" id="S10T3U468">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"><span class="mxinfo" id="T3:U348">[ <span class="var type1" id="S130T3U472">RElbowYaw</span>,<span class="var type1" id="S131T3U473">RElbowRoll</span> ] = deal( <span class="mxinfo" id="T3:U351"><span class="var type1" id="S127T7U478">RElbow_Nao</span>(:,<span class="mxinfo" id="T3:U353">1</span>)</span>',<span class="mxinfo" id="T3:U354"><span class="var type1" id="S127T7U483">RElbow_Nao</span>(:,<span class="mxinfo" id="T3:U356">2</span>)</span>' )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line"><span class="comment">%% RHand</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line"><span class="mxinfo" id="T20:U357"><span class="var type1" id="S133T20U488">C_RArmNew_RForeArmNew</span> = <span class="mxinfo" id="T20:U359"><span class="fcn" id="F48N11:B490">EulerToC_c</span>( <span class="var type1" id="S128T7U491">RightForeArm_new</span>,<span class="mxinfo" id="T3:U361"><span class="var type1" id="S10T3U492">rotateOrder_BVH</span></span>,<span class="mxinfo" id="T7:U363">[1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="mxinfo" id="T20:U364"><span class="var type1" id="S134T20U500">C_Spine3New_RForeArmNew</span> = <span class="mxinfo" id="T20:U366"><span class="fcn" id="F78N5:B502">CalculateC_Multi</span>( <span class="var type1" id="S121T20U503">C_Spine3New_RArmNew</span>,<span class="var type1" id="S133T20U504">C_RArmNew_RForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"><span class="mxinfo" id="T20:U369"><span class="var type1" id="S135T20U507">C_Spine2New_RForeArmNew</span> = <span class="mxinfo" id="T20:U371"><span class="fcn" id="F78N5:B509">CalculateC_Multi</span>( <span class="var type1" id="S122T20U510">C_Spine2New_RArmNew</span>,<span class="var type1" id="S133T20U511">C_RArmNew_RForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line"><span class="mxinfo" id="T20:U374"><span class="var type1" id="S136T20U514">C_SpineNew_RForeArmNew</span> = <span class="mxinfo" id="T20:U376"><span class="fcn" id="F78N5:B516">CalculateC_Multi</span>( <span class="var type1" id="S89T20U517">C_SpineNew_Spine3New</span>,<span class="var type1" id="S134T20U518">C_Spine3New_RForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="mxinfo" id="T20:U379"><span class="var type1" id="S137T20U521">C_HipNew_RForeArmNew</span> = <span class="mxinfo" id="T20:U381"><span class="fcn" id="F78N5:B523">CalculateC_Multi</span>( <span class="var type1" id="S90T20U524">C_HipNew_Spine3New</span>,<span class="var type1" id="S134T20U525">C_Spine3New_RForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line"><span class="mxinfo" id="T20:U384"><span class="var type1" id="S138T20U528">C_RefArm_RHand</span> = <span class="var type1" id="S58T20U529">C_Spine2_RHand</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line"><span class="mxinfo" id="T20:U387"><span class="var type1" id="S139T20U532">C_RefArmNew_RForeArmNew</span> = <span class="var type1" id="S135T20U533">C_Spine2New_RForeArmNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line"><span class="mxinfo" id="T3:U390">[ <span class="var type1" id="S140T3U537">RWristYaw</span>,<span class="var type1" id="S141T7U538">RightHand_new</span> ] = <span class="fcn" id="F170N28:B540">TransformRHand</span>( <span class="var type1" id="S138T20U541">C_RefArm_RHand</span>,<span class="var type1" id="S139T20U542">C_RefArmNew_RForeArmNew</span>,<span class="mxinfo" id="T3:U395"><span class="var type1" id="S10T3U543">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line"><span class="comment">%% Left Shoulder</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line"><span class="mxinfo" id="T20:U397"><span class="var type1" id="S143T20U546">C_Spine2New_LShoulderNew</span> = <span class="mxinfo" id="T20:U399"><span class="fcn" id="F78N5:B548">CalculateC_Multi</span>( <span class="var type1" id="S88T20U549">C_Spine2New_Spine3New</span>,<span class="var type1" id="S91T20U550">C_Spine3New_LShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line"><span class="mxinfo" id="T20:U402"><span class="var type1" id="S144T20U553">C_SpineNew_LShoulderNew</span> = <span class="mxinfo" id="T20:U404"><span class="fcn" id="F78N5:B555">CalculateC_Multi</span>( <span class="var type1" id="S89T20U556">C_SpineNew_Spine3New</span>,<span class="var type1" id="S91T20U557">C_Spine3New_LShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line"><span class="mxinfo" id="T20:U407"><span class="var type1" id="S145T20U560">C_HipNew_LShoulderNew</span> = <span class="mxinfo" id="T20:U409"><span class="fcn" id="F78N5:B562">CalculateC_Multi</span>( <span class="var type1" id="S90T20U563">C_HipNew_Spine3New</span>,<span class="var type1" id="S91T20U564">C_Spine3New_LShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line"><span class="mxinfo" id="T20:U412"><span class="var type1" id="S146T20U567">C_RefArm_LArm</span> = <span class="var type1" id="S43T20U568">C_Spine2_LArm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line"><span class="mxinfo" id="T20:U415"><span class="var type1" id="S147T20U571">C_RefArmNew_LShoulderNew</span> = <span class="var type1" id="S143T20U572">C_Spine2New_LShoulderNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line"><span class="mxinfo" id="T3:U418">[ <span class="var type1" id="S148T3U576">LShoulderPitch</span>,<span class="var type1" id="S149T3U577">LShoulderRoll</span>,<span class="var type1" id="S150T7U578">LeftArm_new</span> ] = <span class="fcn" id="F173N24:B580">TransformLShoulder</span>(  <span class="var type1" id="S147T20U581">C_RefArmNew_LShoulderNew</span>,<span class="var type1" id="S146T20U582">C_RefArm_LArm</span>,<span class="mxinfo" id="T3:U424"><span class="var type1" id="S10T3U583">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line"><span class="comment">%% Left Elbow</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line"><span class="mxinfo" id="T20:U426"><span class="var type1" id="S91T20U586">C_Spine3New_LShoulderNew</span> = <span class="mxinfo" id="T20:U428"><span class="fcn" id="F48N11:B588">EulerToC_c</span>( <span class="var type1" id="S80T7U589">LeftShoulder_new</span>,<span class="var type1" id="S10T3U590">rotateOrder_BVH</span>,[1,1,1] )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line"><span class="mxinfo" id="T20:U431"><span class="var type1" id="S152T20U598">C_LShoulderNew_LArmNew</span> = <span class="mxinfo" id="T20:U433"><span class="fcn" id="F48N11:B600">EulerToC_c</span>( <span class="var type1" id="S150T7U601">LeftArm_new</span>,<span class="mxinfo" id="T3:U435"><span class="var type1" id="S10T3U602">rotateOrder_BVH</span></span>,<span class="mxinfo" id="T7:U437">[1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line"><span class="mxinfo" id="T20:U438"><span class="var type1" id="S153T20U610">C_Spine3New_LArmNew</span> = <span class="mxinfo" id="T20:U440"><span class="fcn" id="F78N5:B612">CalculateC_Multi</span>( <span class="mxinfo" id="T20:U441"><span class="var type1" id="S91T20U613">C_Spine3New_LShoulderNew</span></span>,<span class="var type1" id="S152T20U614">C_LShoulderNew_LArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line"><span class="mxinfo" id="T20:U444"><span class="var type1" id="S154T20U617">C_Spine2New_LArmNew</span> = <span class="mxinfo" id="T20:U446"><span class="fcn" id="F78N5:B619">CalculateC_Multi</span>( <span class="var type1" id="S88T20U620">C_Spine2New_Spine3New</span>,<span class="var type1" id="S153T20U621">C_Spine3New_LArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line"><span class="mxinfo" id="T20:U449"><span class="var type1" id="S155T20U624">C_SpineNew_LArmNew</span> = <span class="mxinfo" id="T20:U451"><span class="fcn" id="F78N5:B626">CalculateC_Multi</span>( <span class="var type1" id="S89T20U627">C_SpineNew_Spine3New</span>,<span class="var type1" id="S153T20U628">C_Spine3New_LArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line"><span class="mxinfo" id="T20:U454"><span class="var type1" id="S156T20U631">C_HipNew_LArmNew</span> = <span class="mxinfo" id="T20:U456"><span class="fcn" id="F78N5:B633">CalculateC_Multi</span>( <span class="var type1" id="S90T20U634">C_HipNew_Spine3New</span>,<span class="var type1" id="S153T20U635">C_Spine3New_LArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line"><span class="mxinfo" id="T20:U459"><span class="var type1" id="S157T20U638">C_RefArm_LForeArm</span> = <span class="var type1" id="S44T20U639">C_Spine2_LForeArm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line"><span class="mxinfo" id="T20:U462"><span class="var type1" id="S158T20U642">C_RefArmNew_LArmNew</span> = <span class="var type1" id="S154T20U643">C_Spine2New_LArmNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line"><span class="mxinfo" id="T7:U465">[ <span class="var type1" id="S159T7U647">LElbow_Nao</span>,<span class="var type1" id="S160T7U648">LeftForeArm_new</span> ] = <span class="fcn" id="F174N20:B650">TransformLElbow</span>( <span class="var type1" id="S157T20U651">C_RefArm_LForeArm</span>,<span class="var type1" id="S158T20U652">C_RefArmNew_LArmNew</span>,<span class="mxinfo" id="T3:U470"><span class="var type1" id="S10T3U653">rotateOrder_BVH</span></span> )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line"><span class="mxinfo" id="T3:U472">[ <span class="var type1" id="S162T3U657">LElbowYaw</span>,<span class="var type1" id="S163T3U658">LElbowRoll</span> ] = deal( <span class="mxinfo" id="T3:U475"><span class="var type1" id="S159T7U663">LElbow_Nao</span>(:,<span class="mxinfo" id="T3:U477">1</span>)</span>',<span class="mxinfo" id="T3:U478"><span class="var type1" id="S159T7U668">LElbow_Nao</span>(:,<span class="mxinfo" id="T3:U480">2</span>)</span>' )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line"><span class="comment">%% LHand</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line"><span class="mxinfo" id="T20:U481"><span class="var type1" id="S164T20U673">C_LArmNew_LForeArmNew</span> = <span class="mxinfo" id="T20:U483"><span class="fcn" id="F48N11:B675">EulerToC_c</span>( <span class="var type1" id="S160T7U676">LeftForeArm_new</span>,<span class="mxinfo" id="T3:U485"><span class="var type1" id="S10T3U677">rotateOrder_BVH</span></span> ,<span class="mxinfo" id="T7:U487">[1,1,1]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line"><span class="mxinfo" id="T20:U488"><span class="var type1" id="S165T20U685">C_Spine3New_LForeArmNew</span> = <span class="mxinfo" id="T20:U490"><span class="fcn" id="F78N5:B687">CalculateC_Multi</span>( <span class="var type1" id="S153T20U688">C_Spine3New_LArmNew</span>,<span class="var type1" id="S164T20U689">C_LArmNew_LForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line"><span class="mxinfo" id="T20:U493"><span class="var type1" id="S166T20U692">C_Spine2New_LForeArmNew</span> = <span class="mxinfo" id="T20:U495"><span class="fcn" id="F78N5:B694">CalculateC_Multi</span>( <span class="var type1" id="S88T20U695">C_Spine2New_Spine3New</span>,<span class="var type1" id="S165T20U696">C_Spine3New_LForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line"><span class="mxinfo" id="T20:U498"><span class="var type1" id="S167T20U699">C_SpineNew_LForeArmNew</span> = <span class="mxinfo" id="T20:U500"><span class="fcn" id="F78N5:B701">CalculateC_Multi</span>( <span class="var type1" id="S89T20U702">C_SpineNew_Spine3New</span>,<span class="var type1" id="S165T20U703">C_Spine3New_LForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line"><span class="mxinfo" id="T20:U503"><span class="var type1" id="S168T20U706">C_HipNew_LForeArmNew</span> = <span class="mxinfo" id="T20:U505"><span class="fcn" id="F78N5:B708">CalculateC_Multi</span>( <span class="var type1" id="S90T20U709">C_HipNew_Spine3New</span>,<span class="var type1" id="S165T20U710">C_Spine3New_LForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line"><span class="mxinfo" id="T20:U508"><span class="var type1" id="S169T20U713">C_RefArm_LHand</span> = <span class="var type1" id="S45T20U714">C_Spine2_LHand</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line"><span class="mxinfo" id="T20:U511"><span class="var type1" id="S170T20U717">C_RefArmNew_LForeArmNew</span> = <span class="var type1" id="S166T20U718">C_Spine2New_LForeArmNew</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line"><span class="mxinfo" id="T3:U514">[ <span class="var type1" id="S171T3U722">LWristYaw</span>,<span class="var type1" id="S172T7U723">LeftHand_new</span> ] = <span class="fcn" id="F175N22:B725">TransformLHand</span>( <span class="var type1" id="S169T20U726">C_RefArm_LHand</span>,<span class="var type1" id="S170T20U727">C_RefArmNew_LForeArmNew</span>,<span class="mxinfo" id="T3:U519"><span class="var type1" id="S10T3U728">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line"><span class="comment">%% RLeg</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line"><span class="mxinfo" id="T20:U521"><span class="var type1" id="S174T20U731">C_Spine2_Hip</span> = <span class="mxinfo" id="T20:U523"><span class="fcn" id="F81N13:B733">InverseC_Multi</span>(<span class="var type1" id="S34T20U734">C_Hip_Spine2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line"><span class="mxinfo" id="T20:U525"><span class="var type1" id="S176T20U737">C_Spine2_RUpLeg</span> = <span class="mxinfo" id="T20:U527"><span class="fcn" id="F78N5:B739">CalculateC_Multi</span>( <span class="var type1" id="S174T20U740">C_Spine2_Hip</span>,<span class="var type1" id="S27T20U741">C_Hip_RUpLeg</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line"><span class="comment">% dbstop in TransformRUpLeg</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line"><span class="mxinfo" id="T3:U530">[ <span class="var type1" id="S177T3U745">RHipRoll</span>,<span class="var type1" id="S178T3U746">RHipPitch</span>,<span class="var type1" id="S179T7U747">RightUpLeg_new</span> ] = <span class="fcn" id="F256N31:B749">TransformRUpLeg</span>( <span class="var type1" id="S176T20U750">C_Spine2_RUpLeg</span>,<span class="mxinfo" id="T3:U535"><span class="var type1" id="S71T3U751">HipYawPitch</span></span>,<span class="mxinfo" id="T3:U537"><span class="var type1" id="S10T3U752">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line"><span class="mxinfo" id="T20:U539"><span class="var type1" id="S181T20U755">C_Hip_RUpLegNew</span> = <span class="mxinfo" id="T20:U541"><span class="fcn" id="F48N11:B757">EulerToC_c</span>( <span class="var type1" id="S179T7U758">RightUpLeg_new</span>,<span class="mxinfo" id="T3:U543"><span class="var type1" id="S10T3U759">rotateOrder_BVH</span></span> ,<span class="mxinfo" id="T7:U545">[1,1,1]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line"><span class="mxinfo" id="T20:U546"><span class="var type1" id="S182T20U767">C_Spine2_RUpLegNew</span> = <span class="mxinfo" id="T20:U548"><span class="fcn" id="F78N5:B769">CalculateC_Multi</span>( <span class="var type1" id="S174T20U770">C_Spine2_Hip</span>,<span class="var type1" id="S181T20U771">C_Hip_RUpLegNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line"><span class="mxinfo" id="T3:U551">[ <span class="var type1" id="S183T3U775">RKneePitch</span>,<span class="var type1" id="S184T7U776">RightLeg_new</span> ] = <span class="fcn" id="F257N29:B778">TransformRLeg</span>( <span class="var type1" id="S182T20U779">C_Spine2_RUpLegNew</span>,<span class="var type1" id="S67T20U780">C_Hip_RLeg</span>,<span class="mxinfo" id="T3:U556"><span class="var type1" id="S10T3U781">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line"><span class="mxinfo" id="T3:U558">[ <span class="var type1" id="S186T3U785">RAnklePitch</span>,<span class="var type1" id="S187T3U786">RAnkleRoll</span>,<span class="var type1" id="S188T7U787">RightFoot_new</span> ] = <span class="fcn" id="F258N27:B789">TransformRFoot</span>( <span class="var type1" id="S29T20U790">C_RLeg_RFoot</span>,<span class="mxinfo" id="T3:U563"><span class="var type1" id="S10T3U791">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line"><span class="comment">%% LLeg</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line"><span class="mxinfo" id="T20:U565"><span class="var type1" id="S190T20U794">C_Spine2_LUpLeg</span> = <span class="mxinfo" id="T20:U567"><span class="fcn" id="F78N5:B796">CalculateC_Multi</span>( <span class="var type1" id="S174T20U797">C_Spine2_Hip</span>,<span class="var type1" id="S30T20U798">C_Hip_LUpLeg</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line"><span class="mxinfo" id="T3:U570">[ <span class="var type1" id="S191T3U802">LHipRoll</span>,<span class="var type1" id="S192T3U803">LHipPitch</span>,<span class="var type1" id="S193T7U804">LeftUpLeg_new</span> ] = <span class="fcn" id="F259N25:B806">TransformLUpLeg</span>( <span class="var type1" id="S190T20U807">C_Spine2_LUpLeg</span>,<span class="mxinfo" id="T3:U575"><span class="var type1" id="S71T3U808">HipYawPitch</span></span>,<span class="mxinfo" id="T3:U577"><span class="var type1" id="S10T3U809">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line"><span class="mxinfo" id="T20:U579"><span class="var type1" id="S195T20U812">C_Hip_LUpLegNew</span> = <span class="mxinfo" id="T20:U581"><span class="fcn" id="F48N11:B814">EulerToC_c</span>( <span class="var type1" id="S193T7U815">LeftUpLeg_new</span>,<span class="mxinfo" id="T3:U583"><span class="var type1" id="S10T3U816">rotateOrder_BVH</span></span>,<span class="mxinfo" id="T7:U585">[1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line"><span class="mxinfo" id="T20:U586"><span class="var type1" id="S196T20U824">C_Spine2_LUpLegNew</span> = <span class="mxinfo" id="T20:U588"><span class="fcn" id="F78N5:B826">CalculateC_Multi</span>( <span class="var type1" id="S174T20U827">C_Spine2_Hip</span>,<span class="var type1" id="S195T20U828">C_Hip_LUpLegNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line"><span class="mxinfo" id="T3:U591">[ <span class="var type1" id="S197T3U832">LKneePitch</span>,<span class="var type1" id="S198T7U833">LeftLeg_new</span> ] = <span class="fcn" id="F260N23:B835">TransformLLeg</span>( <span class="var type1" id="S196T20U836">C_Spine2_LUpLegNew</span>,<span class="var type1" id="S63T20U837">C_Hip_LLeg</span>,<span class="mxinfo" id="T3:U596"><span class="var type1" id="S10T3U838">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line"><span class="mxinfo" id="T3:U598">[ <span class="var type1" id="S200T3U842">LAnklePitch</span>,<span class="var type1" id="S201T3U843">LAnkleRoll</span>,<span class="var type1" id="S202T7U844">LeftFoot_new</span> ] = <span class="fcn" id="F261N21:B846">TransformLFoot</span>( <span class="var type1" id="S32T20U847">C_LLeg_LFoot</span>,<span class="mxinfo" id="T3:U603"><span class="var type1" id="S10T3U848">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line"><span class="comment">%% Get Nao</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line"><span class="mxinfo" id="T3:U605"><span class="var type1" id="S8T3U851">Nframes</span> = <span class="mxinfo" id="T3:U607">size(<span class="var type1" id="S106T3U854">HeadYaw</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line"><span class="mxinfo" id="T3:U609"><span class="var type1" id="S204T3U858">LHand</span> = <span class="mxinfo" id="T3:U611">zeros( 1,<span class="var type1" id="S8T3U862">Nframes</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line"><span class="mxinfo" id="T3:U613"><span class="var type1" id="S205T3U865">RHand</span> = <span class="mxinfo" id="T3:U615">zeros( 1,<span class="var type1" id="S8T3U869">Nframes</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line"><span class="comment">% LHipRoll = LHipRoll*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line"><span class="comment">% LHipPitch = LHipPitch*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line"><span class="comment">% LKneePitch = LKneePitch*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line"><span class="comment">% RHipRoll = RHipRoll*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line"><span class="comment">% RHipPitch = RHipPitch*0; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line"><span class="comment">%            </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line"><span class="comment">% RKneePitch = RKneePitch*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line"><span class="comment">% LAnklePitch = LAnklePitch*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line"><span class="comment">% LAnkleRoll = LAnkleRoll*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line"><span class="comment">% RAnklePitch = RAnklePitch*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line"><span class="comment">% RAnkleRoll = RAnkleRoll*0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line"><span class="mxinfo" id="T39:U617"><span class="var type1" id="S2T39U872">NaoData</span> = <span class="mxinfo" id="T39:U619">[ <span class="var type1" id="S106T3U875">HeadYaw</span>; <span class="var type1" id="S107T3U877">HeadPitch</span>; <span class="var type1" id="S148T3U879">LShoulderPitch</span>; <span class="var type1" id="S149T3U881">LShoulderRoll</span>; <span class="var type1" id="S162T3U883">LElbowYaw</span>;  <span class="var type1" id="S163T3U885">LElbowRoll</span>; <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line"><span class="mxinfo" id="T39:U617"><span class="mxinfo" id="T39:U619">           <span class="var type1" id="S115T3U887">RShoulderPitch</span>; <span class="var type1" id="S116T3U889">RShoulderRoll</span>; <span class="var type1" id="S130T3U891">RElbowYaw</span> ; <span class="var type1" id="S131T3U893">RElbowRoll</span>; <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line"><span class="mxinfo" id="T39:U617"><span class="mxinfo" id="T39:U619">           <span class="var type1" id="S71T3U895">HipYawPitch</span>; <span class="var type1" id="S191T3U897">LHipRoll</span> ; <span class="var type1" id="S192T3U899">LHipPitch</span> ; <span class="var type1" id="S197T3U901">LKneePitch</span> ; <span class="var type1" id="S177T3U903">RHipRoll</span> ; <span class="var type1" id="S178T3U905">RHipPitch</span>; <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line"><span class="mxinfo" id="T39:U617"><span class="mxinfo" id="T39:U619">           <span class="var type1" id="S183T3U907">RKneePitch</span> ; <span class="var type1" id="S200T3U909">LAnklePitch</span> ; <span class="var type1" id="S201T3U911">LAnkleRoll</span> ; <span class="var type1" id="S186T3U913">RAnklePitch</span> ; <span class="var type1" id="S187T3U915">RAnkleRoll</span>; <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line"><span class="mxinfo" id="T39:U617"><span class="mxinfo" id="T39:U619">           <span class="var type1" id="S171T3U917">LWristYaw</span> ; <span class="var type1" id="S140T3U919">RWristYaw</span> ; <span class="var type1" id="S204T3U921">LHand</span> ; <span class="var type1" id="S205T3U923">RHand</span>   ]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line"><span class="comment">%% Analyse Left Arm BVH</span></span></span>
</pre>
