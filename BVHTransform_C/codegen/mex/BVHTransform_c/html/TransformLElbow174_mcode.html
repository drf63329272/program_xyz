<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,417" id="srcline417">417</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S413T7U2091">LElbow_Nao</span>,<span class="var type1" id="S414T7U2092">LeftForeArm_new</span> ] = TransformLElbow( <span class="var type1" id="S415T20U2095">C_Spine_LForeArm</span>,<span class="var type1" id="S416T20U2096">C_Spine_LArmNew</span>,<span class="var type1" id="S417T3U2097">rotateOrder_BVH</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,418" id="srcline418">418</a></span><span class="line">coder.inline(<span class="string">'never'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,419" id="srcline419">419</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,420" id="srcline420">420</a></span><span class="line"><span class="mxinfo" id="T20:U6"><span class="var type1" id="S419T20U2106">C_LArmNew_Spine</span> = <span class="mxinfo" id="T20:U8"><span class="fcn" id="F81N13:B2108">InverseC_Multi</span>( <span class="var type1" id="S416T20U2109">C_Spine_LArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,421" id="srcline421">421</a></span><span class="line"><span class="mxinfo" id="T20:U10"><span class="var type1" id="S421T20U2112">C_LArmNew_LForeArm</span> = <span class="mxinfo" id="T20:U12"><span class="fcn" id="F78N5:B2114">CalculateC_Multi</span>( <span class="var type1" id="S419T20U2115">C_LArmNew_Spine</span>,<span class="var type1" id="S415T20U2116">C_Spine_LForeArm</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,422" id="srcline422">422</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,423" id="srcline423">423</a></span><span class="line"><span class="mxinfo" id="T3:U15"><span class="var type1" id="S423T3U2119">Nframes</span> = <span class="mxinfo" id="T3:U17">size( <span class="var type1" id="S415T20U2122">C_Spine_LForeArm</span>,1 )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,424" id="srcline424">424</a></span><span class="line"><span class="mxinfo" id="T7:U19"><span class="var type1" id="S413T7U2126">LElbow_Nao</span> = <span class="mxinfo" id="T7:U21">zeros(<span class="mxinfo" id="T3:U22"><span class="var type1" id="S423T3U2129">Nframes</span></span>,<span class="mxinfo" id="T3:U24">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,425" id="srcline425">425</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S426T3U2133">k</span>=<span class="mxinfo" id="T3:U26">1:<span class="var type1" id="S423T3U2136">Nframes</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,426" id="srcline426">426</a></span><span class="line">    <span class="mxinfo" id="T3:U28">[<span class="var type1" id="S427T3U2140">x</span>,<span class="var type1" id="S428T3U2141">y</span>,<span class="var type1" id="S429T3U2142">z</span>] = deal( <span class="mxinfo" id="T3:U32"><span class="var type1" id="S421T20U2146">C_LArmNew_LForeArm</span>(<span class="mxinfo" id="T3:U34"><span class="var type1" id="S426T3U2147">k</span></span>,<span class="mxinfo" id="T3:U36">1</span>,<span class="mxinfo" id="T3:U37">1</span>)</span>,<span class="mxinfo" id="T3:U38"><span class="var type1" id="S421T20U2151">C_LArmNew_LForeArm</span>(<span class="mxinfo" id="T3:U40"><span class="var type1" id="S426T3U2152">k</span></span>,<span class="mxinfo" id="T3:U42">1</span>,<span class="mxinfo" id="T3:U43">2</span>)</span>,<span class="mxinfo" id="T3:U44"><span class="var type1" id="S421T20U2156">C_LArmNew_LForeArm</span>(<span class="mxinfo" id="T3:U46"><span class="var type1" id="S426T3U2157">k</span></span>,<span class="mxinfo" id="T3:U48">1</span>,<span class="mxinfo" id="T3:U49">3</span>)</span> )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,427" id="srcline427">427</a></span><span class="line">    <span class="comment">%     %%% LElbowRoll &gt; 0  % 人很少做的动作：人左手不会这么转</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,428" id="srcline428">428</a></span><span class="line">    <span class="comment">%     LElbowRoll1 = acos(x) ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,429" id="srcline429">429</a></span><span class="line">    <span class="comment">%     LElbowYaw1 = atan2( y,-z );</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,430" id="srcline430">430</a></span><span class="line">    <span class="comment">%     LElbow_Nao1 = [ LElbowYaw1 LElbowRoll1 0 ];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,431" id="srcline431">431</a></span><span class="line">    <span class="comment">%%% LElbowRoll &lt; 0  % 人正常动作</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,432" id="srcline432">432</a></span><span class="line">    <span class="mxinfo" id="T3:U50"><span class="var type1" id="S431T3U2162">LElbowRoll2</span> = <span class="mxinfo" id="T3:U52">-<span class="mxinfo" id="T3:U53">acos(<span class="var type1" id="S427T3U2166">x</span>)</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,433" id="srcline433">433</a></span><span class="line">    <span class="mxinfo" id="T3:U55"><span class="var type1" id="S433T3U2169">LElbowYaw2</span> = <span class="mxinfo" id="T3:U57">atan2( <span class="mxinfo" id="T3:U58">-<span class="var type1" id="S428T3U2173">y</span></span>,<span class="var type1" id="S429T3U2174">z</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,434" id="srcline434">434</a></span><span class="line">    <span class="mxinfo" id="T7:U61"><span class="var type1" id="S435T7U2177">LElbow_Nao2</span> = <span class="mxinfo" id="T7:U63">[ <span class="var type1" id="S433T3U2180">LElbowYaw2</span> <span class="var type1" id="S431T3U2181">LElbowRoll2</span> <span class="mxinfo" id="T3:U66">0</span> ]</span></span>;   </span></span>
<span class="srcline"><span class="lineno"><a href="1,435" id="srcline435">435</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,436" id="srcline436">436</a></span><span class="line">    <span class="mxinfo" id="T7:U67"><span class="mxinfo" id="T7:U68"><span class="var type1" id="S413T7U2186">LElbow_Nao</span>(<span class="mxinfo" id="T3:U70"><span class="var type1" id="S426T3U2187">k</span></span>,:)</span> = <span class="var type1" id="S435T7U2189">LElbow_Nao2</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,437" id="srcline437">437</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,438" id="srcline438">438</a></span><span class="line"><span class="comment">%%% get new BVH</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,439" id="srcline439">439</a></span><span class="line"><span class="mxinfo" id="T3:U73"><span class="var type1" id="S436T3U2192">LElbow_rotateOrder</span> = <span class="mxinfo" id="T3:U75">123</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,440" id="srcline440">440</a></span><span class="line"><span class="mxinfo" id="T7:U76"><span class="var type1" id="S414T7U2196">LeftForeArm_new</span> = <span class="mxinfo" id="T7:U78">zeros(<span class="mxinfo" id="T3:U79"><span class="var type1" id="S423T3U2199">Nframes</span></span>,<span class="mxinfo" id="T3:U81">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,441" id="srcline441">441</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S426T3U2203">k</span>=<span class="mxinfo" id="T3:U83">1:<span class="var type1" id="S423T3U2206">Nframes</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,442" id="srcline442">442</a></span><span class="line">    <span class="mxinfo" id="T7:U85"><span class="mxinfo" id="T7:U86"><span class="var type1" id="S414T7U2210">LeftForeArm_new</span>(<span class="mxinfo" id="T3:U88"><span class="var type1" id="S426T3U2211">k</span></span>,:)</span> = <span class="mxinfo" id="T7:U90"><span class="fcn" id="F167N10:B2214">ChangeEulerRotate_c</span>(  <span class="mxinfo" id="T7:U91"><span class="var type1" id="S413T7U2216">LElbow_Nao</span>( <span class="mxinfo" id="T3:U93"><span class="var type1" id="S426T3U2217">k</span></span>,: )</span>,<span class="mxinfo" id="T3:U95"><span class="var type1" id="S436T3U2219">LElbow_rotateOrder</span></span>,<span class="var type1" id="S417T3U2220">rotateOrder_BVH</span> ,<span class="mxinfo" id="T7:U98">[1,1,1]</span>,<span class="mxinfo" id="T7:U99">[1,1,1]</span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,443" id="srcline443">443</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,444" id="srcline444">444</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,445" id="srcline445">445</a></span><span class="line"><span class="comment">%% RHand</span></span></span>
</pre>
