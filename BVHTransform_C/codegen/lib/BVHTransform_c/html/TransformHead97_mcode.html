<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,301" id="srcline301">301</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,302" id="srcline302">302</a></span><span class="line"><span class="comment">%% TransformHead</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,303" id="srcline303">303</a></span><span class="line"><span class="comment">% E_spine_head: euler from spine3 to head</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,304" id="srcline304">304</a></span><span class="line"><span class="comment">% rotateOrder : rotate order of "E_spine_head"</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,305" id="srcline305">305</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S311T3U1488">HeadYaw</span>,<span class="var type1" id="S312T3U1489">HeadPitch</span>,<span class="var type1" id="S313T7U1490">Head_new</span> ] = TransformHead(  <span class="var type1" id="S314T18U1493">C_Spine_Head</span>,<span class="var type1" id="S315T18U1494">C_Spine_NeckNew</span>,<span class="var type1" id="S316T3U1495">rotateOrder_BVH</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,306" id="srcline306">306</a></span><span class="line">coder.inline(<span class="string">'never'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,307" id="srcline307">307</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,308" id="srcline308">308</a></span><span class="line"><span class="mxinfo" id="T7:U7"><span class="var type1" id="S318T7U1504">rotateDirection_BVH</span> = <span class="mxinfo" id="T7:U9">[1,1,1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,309" id="srcline309">309</a></span><span class="line"><span class="mxinfo" id="T3:U10"><span class="var type1" id="S319T3U1512">Head_rotateOrder</span> = <span class="mxinfo" id="T3:U12">213</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,310" id="srcline310">310</a></span><span class="line"><span class="mxinfo" id="T18:U13"><span class="var type1" id="S320T18U1516">C_NeckNew_Spine</span> = <span class="mxinfo" id="T18:U15"><span class="fcn" id="F78N13:B1518">InverseC_Multi</span>( <span class="var type1" id="S315T18U1519">C_Spine_NeckNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,311" id="srcline311">311</a></span><span class="line"><span class="mxinfo" id="T18:U17"><span class="var type1" id="S322T18U1522">C_NeckNew_Head</span> = <span class="mxinfo" id="T18:U19"><span class="fcn" id="F75N5:B1524">CalculateC_Multi</span>( <span class="var type1" id="S320T18U1525">C_NeckNew_Spine</span>,<span class="var type1" id="S314T18U1526">C_Spine_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,312" id="srcline312">312</a></span><span class="line"><span class="mxinfo" id="T7:U22"><span class="var type1" id="S324T7U1529">E_Spine_Head</span> = <span class="mxinfo" id="T7:U24"><span class="fcn" id="F96N4:B1531">CToEuler_c</span>( <span class="var type1" id="S322T18U1532">C_NeckNew_Head</span>,<span class="mxinfo" id="T3:U26"><span class="var type1" id="S319T3U1533">Head_rotateOrder</span></span>,<span class="mxinfo" id="T7:U28"><span class="var type1" id="S318T7U1534">rotateDirection_BVH</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,313" id="srcline313">313</a></span><span class="line"><span class="mxinfo" id="T3:U30"><span class="mxinfo" id="T3:U31"><span class="var type1" id="S324T7U1538">E_Spine_Head</span>(:,<span class="mxinfo" id="T3:U33">3</span>)</span> = <span class="mxinfo" id="T3:U34">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,314" id="srcline314">314</a></span><span class="line"><span class="mxinfo" id="T3:U35"><span class="var type1" id="S311T3U1544">HeadYaw</span> = <span class="mxinfo" id="T3:U37"><span class="var type1" id="S324T7U1547">E_Spine_Head</span>(:,<span class="mxinfo" id="T3:U39">1</span>)</span>'</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,315" id="srcline315">315</a></span><span class="line"><span class="mxinfo" id="T3:U40"><span class="var type1" id="S312T3U1552">HeadPitch</span> = <span class="mxinfo" id="T3:U42"><span class="var type1" id="S324T7U1555">E_Spine_Head</span>(:,<span class="mxinfo" id="T3:U44">2</span>)</span>'</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,316" id="srcline316">316</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,317" id="srcline317">317</a></span><span class="line"><span class="comment">%%% get new BVH</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,318" id="srcline318">318</a></span><span class="line"><span class="mxinfo" id="T18:U45"><span class="var type1" id="S326T18U1560">C_Spine_HeadNew</span> = <span class="mxinfo" id="T18:U47"><span class="fcn" id="F45N11:B1562">EulerToC_c</span>( <span class="var type1" id="S324T7U1563">E_Spine_Head</span>,<span class="mxinfo" id="T3:U49"><span class="var type1" id="S319T3U1564">Head_rotateOrder</span></span> ,<span class="mxinfo" id="T7:U51">[1,1,1]</span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,319" id="srcline319">319</a></span><span class="line"><span class="mxinfo" id="T7:U52"><span class="var type1" id="S313T7U1572">Head_new</span> = <span class="mxinfo" id="T7:U54"><span class="fcn" id="F96N4:B1574">CToEuler_c</span>( <span class="var type1" id="S326T18U1575">C_Spine_HeadNew</span>,<span class="var type1" id="S316T3U1576">rotateOrder_BVH</span>,<span class="mxinfo" id="T7:U57"><span class="var type1" id="S318T7U1577">rotateDirection_BVH</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,320" id="srcline320">320</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,321" id="srcline321">321</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,322" id="srcline322">322</a></span><span class="line"><span class="comment">%% RightShoulder</span></span></span>
</pre>
