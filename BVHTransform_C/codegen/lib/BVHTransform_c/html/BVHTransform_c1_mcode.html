<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="comment">%% xyz  2015.3.25</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% Transform BVH data Format</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% BVHData: 1*354  degree</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% NaoData: 25*1 degree</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T38U3">NaoData</span> = BVHTransform_c( <span class="var type1" id="S3T1U6">BVHData</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%   function [ NaoData,ROOT_Hips_RotationNew ] = BVHTransform_c( BVHData )</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="mxinfo" id="T2:U3"><span class="var type1" id="S3T2U9">BVHData</span> = <span class="mxinfo" id="T2:U5">double(<span class="var type1" id="S3T1U12">BVHData</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="mxinfo" id="T7:U7"><span class="var type1" id="S5T7U15">ROOT_Hips_Position</span> = <span class="mxinfo" id="T7:U9"><span class="var type1" id="S3T2U17">BVHData</span>(:,<span class="mxinfo" id="T7:U11"><span class="mxinfo" id="T3:U12">1</span>:<span class="mxinfo" id="T3:U13">3</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="mxinfo" id="T2:U14"><span class="var type1" id="S3T2U24">BVHData</span> = <span class="mxinfo" id="T2:U16"><span class="mxinfo" id="T2:U17"><span class="var type1" id="S3T2U27">BVHData</span>*<span class="mxinfo" id="T3:U19">pi</span></span>/<span class="mxinfo" id="T3:U20">180</span></span></span> ; </span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="mxinfo" id="T7:U21"><span class="mxinfo" id="T7:U22"><span class="var type1" id="S3T2U34">BVHData</span>(:,<span class="mxinfo" id="T7:U24"><span class="mxinfo" id="T3:U25">1</span>:<span class="mxinfo" id="T3:U26">3</span></span>)</span> = <span class="var type1" id="S5T7U39">ROOT_Hips_Position</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="mxinfo" id="T3:U28"><span class="var type1" id="S7T3U42">Nframes</span> = <span class="mxinfo" id="T3:U30">size(<span class="var type1" id="S3T2U45">BVHData</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="mxinfo" id="T3:U32"><span class="var type1" id="S9T3U49">rotateOrder_BVH</span> = <span class="mxinfo" id="T3:U34">213</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="mxinfo" id="T7:U35"><span class="var type1" id="S10T7U53">rotateDirection_BVH</span> = <span class="mxinfo" id="T7:U37">[1,1,1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo" id="T18:U38">[ <span class="var type1" id="S11T18U62">C_World_Hip</span>,<span class="var type1" id="S12T18U63">C_Hip_Spine</span>,<span class="var type1" id="S13T18U64">C_Spine_Spine1</span>,<span class="var type1" id="S14T18U65">C_Spine1_Spine2</span>,<span class="var type1" id="S15T18U66">C_Spine2_Spine3</span>,<span class="var type1" id="S16T18U67">C_Spine3_Neck</span>,<span class="var type1" id="S17T18U68">C_Neck_Head</span>,<span class="var type1" id="S18T18U69">C_Spine3_LShoulder</span>,<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="mxinfo" id="T18:U38"><span class="var type1" id="S19T18U70">C_LShoulder_LArm</span>,<span class="var type1" id="S20T18U71">C_LArm_LForeArm</span>,<span class="var type1" id="S21T18U72">C_LForeArm_LHand</span>,<span class="var type1" id="S22T18U73">C_Spine3_RShoulder</span>,<span class="var type1" id="S23T18U74">C_RShoulder_RArm</span>,<span class="var type1" id="S24T18U75">C_RArm_RForeArm</span>,<span class="var type1" id="S25T18U76">C_RForeArm_RHand</span>,<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo" id="T18:U38"><span class="var type1" id="S26T18U77">C_Hip_RUpLeg</span>,<span class="var type1" id="S27T18U78">C_RUpLeg_RLeg</span>,<span class="var type1" id="S28T18U79">C_RLeg_RFoot</span>,<span class="var type1" id="S29T18U80">C_Hip_LUpLeg</span>,<span class="var type1" id="S30T18U81">C_LUpLeg_LLeg</span>,<span class="var type1" id="S31T18U82">C_LLeg_LFoot</span> ] = <span class="fcn" id="F46N3:B84">BVHDataToRotate_c</span>( <span class="var type1" id="S3T2U85">BVHData</span>,<span class="mxinfo" id="T3:U61"><span class="var type1" id="S9T3U86">rotateOrder_BVH</span></span>,<span class="mxinfo" id="T7:U63"><span class="var type1" id="S10T7U87">rotateDirection_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%% 所有BVH的旋转数据</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="mxinfo" id="T18:U65">[ <span class="var type1" id="S33T18U91">C_Hip_Spine2</span>,<span class="var type1" id="S34T18U92">C_Hip_Spine3</span>,<span class="var type1" id="S35T18U93">C_Spine_Spine3</span>, <span class="var type1" id="S36T18U94">C_Hip_LArm</span>,<span class="var type1" id="S37T18U95">C_Hip_LForeArm</span>,<span class="var type1" id="S38T18U96">C_Hip_LHand</span>, <span class="var type1" id="S39T18U97">C_Spine_LArm</span>,<span class="var type1" id="S40T18U98">C_Spine_LForeArm</span>,<span class="var type1" id="S41T18U99">C_Spine_LHand</span>, <span class="var type1" id="S42T18U100">C_Spine2_LArm</span>,<span class="var type1" id="S43T18U101">C_Spine2_LForeArm</span>,<span class="var type1" id="S44T18U102">C_Spine2_LHand</span>,<span class="var type1" id="S45T18U103">C_Spine3_LArm</span>,<span class="var type1" id="S46T18U104">C_Spine3_LForeArm</span>,<span class="var type1" id="S47T18U105">C_Spine3_LHand</span> ]  = <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="mxinfo" id="T18:U65">    <span class="fcn" id="F76N7:B107">CalculatedLeftArmRotate</span>( <span class="var type1" id="S12T18U108">C_Hip_Spine</span>,<span class="var type1" id="S13T18U109">C_Spine_Spine1</span>,<span class="var type1" id="S14T18U110">C_Spine1_Spine2</span>,<span class="var type1" id="S15T18U111">C_Spine2_Spine3</span>,<span class="var type1" id="S18T18U112">C_Spine3_LShoulder</span>,<span class="var type1" id="S19T18U113">C_LShoulder_LArm</span>,<span class="var type1" id="S20T18U114">C_LArm_LForeArm</span>,<span class="var type1" id="S21T18U115">C_LForeArm_LHand</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="mxinfo" id="T18:U89">[ <span class="var type1" id="S49T18U119">C_Hip_RArm</span>,<span class="var type1" id="S50T18U120">C_Hip_RForeArm</span>,<span class="var type1" id="S51T18U121">C_Hip_RHand</span>, <span class="var type1" id="S52T18U122">C_Spine_RArm</span>,<span class="var type1" id="S53T18U123">C_Spine_RForeArm</span>,<span class="var type1" id="S54T18U124">C_Spine_RHand</span>, <span class="var type1" id="S55T18U125">C_Spine2_RArm</span>,<span class="var type1" id="S56T18U126">C_Spine2_RForeArm</span>,<span class="var type1" id="S57T18U127">C_Spine2_RHand</span>,<span class="var type1" id="S58T18U128">C_Spine3_RArm</span>,<span class="var type1" id="S59T18U129">C_Spine3_RForeArm</span>,<span class="var type1" id="S60T18U130">C_Spine3_RHand</span> ]  = <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="mxinfo" id="T18:U89">    <span class="fcn" id="F77N9:B132">CalculatedRightArmRotate</span>( <span class="var type1" id="S34T18U133">C_Hip_Spine3</span>,<span class="var type1" id="S15T18U134">C_Spine2_Spine3</span>,<span class="var type1" id="S35T18U135">C_Spine_Spine3</span>,<span class="var type1" id="S22T18U136">C_Spine3_RShoulder</span>,<span class="var type1" id="S23T18U137">C_RShoulder_RArm</span>,<span class="var type1" id="S24T18U138">C_RArm_RForeArm</span>,<span class="var type1" id="S25T18U139">C_RForeArm_RHand</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="mxinfo" id="T18:U109">[ <span class="var type1" id="S62T18U143">C_Hip_LLeg</span>,<span class="var type1" id="S63T18U144">C_Spine2_LLeg</span>,<span class="var type1" id="S64T18U145">C_Spine3_LLeg</span> ] = <span class="fcn" id="F79N6:B147">CalculatedLLegRotate</span>( <span class="var type1" id="S33T18U148">C_Hip_Spine2</span>,<span class="var type1" id="S34T18U149">C_Hip_Spine3</span>,<span class="var type1" id="S29T18U150">C_Hip_LUpLeg</span>,<span class="var type1" id="S30T18U151">C_LUpLeg_LLeg</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="mxinfo" id="T18:U117">[ <span class="var type1" id="S66T18U155">C_Hip_RLeg</span>,<span class="var type1" id="S67T18U156">C_Spine2_RLeg</span>,<span class="var type1" id="S68T18U157">C_Spine3_RLeg</span> ] = <span class="fcn" id="F80N8:B159">CalculatedRLegRotate</span>( <span class="var type1" id="S33T18U160">C_Hip_Spine2</span>,<span class="var type1" id="S34T18U161">C_Hip_Spine3</span>,<span class="var type1" id="S26T18U162">C_Hip_RUpLeg</span>,<span class="var type1" id="S27T18U163">C_RUpLeg_RLeg</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="mxinfo" id="T3:U125"><span class="var type1" id="S70T3U166">HipYawPitch</span> = <span class="mxinfo" id="T3:U127">zeros(1,size(<span class="var type1" id="S12T18U172">C_Hip_Spine</span>,1))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">%% common parameters to set</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">% reference joint : 'Hip'  'SPine'  'Spine3'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="mxinfo" id="T26:U129"><span class="var type1" id="S72T26U176">refJoint1</span> = <span class="mxinfo" id="T26:U131"><span class="string">'Spine2'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="mxinfo" id="T26:U132"><span class="var type1" id="S73T26U180">referenceOfHead</span> = <span class="var type1" id="S72T26U181">refJoint1</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo" id="T26:U135"><span class="var type1" id="S74T26U184">referenceOfArm</span> = <span class="var type1" id="S72T26U185">refJoint1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo" id="T26:U138"><span class="var type1" id="S75T26U188">referenceOfForeArm</span> = <span class="var type1" id="S72T26U189">refJoint1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="mxinfo" id="T26:U141"><span class="var type1" id="S76T26U192">referenceOfHand</span> =  <span class="var type1" id="S72T26U193">refJoint1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="mxinfo" id="T7:U144"><span class="var type1" id="S77T7U196">E_0</span> = <span class="mxinfo" id="T7:U146">zeros( <span class="var type1" id="S7T3U199">Nframes</span>,3 )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="mxinfo" id="T7:U148"><span class="var type1" id="S78T7U203">RightShoulder_new</span> = <span class="var type1" id="S77T7U204">E_0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="mxinfo" id="T7:U151"><span class="var type1" id="S79T7U207">LeftShoulder_new</span> = <span class="mxinfo" id="T7:U153"><span class="var type1" id="S77T7U208">E_0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo" id="T7:U155"><span class="var type1" id="S80T7U211">Spine3_new</span> = <span class="var type1" id="S77T7U212">E_0</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="mxinfo" id="T7:U158"><span class="var type1" id="S81T7U215">Spine2_new</span> = <span class="var type1" id="S77T7U216">E_0</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="mxinfo" id="T7:U161"><span class="var type1" id="S82T7U219">Spine_new</span> = <span class="var type1" id="S77T7U220">E_0</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="mxinfo" id="T7:U164"><span class="var type1" id="S83T7U223">Neck_new</span> = <span class="var type1" id="S77T7U224">E_0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="mxinfo" id="T18:U167"><span class="var type1" id="S84T18U227">C_I</span> = <span class="mxinfo" id="T18:U169">zeros( <span class="mxinfo" id="T3:U170"><span class="var type1" id="S7T3U230">Nframes</span></span>,<span class="mxinfo" id="T3:U172">3</span>,<span class="mxinfo" id="T3:U173">3</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S85T3U235">k</span>=<span class="mxinfo" id="T3:U175">1:<span class="var type1" id="S7T3U238">Nframes</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">    <span class="mxinfo" id="T18:U177"><span class="mxinfo" id="T18:U178"><span class="var type1" id="S84T18U242">C_I</span>(<span class="mxinfo" id="T3:U180"><span class="var type1" id="S85T3U243">k</span></span>,:,:)</span> = <span class="mxinfo" id="T13:U182">[<span class="mxinfo" id="T7:U183"><span class="mxinfo" id="T3:U184">1</span> <span class="mxinfo" id="T3:U185">0</span> <span class="mxinfo" id="T3:U186">0</span></span>; <span class="mxinfo" id="T7:U187"><span class="mxinfo" id="T3:U188">0</span> <span class="mxinfo" id="T3:U189">1</span> <span class="mxinfo" id="T3:U190">0</span></span>; <span class="mxinfo" id="T7:U191"><span class="mxinfo" id="T3:U192">0</span> <span class="mxinfo" id="T3:U193">0</span> <span class="mxinfo" id="T3:U194">1</span></span> ]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="mxinfo" id="T18:U195"><span class="var type1" id="S86T18U261">C_Spine3New_NeckNew</span> = <span class="var type1" id="S84T18U262">C_I</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="mxinfo" id="T18:U198"><span class="var type1" id="S87T18U265">C_Spine2New_Spine3New</span> = <span class="var type1" id="S84T18U266">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="mxinfo" id="T18:U201"><span class="var type1" id="S88T18U269">C_SpineNew_Spine3New</span> = <span class="var type1" id="S84T18U270">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="mxinfo" id="T18:U204"><span class="var type1" id="S89T18U273">C_HipNew_Spine3New</span> = <span class="var type1" id="S84T18U274">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="mxinfo" id="T18:U207"><span class="var type1" id="S90T18U277">C_Spine3New_LShoulderNew</span> = <span class="var type1" id="S84T18U278">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="mxinfo" id="T18:U210"><span class="var type1" id="S91T18U281">C_Spine3New_RShoulderNew</span> = <span class="var type1" id="S84T18U282">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"><span class="comment">%%% New Hip</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="mxinfo" id="T18:U213"><span class="var type1" id="S92T18U285">C_World_Spine2</span> = <span class="mxinfo" id="T18:U215"><span class="fcn" id="F75N5:B287">CalculateC_Multi</span>( <span class="var type1" id="S11T18U288">C_World_Hip</span>,<span class="var type1" id="S33T18U289">C_Hip_Spine2</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="mxinfo" id="T7:U218"><span class="var type1" id="S94T7U292">E_World_Spine2</span> = <span class="mxinfo" id="T7:U220"><span class="fcn" id="F96N4:B294">CToEuler_c</span>( <span class="var type1" id="S92T18U295">C_World_Spine2</span>,<span class="mxinfo" id="T3:U222"><span class="var type1" id="S9T3U296">rotateOrder_BVH</span></span>,<span class="mxinfo" id="T7:U224"><span class="var type1" id="S10T7U297">rotateDirection_BVH</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="mxinfo" id="T7:U226"><span class="var type1" id="S96T7U300">ROOT_Hips_RotationNew</span> = <span class="var type1" id="S94T7U301">E_World_Spine2</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="comment">%% head</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="mxinfo" id="T18:U229"><span class="var type1" id="S97T18U304">C_Spine3_Head</span> = <span class="mxinfo" id="T18:U231"><span class="fcn" id="F75N5:B306">CalculateC_Multi</span>( <span class="var type1" id="S16T18U307">C_Spine3_Neck</span>,<span class="var type1" id="S17T18U308">C_Neck_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"><span class="mxinfo" id="T18:U234"><span class="var type1" id="S98T18U311">C_Spine2_Head</span> = <span class="mxinfo" id="T18:U236"><span class="fcn" id="F75N5:B313">CalculateC_Multi</span>( <span class="var type1" id="S15T18U314">C_Spine2_Spine3</span>,<span class="var type1" id="S97T18U315">C_Spine3_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line"><span class="mxinfo" id="T18:U239"><span class="var type1" id="S99T18U318">C_Spine_Head</span> = <span class="mxinfo" id="T18:U241"><span class="fcn" id="F75N5:B320">CalculateC_Multi</span>( <span class="var type1" id="S35T18U321">C_Spine_Spine3</span>,<span class="var type1" id="S97T18U322">C_Spine3_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="mxinfo" id="T18:U244"><span class="var type1" id="S100T18U325">C_Hip_Head</span> = <span class="mxinfo" id="T18:U246"><span class="fcn" id="F75N5:B327">CalculateC_Multi</span>( <span class="var type1" id="S34T18U328">C_Hip_Spine3</span>,<span class="var type1" id="S97T18U329">C_Spine3_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"><span class="mxinfo" id="T18:U249"><span class="var type1" id="S101T18U332">C_Spine2New_NeckNew</span> = <span class="mxinfo" id="T18:U251"><span class="fcn" id="F75N5:B334">CalculateC_Multi</span>( <span class="var type1" id="S87T18U335">C_Spine2New_Spine3New</span>,<span class="var type1" id="S86T18U336">C_Spine3New_NeckNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"><span class="mxinfo" id="T18:U254"><span class="var type1" id="S102T18U339">C_SpineNew_NeckNew</span> = <span class="mxinfo" id="T18:U256"><span class="fcn" id="F75N5:B341">CalculateC_Multi</span>( <span class="var type1" id="S88T18U342">C_SpineNew_Spine3New</span>,<span class="var type1" id="S86T18U343">C_Spine3New_NeckNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="mxinfo" id="T18:U259"><span class="var type1" id="S103T18U346">C_HipNew_NeckNew</span> = <span class="mxinfo" id="T18:U261"><span class="fcn" id="F75N5:B348">CalculateC_Multi</span>( <span class="var type1" id="S89T18U349">C_HipNew_Spine3New</span>,<span class="var type1" id="S86T18U350">C_Spine3New_NeckNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"><span class="mxinfo" id="T18:U264"><span class="var type1" id="S104T18U353">C_RefHead_Head</span> = <span class="var type1" id="S98T18U354">C_Spine2_Head</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"><span class="mxinfo" id="T18:U267"><span class="var type1" id="S105T18U357">C_RefHeadNew_NeckNew</span> = <span class="var type1" id="S101T18U358">C_Spine2New_NeckNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"><span class="mxinfo" id="T3:U270">[ <span class="var type1" id="S106T3U362">HeadYaw</span>,<span class="var type1" id="S107T3U363">HeadPitch</span>,<span class="var type1" id="S108T7U364">Head_new</span> ] = <span class="fcn" id="F97N19:B366">TransformHead</span>(  <span class="var type1" id="S104T18U367">C_RefHead_Head</span>,<span class="var type1" id="S105T18U368">C_RefHeadNew_NeckNew</span>,<span class="mxinfo" id="T3:U276"><span class="var type1" id="S9T3U369">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"><span class="comment">%% Right Shoulder</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"><span class="mxinfo" id="T18:U278"><span class="var type1" id="S110T18U372">C_Spine2New_RShoulderNew</span> = <span class="mxinfo" id="T18:U280"><span class="fcn" id="F75N5:B374">CalculateC_Multi</span>( <span class="var type1" id="S87T18U375">C_Spine2New_Spine3New</span>,<span class="var type1" id="S91T18U376">C_Spine3New_RShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"><span class="mxinfo" id="T18:U283"><span class="var type1" id="S111T18U379">C_SpineNew_RShoulderNew</span> = <span class="mxinfo" id="T18:U285"><span class="fcn" id="F75N5:B381">CalculateC_Multi</span>( <span class="var type1" id="S88T18U382">C_SpineNew_Spine3New</span>,<span class="var type1" id="S91T18U383">C_Spine3New_RShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line"><span class="mxinfo" id="T18:U288"><span class="var type1" id="S112T18U386">C_HipNew_RShoulderNew</span> = <span class="mxinfo" id="T18:U290"><span class="fcn" id="F75N5:B388">CalculateC_Multi</span>( <span class="var type1" id="S89T18U389">C_HipNew_Spine3New</span>,<span class="var type1" id="S91T18U390">C_Spine3New_RShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line"><span class="mxinfo" id="T18:U293"><span class="var type1" id="S113T18U393">C_RefArm_RArm</span> = <span class="var type1" id="S55T18U394">C_Spine2_RArm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"><span class="mxinfo" id="T18:U296"><span class="var type1" id="S114T18U397">C_RefArmNew_RShoulderNew</span> = <span class="var type1" id="S110T18U398">C_Spine2New_RShoulderNew</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line"><span class="comment">% dbstop in TransformRShoulder</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line"><span class="mxinfo" id="T3:U299">[ <span class="var type1" id="S115T3U402">RShoulderPitch</span>,<span class="var type1" id="S116T3U403">RShoulderRoll</span>,<span class="var type1" id="S117T7U404">RightArm_new</span> ] = <span class="fcn" id="F150N30:B406">TransformRShoulder</span>(  <span class="var type1" id="S114T18U407">C_RefArmNew_RShoulderNew</span>,<span class="var type1" id="S113T18U408">C_RefArm_RArm</span>,<span class="mxinfo" id="T3:U305"><span class="var type1" id="S9T3U409">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line"><span class="comment">%% Right Elbow</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line"><span class="mxinfo" id="T18:U307"><span class="var type1" id="S119T18U412">C_RShoulderNew_RArmNew</span> = <span class="mxinfo" id="T18:U309"><span class="fcn" id="F45N11:B414">EulerToC_c</span>( <span class="var type1" id="S117T7U415">RightArm_new</span>,<span class="mxinfo" id="T3:U311"><span class="var type1" id="S9T3U416">rotateOrder_BVH</span></span>,<span class="mxinfo" id="T7:U313">[1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line"><span class="mxinfo" id="T18:U314"><span class="var type1" id="S121T18U424">C_Spine3New_RArmNew</span> = <span class="mxinfo" id="T18:U316"><span class="fcn" id="F75N5:B426">CalculateC_Multi</span>( <span class="var type1" id="S91T18U427">C_Spine3New_RShoulderNew</span>,<span class="var type1" id="S119T18U428">C_RShoulderNew_RArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"><span class="mxinfo" id="T18:U319"><span class="var type1" id="S122T18U431">C_Spine2New_RArmNew</span> = <span class="mxinfo" id="T18:U321"><span class="fcn" id="F75N5:B433">CalculateC_Multi</span>( <span class="var type1" id="S110T18U434">C_Spine2New_RShoulderNew</span>,<span class="var type1" id="S119T18U435">C_RShoulderNew_RArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line"><span class="mxinfo" id="T18:U324"><span class="var type1" id="S123T18U438">C_SpineNew_RArmNew</span> = <span class="mxinfo" id="T18:U326"><span class="fcn" id="F75N5:B440">CalculateC_Multi</span>( <span class="var type1" id="S88T18U441">C_SpineNew_Spine3New</span>,<span class="var type1" id="S121T18U442">C_Spine3New_RArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line"><span class="mxinfo" id="T18:U329"><span class="var type1" id="S124T18U445">C_HipNew_RArmNew</span> = <span class="mxinfo" id="T18:U331"><span class="fcn" id="F75N5:B447">CalculateC_Multi</span>( <span class="var type1" id="S89T18U448">C_HipNew_Spine3New</span>,<span class="var type1" id="S121T18U449">C_Spine3New_RArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line"><span class="mxinfo" id="T18:U334"><span class="var type1" id="S125T18U452">C_RefArm_RForeArm</span> = <span class="var type1" id="S56T18U453">C_Spine2_RForeArm</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line"><span class="mxinfo" id="T18:U337"><span class="var type1" id="S126T18U456">C_RefArmNew_RArmNew</span> = <span class="var type1" id="S122T18U457">C_Spine2New_RArmNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line"><span class="mxinfo" id="T7:U340">[ <span class="var type1" id="S127T7U461">RElbow_Nao</span>,<span class="var type1" id="S128T7U462">RightForeArm_new</span> ] = <span class="fcn" id="F165N26:B464">TransformRElbow</span>( <span class="var type1" id="S125T18U465">C_RefArm_RForeArm</span>,<span class="var type1" id="S126T18U466">C_RefArmNew_RArmNew</span>,<span class="mxinfo" id="T3:U345"><span class="var type1" id="S9T3U467">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"><span class="mxinfo" id="T3:U347">[ <span class="var type1" id="S130T3U471">RElbowYaw</span>,<span class="var type1" id="S131T3U472">RElbowRoll</span> ] = deal( <span class="mxinfo" id="T3:U350"><span class="var type1" id="S127T7U477">RElbow_Nao</span>(:,<span class="mxinfo" id="T3:U352">1</span>)</span>',<span class="mxinfo" id="T3:U353"><span class="var type1" id="S127T7U482">RElbow_Nao</span>(:,<span class="mxinfo" id="T3:U355">2</span>)</span>' )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line"><span class="comment">%% RHand</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line"><span class="mxinfo" id="T18:U356"><span class="var type1" id="S133T18U487">C_RArmNew_RForeArmNew</span> = <span class="mxinfo" id="T18:U358"><span class="fcn" id="F45N11:B489">EulerToC_c</span>( <span class="var type1" id="S128T7U490">RightForeArm_new</span>,<span class="mxinfo" id="T3:U360"><span class="var type1" id="S9T3U491">rotateOrder_BVH</span></span>,<span class="mxinfo" id="T7:U362">[1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="mxinfo" id="T18:U363"><span class="var type1" id="S134T18U499">C_Spine3New_RForeArmNew</span> = <span class="mxinfo" id="T18:U365"><span class="fcn" id="F75N5:B501">CalculateC_Multi</span>( <span class="var type1" id="S121T18U502">C_Spine3New_RArmNew</span>,<span class="var type1" id="S133T18U503">C_RArmNew_RForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"><span class="mxinfo" id="T18:U368"><span class="var type1" id="S135T18U506">C_Spine2New_RForeArmNew</span> = <span class="mxinfo" id="T18:U370"><span class="fcn" id="F75N5:B508">CalculateC_Multi</span>( <span class="var type1" id="S122T18U509">C_Spine2New_RArmNew</span>,<span class="var type1" id="S133T18U510">C_RArmNew_RForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line"><span class="mxinfo" id="T18:U373"><span class="var type1" id="S136T18U513">C_SpineNew_RForeArmNew</span> = <span class="mxinfo" id="T18:U375"><span class="fcn" id="F75N5:B515">CalculateC_Multi</span>( <span class="var type1" id="S88T18U516">C_SpineNew_Spine3New</span>,<span class="var type1" id="S134T18U517">C_Spine3New_RForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="mxinfo" id="T18:U378"><span class="var type1" id="S137T18U520">C_HipNew_RForeArmNew</span> = <span class="mxinfo" id="T18:U380"><span class="fcn" id="F75N5:B522">CalculateC_Multi</span>( <span class="var type1" id="S89T18U523">C_HipNew_Spine3New</span>,<span class="var type1" id="S134T18U524">C_Spine3New_RForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line"><span class="mxinfo" id="T18:U383"><span class="var type1" id="S138T18U527">C_RefArm_RHand</span> = <span class="var type1" id="S57T18U528">C_Spine2_RHand</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line"><span class="mxinfo" id="T18:U386"><span class="var type1" id="S139T18U531">C_RefArmNew_RForeArmNew</span> = <span class="var type1" id="S135T18U532">C_Spine2New_RForeArmNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line"><span class="mxinfo" id="T3:U389">[ <span class="var type1" id="S140T3U536">RWristYaw</span>,<span class="var type1" id="S141T7U537">RightHand_new</span> ] = <span class="fcn" id="F167N28:B539">TransformRHand</span>( <span class="var type1" id="S138T18U540">C_RefArm_RHand</span>,<span class="var type1" id="S139T18U541">C_RefArmNew_RForeArmNew</span>,<span class="mxinfo" id="T3:U394"><span class="var type1" id="S9T3U542">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line"><span class="comment">%% Left Shoulder</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line"><span class="mxinfo" id="T18:U396"><span class="var type1" id="S143T18U545">C_Spine2New_LShoulderNew</span> = <span class="mxinfo" id="T18:U398"><span class="fcn" id="F75N5:B547">CalculateC_Multi</span>( <span class="var type1" id="S87T18U548">C_Spine2New_Spine3New</span>,<span class="var type1" id="S90T18U549">C_Spine3New_LShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line"><span class="mxinfo" id="T18:U401"><span class="var type1" id="S144T18U552">C_SpineNew_LShoulderNew</span> = <span class="mxinfo" id="T18:U403"><span class="fcn" id="F75N5:B554">CalculateC_Multi</span>( <span class="var type1" id="S88T18U555">C_SpineNew_Spine3New</span>,<span class="var type1" id="S90T18U556">C_Spine3New_LShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line"><span class="mxinfo" id="T18:U406"><span class="var type1" id="S145T18U559">C_HipNew_LShoulderNew</span> = <span class="mxinfo" id="T18:U408"><span class="fcn" id="F75N5:B561">CalculateC_Multi</span>( <span class="var type1" id="S89T18U562">C_HipNew_Spine3New</span>,<span class="var type1" id="S90T18U563">C_Spine3New_LShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line"><span class="mxinfo" id="T18:U411"><span class="var type1" id="S146T18U566">C_RefArm_LArm</span> = <span class="var type1" id="S42T18U567">C_Spine2_LArm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line"><span class="mxinfo" id="T18:U414"><span class="var type1" id="S147T18U570">C_RefArmNew_LShoulderNew</span> = <span class="var type1" id="S143T18U571">C_Spine2New_LShoulderNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line"><span class="mxinfo" id="T3:U417">[ <span class="var type1" id="S148T3U575">LShoulderPitch</span>,<span class="var type1" id="S149T3U576">LShoulderRoll</span>,<span class="var type1" id="S150T7U577">LeftArm_new</span> ] = <span class="fcn" id="F170N24:B579">TransformLShoulder</span>(  <span class="var type1" id="S147T18U580">C_RefArmNew_LShoulderNew</span>,<span class="var type1" id="S146T18U581">C_RefArm_LArm</span>,<span class="mxinfo" id="T3:U423"><span class="var type1" id="S9T3U582">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line"><span class="comment">%% Left Elbow</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line"><span class="mxinfo" id="T18:U425"><span class="var type1" id="S90T18U585">C_Spine3New_LShoulderNew</span> = <span class="mxinfo" id="T18:U427"><span class="fcn" id="F45N11:B587">EulerToC_c</span>( <span class="var type1" id="S79T7U588">LeftShoulder_new</span>,<span class="var type1" id="S9T3U589">rotateOrder_BVH</span>,[1,1,1] )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line"><span class="mxinfo" id="T18:U430"><span class="var type1" id="S152T18U597">C_LShoulderNew_LArmNew</span> = <span class="mxinfo" id="T18:U432"><span class="fcn" id="F45N11:B599">EulerToC_c</span>( <span class="var type1" id="S150T7U600">LeftArm_new</span>,<span class="mxinfo" id="T3:U434"><span class="var type1" id="S9T3U601">rotateOrder_BVH</span></span>,<span class="mxinfo" id="T7:U436">[1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line"><span class="mxinfo" id="T18:U437"><span class="var type1" id="S153T18U609">C_Spine3New_LArmNew</span> = <span class="mxinfo" id="T18:U439"><span class="fcn" id="F75N5:B611">CalculateC_Multi</span>( <span class="mxinfo" id="T18:U440"><span class="var type1" id="S90T18U612">C_Spine3New_LShoulderNew</span></span>,<span class="var type1" id="S152T18U613">C_LShoulderNew_LArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line"><span class="mxinfo" id="T18:U443"><span class="var type1" id="S154T18U616">C_Spine2New_LArmNew</span> = <span class="mxinfo" id="T18:U445"><span class="fcn" id="F75N5:B618">CalculateC_Multi</span>( <span class="var type1" id="S87T18U619">C_Spine2New_Spine3New</span>,<span class="var type1" id="S153T18U620">C_Spine3New_LArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line"><span class="mxinfo" id="T18:U448"><span class="var type1" id="S155T18U623">C_SpineNew_LArmNew</span> = <span class="mxinfo" id="T18:U450"><span class="fcn" id="F75N5:B625">CalculateC_Multi</span>( <span class="var type1" id="S88T18U626">C_SpineNew_Spine3New</span>,<span class="var type1" id="S153T18U627">C_Spine3New_LArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line"><span class="mxinfo" id="T18:U453"><span class="var type1" id="S156T18U630">C_HipNew_LArmNew</span> = <span class="mxinfo" id="T18:U455"><span class="fcn" id="F75N5:B632">CalculateC_Multi</span>( <span class="var type1" id="S89T18U633">C_HipNew_Spine3New</span>,<span class="var type1" id="S153T18U634">C_Spine3New_LArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line"><span class="mxinfo" id="T18:U458"><span class="var type1" id="S157T18U637">C_RefArm_LForeArm</span> = <span class="var type1" id="S43T18U638">C_Spine2_LForeArm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line"><span class="mxinfo" id="T18:U461"><span class="var type1" id="S158T18U641">C_RefArmNew_LArmNew</span> = <span class="var type1" id="S154T18U642">C_Spine2New_LArmNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line"><span class="mxinfo" id="T7:U464">[ <span class="var type1" id="S159T7U646">LElbow_Nao</span>,<span class="var type1" id="S160T7U647">LeftForeArm_new</span> ] = <span class="fcn" id="F171N20:B649">TransformLElbow</span>( <span class="var type1" id="S157T18U650">C_RefArm_LForeArm</span>,<span class="var type1" id="S158T18U651">C_RefArmNew_LArmNew</span>,<span class="mxinfo" id="T3:U469"><span class="var type1" id="S9T3U652">rotateOrder_BVH</span></span> )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line"><span class="mxinfo" id="T3:U471">[ <span class="var type1" id="S162T3U656">LElbowYaw</span>,<span class="var type1" id="S163T3U657">LElbowRoll</span> ] = deal( <span class="mxinfo" id="T3:U474"><span class="var type1" id="S159T7U662">LElbow_Nao</span>(:,<span class="mxinfo" id="T3:U476">1</span>)</span>',<span class="mxinfo" id="T3:U477"><span class="var type1" id="S159T7U667">LElbow_Nao</span>(:,<span class="mxinfo" id="T3:U479">2</span>)</span>' )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line"><span class="comment">%% LHand</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line"><span class="mxinfo" id="T18:U480"><span class="var type1" id="S164T18U672">C_LArmNew_LForeArmNew</span> = <span class="mxinfo" id="T18:U482"><span class="fcn" id="F45N11:B674">EulerToC_c</span>( <span class="var type1" id="S160T7U675">LeftForeArm_new</span>,<span class="mxinfo" id="T3:U484"><span class="var type1" id="S9T3U676">rotateOrder_BVH</span></span> ,<span class="mxinfo" id="T7:U486">[1,1,1]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line"><span class="mxinfo" id="T18:U487"><span class="var type1" id="S165T18U684">C_Spine3New_LForeArmNew</span> = <span class="mxinfo" id="T18:U489"><span class="fcn" id="F75N5:B686">CalculateC_Multi</span>( <span class="var type1" id="S153T18U687">C_Spine3New_LArmNew</span>,<span class="var type1" id="S164T18U688">C_LArmNew_LForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line"><span class="mxinfo" id="T18:U492"><span class="var type1" id="S166T18U691">C_Spine2New_LForeArmNew</span> = <span class="mxinfo" id="T18:U494"><span class="fcn" id="F75N5:B693">CalculateC_Multi</span>( <span class="var type1" id="S87T18U694">C_Spine2New_Spine3New</span>,<span class="var type1" id="S165T18U695">C_Spine3New_LForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line"><span class="mxinfo" id="T18:U497"><span class="var type1" id="S167T18U698">C_SpineNew_LForeArmNew</span> = <span class="mxinfo" id="T18:U499"><span class="fcn" id="F75N5:B700">CalculateC_Multi</span>( <span class="var type1" id="S88T18U701">C_SpineNew_Spine3New</span>,<span class="var type1" id="S165T18U702">C_Spine3New_LForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line"><span class="mxinfo" id="T18:U502"><span class="var type1" id="S168T18U705">C_HipNew_LForeArmNew</span> = <span class="mxinfo" id="T18:U504"><span class="fcn" id="F75N5:B707">CalculateC_Multi</span>( <span class="var type1" id="S89T18U708">C_HipNew_Spine3New</span>,<span class="var type1" id="S165T18U709">C_Spine3New_LForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line"><span class="mxinfo" id="T18:U507"><span class="var type1" id="S169T18U712">C_RefArm_LHand</span> = <span class="var type1" id="S44T18U713">C_Spine2_LHand</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line"><span class="mxinfo" id="T18:U510"><span class="var type1" id="S170T18U716">C_RefArmNew_LForeArmNew</span> = <span class="var type1" id="S166T18U717">C_Spine2New_LForeArmNew</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line"><span class="mxinfo" id="T3:U513">[ <span class="var type1" id="S171T3U721">LWristYaw</span>,<span class="var type1" id="S172T7U722">LeftHand_new</span> ] = <span class="fcn" id="F172N22:B724">TransformLHand</span>( <span class="var type1" id="S169T18U725">C_RefArm_LHand</span>,<span class="var type1" id="S170T18U726">C_RefArmNew_LForeArmNew</span>,<span class="mxinfo" id="T3:U518"><span class="var type1" id="S9T3U727">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line"><span class="comment">%% RLeg</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line"><span class="mxinfo" id="T18:U520"><span class="var type1" id="S174T18U730">C_Spine2_Hip</span> = <span class="mxinfo" id="T18:U522"><span class="fcn" id="F78N13:B732">InverseC_Multi</span>(<span class="var type1" id="S33T18U733">C_Hip_Spine2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line"><span class="mxinfo" id="T18:U524"><span class="var type1" id="S176T18U736">C_Spine2_RUpLeg</span> = <span class="mxinfo" id="T18:U526"><span class="fcn" id="F75N5:B738">CalculateC_Multi</span>( <span class="var type1" id="S174T18U739">C_Spine2_Hip</span>,<span class="var type1" id="S26T18U740">C_Hip_RUpLeg</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line"><span class="comment">% dbstop in TransformRUpLeg</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line"><span class="mxinfo" id="T3:U529">[ <span class="var type1" id="S177T3U744">RHipRoll</span>,<span class="var type1" id="S178T3U745">RHipPitch</span>,<span class="var type1" id="S179T7U746">RightUpLeg_new</span> ] = <span class="fcn" id="F248N31:B748">TransformRUpLeg</span>( <span class="var type1" id="S176T18U749">C_Spine2_RUpLeg</span>,<span class="mxinfo" id="T3:U534"><span class="var type1" id="S70T3U750">HipYawPitch</span></span>,<span class="mxinfo" id="T3:U536"><span class="var type1" id="S9T3U751">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line"><span class="mxinfo" id="T18:U538"><span class="var type1" id="S181T18U754">C_Hip_RUpLegNew</span> = <span class="mxinfo" id="T18:U540"><span class="fcn" id="F45N11:B756">EulerToC_c</span>( <span class="var type1" id="S179T7U757">RightUpLeg_new</span>,<span class="mxinfo" id="T3:U542"><span class="var type1" id="S9T3U758">rotateOrder_BVH</span></span> ,<span class="mxinfo" id="T7:U544">[1,1,1]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line"><span class="mxinfo" id="T18:U545"><span class="var type1" id="S182T18U766">C_Spine2_RUpLegNew</span> = <span class="mxinfo" id="T18:U547"><span class="fcn" id="F75N5:B768">CalculateC_Multi</span>( <span class="var type1" id="S174T18U769">C_Spine2_Hip</span>,<span class="var type1" id="S181T18U770">C_Hip_RUpLegNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line"><span class="mxinfo" id="T3:U550">[ <span class="var type1" id="S183T3U774">RKneePitch</span>,<span class="var type1" id="S184T7U775">RightLeg_new</span> ] = <span class="fcn" id="F249N29:B777">TransformRLeg</span>( <span class="var type1" id="S182T18U778">C_Spine2_RUpLegNew</span>,<span class="var type1" id="S66T18U779">C_Hip_RLeg</span>,<span class="mxinfo" id="T3:U555"><span class="var type1" id="S9T3U780">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line"><span class="mxinfo" id="T3:U557">[ <span class="var type1" id="S186T3U784">RAnklePitch</span>,<span class="var type1" id="S187T3U785">RAnkleRoll</span>,<span class="var type1" id="S188T7U786">RightFoot_new</span> ] = <span class="fcn" id="F250N27:B788">TransformRFoot</span>( <span class="var type1" id="S28T18U789">C_RLeg_RFoot</span>,<span class="mxinfo" id="T3:U562"><span class="var type1" id="S9T3U790">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line"><span class="comment">%% LLeg</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line"><span class="mxinfo" id="T18:U564"><span class="var type1" id="S190T18U793">C_Spine2_LUpLeg</span> = <span class="mxinfo" id="T18:U566"><span class="fcn" id="F75N5:B795">CalculateC_Multi</span>( <span class="var type1" id="S174T18U796">C_Spine2_Hip</span>,<span class="var type1" id="S29T18U797">C_Hip_LUpLeg</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line"><span class="mxinfo" id="T3:U569">[ <span class="var type1" id="S191T3U801">LHipRoll</span>,<span class="var type1" id="S192T3U802">LHipPitch</span>,<span class="var type1" id="S193T7U803">LeftUpLeg_new</span> ] = <span class="fcn" id="F251N25:B805">TransformLUpLeg</span>( <span class="var type1" id="S190T18U806">C_Spine2_LUpLeg</span>,<span class="mxinfo" id="T3:U574"><span class="var type1" id="S70T3U807">HipYawPitch</span></span>,<span class="mxinfo" id="T3:U576"><span class="var type1" id="S9T3U808">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line"><span class="mxinfo" id="T18:U578"><span class="var type1" id="S195T18U811">C_Hip_LUpLegNew</span> = <span class="mxinfo" id="T18:U580"><span class="fcn" id="F45N11:B813">EulerToC_c</span>( <span class="var type1" id="S193T7U814">LeftUpLeg_new</span>,<span class="mxinfo" id="T3:U582"><span class="var type1" id="S9T3U815">rotateOrder_BVH</span></span>,<span class="mxinfo" id="T7:U584">[1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line"><span class="mxinfo" id="T18:U585"><span class="var type1" id="S196T18U823">C_Spine2_LUpLegNew</span> = <span class="mxinfo" id="T18:U587"><span class="fcn" id="F75N5:B825">CalculateC_Multi</span>( <span class="var type1" id="S174T18U826">C_Spine2_Hip</span>,<span class="var type1" id="S195T18U827">C_Hip_LUpLegNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line"><span class="mxinfo" id="T3:U590">[ <span class="var type1" id="S197T3U831">LKneePitch</span>,<span class="var type1" id="S198T7U832">LeftLeg_new</span> ] = <span class="fcn" id="F252N23:B834">TransformLLeg</span>( <span class="var type1" id="S196T18U835">C_Spine2_LUpLegNew</span>,<span class="var type1" id="S62T18U836">C_Hip_LLeg</span>,<span class="mxinfo" id="T3:U595"><span class="var type1" id="S9T3U837">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line"><span class="mxinfo" id="T3:U597">[ <span class="var type1" id="S200T3U841">LAnklePitch</span>,<span class="var type1" id="S201T3U842">LAnkleRoll</span>,<span class="var type1" id="S202T7U843">LeftFoot_new</span> ] = <span class="fcn" id="F253N21:B845">TransformLFoot</span>( <span class="var type1" id="S31T18U846">C_LLeg_LFoot</span>,<span class="mxinfo" id="T3:U602"><span class="var type1" id="S9T3U847">rotateOrder_BVH</span></span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line"><span class="comment">%% Get Nao</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line"><span class="mxinfo" id="T3:U604"><span class="var type1" id="S7T3U850">Nframes</span> = <span class="mxinfo" id="T3:U606">size(<span class="var type1" id="S106T3U853">HeadYaw</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line"><span class="mxinfo" id="T3:U608"><span class="var type1" id="S204T3U857">LHand</span> = <span class="mxinfo" id="T3:U610">zeros( 1,<span class="var type1" id="S7T3U861">Nframes</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line"><span class="mxinfo" id="T3:U612"><span class="var type1" id="S205T3U864">RHand</span> = <span class="mxinfo" id="T3:U614">zeros( 1,<span class="var type1" id="S7T3U868">Nframes</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line"><span class="comment">% LHipRoll = LHipRoll*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line"><span class="comment">% LHipPitch = LHipPitch*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line"><span class="comment">% LKneePitch = LKneePitch*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line"><span class="comment">% RHipRoll = RHipRoll*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line"><span class="comment">% RHipPitch = RHipPitch*0; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line"><span class="comment">%            </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line"><span class="comment">% RKneePitch = RKneePitch*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line"><span class="comment">% LAnklePitch = LAnklePitch*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line"><span class="comment">% LAnkleRoll = LAnkleRoll*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line"><span class="comment">% RAnklePitch = RAnklePitch*0 ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line"><span class="comment">% RAnkleRoll = RAnkleRoll*0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line"><span class="mxinfo" id="T38:U616"><span class="var type1" id="S2T38U871">NaoData</span> = <span class="mxinfo" id="T38:U618">[ <span class="var type1" id="S106T3U874">HeadYaw</span>; <span class="var type1" id="S107T3U876">HeadPitch</span>; <span class="var type1" id="S148T3U878">LShoulderPitch</span>; <span class="var type1" id="S149T3U880">LShoulderRoll</span>; <span class="var type1" id="S162T3U882">LElbowYaw</span>;  <span class="var type1" id="S163T3U884">LElbowRoll</span>; <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line"><span class="mxinfo" id="T38:U616"><span class="mxinfo" id="T38:U618">           <span class="var type1" id="S115T3U886">RShoulderPitch</span>; <span class="var type1" id="S116T3U888">RShoulderRoll</span>; <span class="var type1" id="S130T3U890">RElbowYaw</span> ; <span class="var type1" id="S131T3U892">RElbowRoll</span>; <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line"><span class="mxinfo" id="T38:U616"><span class="mxinfo" id="T38:U618">           <span class="var type1" id="S70T3U894">HipYawPitch</span>; <span class="var type1" id="S191T3U896">LHipRoll</span> ; <span class="var type1" id="S192T3U898">LHipPitch</span> ; <span class="var type1" id="S197T3U900">LKneePitch</span> ; <span class="var type1" id="S177T3U902">RHipRoll</span> ; <span class="var type1" id="S178T3U904">RHipPitch</span>; <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line"><span class="mxinfo" id="T38:U616"><span class="mxinfo" id="T38:U618">           <span class="var type1" id="S183T3U906">RKneePitch</span> ; <span class="var type1" id="S200T3U908">LAnklePitch</span> ; <span class="var type1" id="S201T3U910">LAnkleRoll</span> ; <span class="var type1" id="S186T3U912">RAnklePitch</span> ; <span class="var type1" id="S187T3U914">RAnkleRoll</span>; <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line"><span class="mxinfo" id="T38:U616"><span class="mxinfo" id="T38:U618">           <span class="var type1" id="S171T3U916">LWristYaw</span> ; <span class="var type1" id="S140T3U918">RWristYaw</span> ; <span class="var type1" id="S204T3U920">LHand</span> ; <span class="var type1" id="S205T3U922">RHand</span>   ]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line"><span class="comment">%% Analyse Left Arm BVH</span></span></span>
</pre>
