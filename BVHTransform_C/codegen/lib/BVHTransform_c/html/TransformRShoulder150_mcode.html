<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,320" id="srcline320">320</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,321" id="srcline321">321</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,322" id="srcline322">322</a></span><span class="line"><span class="comment">%% RightShoulder</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,323" id="srcline323">323</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S329T3U1580">RShoulderPitch</span>,<span class="var type1" id="S330T3U1581">RShoulderRoll</span>,<span class="var type1" id="S331T7U1582">RightArm_new</span> ] = TransformRShoulder(  <span class="var type1" id="S332T18U1585">C_Spine3_RShoulderNew</span>,<span class="var type1" id="S333T18U1586">C_Spine3_RArm</span>,<span class="var type1" id="S334T3U1587">rotateOrder_BVH</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,324" id="srcline324">324</a></span><span class="line">coder.inline(<span class="string">'never'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,325" id="srcline325">325</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,326" id="srcline326">326</a></span><span class="line"><span class="mxinfo" id="T7:U7"><span class="var type1" id="S336T7U1596">rotateDirection_BVH</span> = <span class="mxinfo" id="T7:U9">[1,1,1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,327" id="srcline327">327</a></span><span class="line"><span class="mxinfo" id="T18:U10"><span class="var type1" id="S337T18U1604">C_RShoulderNew_Spine3</span> = <span class="mxinfo" id="T18:U12"><span class="fcn" id="F78N13:B1606">InverseC_Multi</span>( <span class="var type1" id="S332T18U1607">C_Spine3_RShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,328" id="srcline328">328</a></span><span class="line"><span class="mxinfo" id="T18:U14"><span class="var type1" id="S339T18U1610">C_RShoulderNew_RArm</span> = <span class="mxinfo" id="T18:U16"><span class="fcn" id="F75N5:B1612">CalculateC_Multi</span>( <span class="var type1" id="S337T18U1613">C_RShoulderNew_Spine3</span>,<span class="var type1" id="S333T18U1614">C_Spine3_RArm</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,329" id="srcline329">329</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,330" id="srcline330">330</a></span><span class="line"><span class="comment">%%% 对 C_RShoulderNew_RArm 进行零位补偿</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,331" id="srcline331">331</a></span><span class="line"><span class="mxinfo" id="T3:U19"><span class="var type1" id="S341T3U1617">Nframes</span> = <span class="mxinfo" id="T3:U21">size(<span class="var type1" id="S332T18U1620">C_Spine3_RShoulderNew</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,332" id="srcline332">332</a></span><span class="line"><span class="mxinfo" id="T7:U23"><span class="var type1" id="S343T7U1624">E_naoZero_NoitomZero_YXZ</span> = <span class="mxinfo" id="T7:U25">[-pi/2,0,0]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,333" id="srcline333">333</a></span><span class="line"><span class="mxinfo" id="T7:U26"><span class="var type1" id="S343T7U1636">E_naoZero_NoitomZero_YXZ</span> = <span class="mxinfo" id="T7:U28">repmat( <span class="var type1" id="S343T7U1639">E_naoZero_NoitomZero_YXZ</span>,<span class="var type1" id="S341T3U1640">Nframes</span>,1 )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,334" id="srcline334">334</a></span><span class="line"><span class="mxinfo" id="T18:U31"><span class="var type1" id="S346T18U1644">C_naoZero_NoitomZero_YXZ</span> = <span class="mxinfo" id="T18:U33"><span class="fcn" id="F45N11:B1646">EulerToC_c</span>( <span class="var type1" id="S343T7U1647">E_naoZero_NoitomZero_YXZ</span>,213,[1,1,1] )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,335" id="srcline335">335</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,336" id="srcline336">336</a></span><span class="line"><span class="mxinfo" id="T18:U35"><span class="var type1" id="S348T18U1656">C_RShoulderNew_RArm_Nao</span> = <span class="mxinfo" id="T18:U37"><span class="fcn" id="F75N5:B1658">CalculateC_Multi</span>( <span class="mxinfo" id="T18:U38"><span class="var type1" id="S346T18U1659">C_naoZero_NoitomZero_YXZ</span></span>,<span class="var type1" id="S339T18U1660">C_RShoulderNew_RArm</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,337" id="srcline337">337</a></span><span class="line"><span class="mxinfo" id="T7:U41"><span class="var type1" id="S349T7U1663">E_RShoulderNew_RArm_Nao</span> = <span class="mxinfo" id="T7:U43"><span class="fcn" id="F96N4:B1665">CToEuler_c</span>( <span class="var type1" id="S348T18U1666">C_RShoulderNew_RArm_Nao</span>,<span class="mxinfo" id="T3:U45">321</span>,<span class="mxinfo" id="T7:U46"><span class="var type1" id="S336T7U1668">rotateDirection_BVH</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,338" id="srcline338">338</a></span><span class="line"><span class="mxinfo" id="T3:U48"><span class="mxinfo" id="T3:U49"><span class="var type1" id="S349T7U1672">E_RShoulderNew_RArm_Nao</span>(:,<span class="mxinfo" id="T3:U51">3</span>)</span> = <span class="mxinfo" id="T3:U52">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,339" id="srcline339">339</a></span><span class="line"><span class="mxinfo" id="T18:U53"><span class="var type1" id="S351T18U1678">C_RShoulderNew_RArm_NaoNew</span> = <span class="mxinfo" id="T18:U55"><span class="fcn" id="F45N11:B1680">EulerToC_c</span>( <span class="var type1" id="S349T7U1681">E_RShoulderNew_RArm_Nao</span>,<span class="mxinfo" id="T3:U57">321</span>,<span class="mxinfo" id="T7:U58">[1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,340" id="srcline340">340</a></span><span class="line"><span class="mxinfo" id="T3:U59"><span class="var type1" id="S329T3U1690">RShoulderPitch</span> = <span class="mxinfo" id="T3:U61"><span class="var type1" id="S349T7U1693">E_RShoulderNew_RArm_Nao</span>(:,<span class="mxinfo" id="T3:U63">1</span>)</span>'</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,341" id="srcline341">341</a></span><span class="line"><span class="mxinfo" id="T3:U64"><span class="var type1" id="S330T3U1698">RShoulderRoll</span> = <span class="mxinfo" id="T3:U66"><span class="var type1" id="S349T7U1701">E_RShoulderNew_RArm_Nao</span>(:,<span class="mxinfo" id="T3:U68">2</span>)</span>'</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,342" id="srcline342">342</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,343" id="srcline343">343</a></span><span class="line"><span class="comment">%%% get new BVH</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,344" id="srcline344">344</a></span><span class="line"><span class="comment">% 零位补偿回去</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,345" id="srcline345">345</a></span><span class="line"><span class="mxinfo" id="T7:U69"><span class="var type1" id="S352T7U1706">E_NoitomZero_naoZero_ZYX</span> = <span class="mxinfo" id="T7:U71">[0,pi/2,0]</span></span>;  <span class="comment">% 321</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,346" id="srcline346">346</a></span><span class="line"><span class="mxinfo" id="T7:U72"><span class="var type1" id="S352T7U1717">E_NoitomZero_naoZero_ZYX</span> = <span class="mxinfo" id="T7:U74">repmat( <span class="var type1" id="S352T7U1720">E_NoitomZero_naoZero_ZYX</span>,<span class="var type1" id="S341T3U1721">Nframes</span>,1 )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,347" id="srcline347">347</a></span><span class="line"><span class="mxinfo" id="T18:U77"><span class="var type1" id="S353T18U1725">C_NoitomZero_naoZero_ZYX</span> = <span class="mxinfo" id="T18:U79"><span class="fcn" id="F45N11:B1727">EulerToC_c</span>( <span class="var type1" id="S352T7U1728">E_NoitomZero_naoZero_ZYX</span>,321 ,[1,1,1])</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,348" id="srcline348">348</a></span><span class="line"><span class="mxinfo" id="T18:U81"><span class="var type1" id="S354T18U1737">C_RShoulderNew_RArm_NoitomNew</span> = <span class="mxinfo" id="T18:U83"><span class="fcn" id="F75N5:B1739">CalculateC_Multi</span>( <span class="mxinfo" id="T18:U84"><span class="var type1" id="S353T18U1740">C_NoitomZero_naoZero_ZYX</span></span>,<span class="var type1" id="S351T18U1741">C_RShoulderNew_RArm_NaoNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,349" id="srcline349">349</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,350" id="srcline350">350</a></span><span class="line"><span class="mxinfo" id="T7:U87"><span class="var type1" id="S331T7U1744">RightArm_new</span> = <span class="mxinfo" id="T7:U89"><span class="fcn" id="F96N4:B1746">CToEuler_c</span>( <span class="var type1" id="S354T18U1747">C_RShoulderNew_RArm_NoitomNew</span>,<span class="var type1" id="S334T3U1748">rotateOrder_BVH</span>,<span class="mxinfo" id="T7:U92"><span class="var type1" id="S336T7U1749">rotateDirection_BVH</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,351" id="srcline351">351</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,352" id="srcline352">352</a></span><span class="line"><span class="comment">%% LeftShoulder</span></span></span>
</pre>
