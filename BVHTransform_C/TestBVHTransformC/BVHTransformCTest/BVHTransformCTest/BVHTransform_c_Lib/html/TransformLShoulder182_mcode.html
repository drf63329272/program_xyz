<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,295" id="srcline295">295</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,296" id="srcline296">296</a></span><span class="line"><span class="comment">%% LeftShoulder</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,297" id="srcline297">297</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S340T2U1603">LShoulderPitch</span>,<span class="var type1" id="S341T2U1604">LShoulderRoll</span>,<span class="var type1" id="S342T8U1605">LeftArm_new</span> ] = TransformLShoulder(  <span class="var type1" id="S343T17U1608">C_Spine3_LShoulderNew</span>,<span class="var type1" id="S344T17U1609">C_Spine3_LArm</span>,<span class="mxinfo" id="T7:U6"><span class="var type2" id="S345T7V1U1610">rotateOrder_BVH</span></span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,298" id="srcline298">298</a></span><span class="line"><span class="mxinfo" id="T8:U8"><span class="var type1" id="S346T8U1613">rotateDirection_BVH</span> = <span class="mxinfo" id="T8:U10">[1,1,1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,299" id="srcline299">299</a></span><span class="line"><span class="mxinfo" id="T17:U11"><span class="var type1" id="S347T17U1621">C_LShoulderNew_Spine3</span> = <span class="mxinfo" id="T17:U13"><span class="fcn" id="F76N9:B1623">InverseC_Multi</span>( <span class="var type1" id="S343T17U1624">C_Spine3_LShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,300" id="srcline300">300</a></span><span class="line"><span class="mxinfo" id="T17:U15"><span class="var type1" id="S349T17U1627">C_LShoulderNew_LArm</span> = <span class="mxinfo" id="T17:U17"><span class="fcn" id="F73N4:B1629">CalculateC_Multi</span>( <span class="var type1" id="S347T17U1630">C_LShoulderNew_Spine3</span>,<span class="var type1" id="S344T17U1631">C_Spine3_LArm</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,301" id="srcline301">301</a></span><span class="line"><span class="comment">%%% 对 C_LShoulderNew_LArm 进行零位补偿</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,302" id="srcline302">302</a></span><span class="line"><span class="mxinfo" id="T2:U20"><span class="var type1" id="S351T2U1634">Nframes</span> = <span class="mxinfo" id="T2:U22">size(<span class="var type1" id="S343T17U1637">C_Spine3_LShoulderNew</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,303" id="srcline303">303</a></span><span class="line"><span class="mxinfo" id="T8:U24"><span class="var type1" id="S353T8U1641">E_naoZero_NoitomZero_YXZ</span> = <span class="mxinfo" id="T8:U26">[pi/2,0,0]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,304" id="srcline304">304</a></span><span class="line"><span class="mxinfo" id="T8:U27"><span class="var type1" id="S353T8U1652">E_naoZero_NoitomZero_YXZ</span> = <span class="mxinfo" id="T8:U29">repmat( <span class="var type1" id="S353T8U1655">E_naoZero_NoitomZero_YXZ</span>,<span class="var type1" id="S351T2U1656">Nframes</span>,1 )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,305" id="srcline305">305</a></span><span class="line"><span class="mxinfo" id="T17:U32"><span class="var type1" id="S356T17U1660">C_naoZero_NoitomZero_YXZ</span> = <span class="mxinfo" id="T17:U34"><span class="fcn" id="F43N26:B1662">EulerToC_c</span>( <span class="var type1" id="S353T8U1663">E_naoZero_NoitomZero_YXZ</span>,<span class="string">'YXZ'</span>,[1,1,1] )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,306" id="srcline306">306</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,307" id="srcline307">307</a></span><span class="line"><span class="mxinfo" id="T17:U36"><span class="var type1" id="S358T17U1672">C_LShoulderNew_LArm_Nao</span> = <span class="mxinfo" id="T17:U38"><span class="fcn" id="F73N4:B1674">CalculateC_Multi</span>( <span class="mxinfo" id="T17:U39"><span class="var type1" id="S356T17U1675">C_naoZero_NoitomZero_YXZ</span></span>,<span class="var type1" id="S349T17U1676">C_LShoulderNew_LArm</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,308" id="srcline308">308</a></span><span class="line"><span class="mxinfo" id="T8:U42"><span class="var type1" id="S359T8U1679">E_LShoulderNew_LArm_Nao</span> = <span class="mxinfo" id="T8:U44"><span class="fcn" id="F153N23:B1681">CToEuler_c</span>( <span class="var type1" id="S358T17U1682">C_LShoulderNew_LArm_Nao</span>,<span class="string">'ZYX'</span>,<span class="mxinfo" id="T8:U46">[-1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,309" id="srcline309">309</a></span><span class="line"><span class="mxinfo" id="T2:U47"><span class="mxinfo" id="T2:U48"><span class="var type1" id="S359T8U1693">E_LShoulderNew_LArm_Nao</span>(:,<span class="mxinfo" id="T2:U50">3</span>)</span> = <span class="mxinfo" id="T2:U51">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,310" id="srcline310">310</a></span><span class="line"><span class="mxinfo" id="T17:U52"><span class="var type1" id="S361T17U1699">C_LShoulderNew_LArm_NaoNew</span> = <span class="mxinfo" id="T17:U54"><span class="fcn" id="F155N26:B1701">EulerToC_c</span>( <span class="var type1" id="S359T8U1702">E_LShoulderNew_LArm_Nao</span>,<span class="string">'ZYX'</span>,<span class="mxinfo" id="T8:U56">[-1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,311" id="srcline311">311</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,312" id="srcline312">312</a></span><span class="line"><span class="mxinfo" id="T2:U57"><span class="var type1" id="S340T2U1712">LShoulderPitch</span> = <span class="mxinfo" id="T2:U59"><span class="var type1" id="S359T8U1715">E_LShoulderNew_LArm_Nao</span>(:,<span class="mxinfo" id="T2:U61">1</span>)</span>'</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,313" id="srcline313">313</a></span><span class="line"><span class="mxinfo" id="T2:U62"><span class="var type1" id="S341T2U1720">LShoulderRoll</span> = <span class="mxinfo" id="T2:U64"><span class="var type1" id="S359T8U1723">E_LShoulderNew_LArm_Nao</span>(:,<span class="mxinfo" id="T2:U66">2</span>)</span>'</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,314" id="srcline314">314</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,315" id="srcline315">315</a></span><span class="line"><span class="comment">%%% get new BVH</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,316" id="srcline316">316</a></span><span class="line"><span class="comment">% 零位补偿回去</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,317" id="srcline317">317</a></span><span class="line"><span class="mxinfo" id="T8:U67"><span class="var type1" id="S362T8U1728">E_NoitomZero_naoZero_ZYX</span> = <span class="mxinfo" id="T8:U69">[0,-pi/2,0]</span></span>;  <span class="comment">% 'ZYX'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,318" id="srcline318">318</a></span><span class="line"><span class="mxinfo" id="T8:U70"><span class="var type1" id="S362T8U1740">E_NoitomZero_naoZero_ZYX</span> = <span class="mxinfo" id="T8:U72">repmat( <span class="var type1" id="S362T8U1743">E_NoitomZero_naoZero_ZYX</span>,<span class="var type1" id="S351T2U1744">Nframes</span>,1 )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,319" id="srcline319">319</a></span><span class="line"><span class="mxinfo" id="T17:U75"><span class="var type1" id="S363T17U1748">C_NoitomZero_naoZero_ZYX</span> = <span class="mxinfo" id="T17:U77"><span class="fcn" id="F155N26:B1750">EulerToC_c</span>( <span class="var type1" id="S362T8U1751">E_NoitomZero_naoZero_ZYX</span>,<span class="string">'ZYX'</span>,[1,1,1] )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,320" id="srcline320">320</a></span><span class="line"><span class="mxinfo" id="T17:U79"><span class="var type1" id="S364T17U1760">C_LShoulderNew_LArm_NoitomNew</span> = <span class="mxinfo" id="T17:U81"><span class="fcn" id="F73N4:B1762">CalculateC_Multi</span>( <span class="mxinfo" id="T17:U82"><span class="var type1" id="S363T17U1763">C_NoitomZero_naoZero_ZYX</span></span>,<span class="var type1" id="S361T17U1764">C_LShoulderNew_LArm_NaoNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,321" id="srcline321">321</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,322" id="srcline322">322</a></span><span class="line"><span class="mxinfo" id="T8:U85"><span class="var type1" id="S342T8U1767">LeftArm_new</span> = <span class="mxinfo" id="T8:U87"><span class="fcn" id="F118N23:B1769">CToEuler_c</span>( <span class="var type1" id="S364T17U1770">C_LShoulderNew_LArm_NoitomNew</span>,<span class="var type1" id="S345T7U1771">rotateOrder_BVH</span>,<span class="mxinfo" id="T8:U90"><span class="var type1" id="S346T8U1772">rotateDirection_BVH</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,323" id="srcline323">323</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,324" id="srcline324">324</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,325" id="srcline325">325</a></span><span class="line"><span class="comment">%% REblow</span></span></span>
</pre>
