<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,357" id="srcline357">357</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S395T8U1929">LElbow_Nao</span>,<span class="var type1" id="S396T8U1930">LeftForeArm_new</span> ] = TransformLElbow( <span class="var type1" id="S397T17U1933">C_Spine_LForeArm</span>,<span class="var type1" id="S398T17U1934">C_Spine_LArmNew</span>,<span class="mxinfo" id="T7:U5"><span class="var type2" id="S399T7V1U1935">rotateOrder_BVH</span></span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,358" id="srcline358">358</a></span><span class="line"><span class="mxinfo" id="T17:U7"><span class="var type1" id="S400T17U1938">C_LArmNew_Spine</span> = <span class="mxinfo" id="T17:U9"><span class="fcn" id="F76N9:B1940">InverseC_Multi</span>( <span class="var type1" id="S398T17U1941">C_Spine_LArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,359" id="srcline359">359</a></span><span class="line"><span class="mxinfo" id="T17:U11"><span class="var type1" id="S402T17U1944">C_LArmNew_LForeArm</span> = <span class="mxinfo" id="T17:U13"><span class="fcn" id="F73N4:B1946">CalculateC_Multi</span>( <span class="var type1" id="S400T17U1947">C_LArmNew_Spine</span>,<span class="var type1" id="S397T17U1948">C_Spine_LForeArm</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,360" id="srcline360">360</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,361" id="srcline361">361</a></span><span class="line"><span class="mxinfo" id="T2:U16"><span class="var type1" id="S404T2U1951">Nframes</span> = <span class="mxinfo" id="T2:U18">size( <span class="var type1" id="S397T17U1954">C_Spine_LForeArm</span>,1 )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,362" id="srcline362">362</a></span><span class="line"><span class="mxinfo" id="T8:U20"><span class="var type1" id="S395T8U1958">LElbow_Nao</span> = <span class="mxinfo" id="T8:U22">zeros(<span class="mxinfo" id="T2:U23"><span class="var type1" id="S404T2U1961">Nframes</span></span>,<span class="mxinfo" id="T2:U25">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,363" id="srcline363">363</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S407T2U1965">k</span>=<span class="mxinfo" id="T2:U27">1:<span class="var type1" id="S404T2U1968">Nframes</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,364" id="srcline364">364</a></span><span class="line">    <span class="mxinfo" id="T2:U29">[<span class="var type1" id="S408T2U1972">x</span>,<span class="var type1" id="S409T2U1973">y</span>,<span class="var type1" id="S410T2U1974">z</span>] = deal( <span class="mxinfo" id="T2:U33"><span class="var type1" id="S402T17U1978">C_LArmNew_LForeArm</span>(<span class="mxinfo" id="T2:U35"><span class="var type1" id="S407T2U1979">k</span></span>,<span class="mxinfo" id="T2:U37">1</span>,<span class="mxinfo" id="T2:U38">1</span>)</span>,<span class="mxinfo" id="T2:U39"><span class="var type1" id="S402T17U1983">C_LArmNew_LForeArm</span>(<span class="mxinfo" id="T2:U41"><span class="var type1" id="S407T2U1984">k</span></span>,<span class="mxinfo" id="T2:U43">1</span>,<span class="mxinfo" id="T2:U44">2</span>)</span>,<span class="mxinfo" id="T2:U45"><span class="var type1" id="S402T17U1988">C_LArmNew_LForeArm</span>(<span class="mxinfo" id="T2:U47"><span class="var type1" id="S407T2U1989">k</span></span>,<span class="mxinfo" id="T2:U49">1</span>,<span class="mxinfo" id="T2:U50">3</span>)</span> )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,365" id="srcline365">365</a></span><span class="line">    <span class="comment">%     %%% LElbowRoll &gt; 0  % 人很少做的动作：人左手不会这么转</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,366" id="srcline366">366</a></span><span class="line">    <span class="comment">%     LElbowRoll1 = acos(x) ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,367" id="srcline367">367</a></span><span class="line">    <span class="comment">%     LElbowYaw1 = atan2( y,-z );</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,368" id="srcline368">368</a></span><span class="line">    <span class="comment">%     LElbow_Nao1 = [ LElbowYaw1 LElbowRoll1 0 ];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,369" id="srcline369">369</a></span><span class="line">    <span class="comment">%%% LElbowRoll &lt; 0  % 人正常动作</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,370" id="srcline370">370</a></span><span class="line">    <span class="mxinfo" id="T2:U51"><span class="var type1" id="S412T2U1994">LElbowRoll2</span> = <span class="mxinfo" id="T2:U53">-<span class="mxinfo" id="T2:U54">acos(<span class="var type1" id="S408T2U1998">x</span>)</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,371" id="srcline371">371</a></span><span class="line">    <span class="mxinfo" id="T2:U56"><span class="var type1" id="S414T2U2001">LElbowYaw2</span> = <span class="mxinfo" id="T2:U58">atan2( <span class="mxinfo" id="T2:U59">-<span class="var type1" id="S409T2U2005">y</span></span>,<span class="var type1" id="S410T2U2006">z</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,372" id="srcline372">372</a></span><span class="line">    <span class="mxinfo" id="T8:U62"><span class="var type1" id="S416T8U2009">LElbow_Nao2</span> = <span class="mxinfo" id="T8:U64">[ <span class="var type1" id="S414T2U2012">LElbowYaw2</span> <span class="var type1" id="S412T2U2013">LElbowRoll2</span> <span class="mxinfo" id="T2:U67">0</span> ]</span></span>;   </span></span>
<span class="srcline"><span class="lineno"><a href="1,373" id="srcline373">373</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,374" id="srcline374">374</a></span><span class="line">    <span class="mxinfo" id="T8:U68"><span class="mxinfo" id="T8:U69"><span class="var type1" id="S395T8U2018">LElbow_Nao</span>(<span class="mxinfo" id="T2:U71"><span class="var type1" id="S407T2U2019">k</span></span>,:)</span> = <span class="var type1" id="S416T8U2021">LElbow_Nao2</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,375" id="srcline375">375</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,376" id="srcline376">376</a></span><span class="line"><span class="comment">%%% get new BVH</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,377" id="srcline377">377</a></span><span class="line"><span class="mxinfo" id="T7:U74"><span class="var type1" id="S417T7U2024">LElbow_rotateOrder</span> = <span class="mxinfo" id="T7:U76"><span class="string">'XYZ'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,378" id="srcline378">378</a></span><span class="line"><span class="mxinfo" id="T8:U77"><span class="var type1" id="S396T8U2028">LeftForeArm_new</span> = <span class="mxinfo" id="T8:U79">zeros(<span class="mxinfo" id="T2:U80"><span class="var type1" id="S404T2U2031">Nframes</span></span>,<span class="mxinfo" id="T2:U82">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,379" id="srcline379">379</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S407T2U2035">k</span>=<span class="mxinfo" id="T2:U84">1:<span class="var type1" id="S404T2U2038">Nframes</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,380" id="srcline380">380</a></span><span class="line">    <span class="mxinfo" id="T8:U86"><span class="mxinfo" id="T8:U87"><span class="var type1" id="S396T8U2042">LeftForeArm_new</span>(<span class="mxinfo" id="T2:U89"><span class="var type1" id="S407T2U2043">k</span></span>,:)</span> = <span class="mxinfo" id="T8:U91"><span class="fcn" id="F174N25:B2046">ChangeEulerRotate_c</span>(  <span class="mxinfo" id="T8:U92"><span class="var type1" id="S395T8U2048">LElbow_Nao</span>( <span class="mxinfo" id="T2:U94"><span class="var type1" id="S407T2U2049">k</span></span>,: )</span>,<span class="var type1" id="S417T7U2051">LElbow_rotateOrder</span>,<span class="var type1" id="S399T7U2052">rotateOrder_BVH</span> ,<span class="mxinfo" id="T8:U98">[1,1,1]</span>,<span class="mxinfo" id="T8:U99">[1,1,1]</span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,381" id="srcline381">381</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,382" id="srcline382">382</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,383" id="srcline383">383</a></span><span class="line"><span class="comment">%% RHand</span></span></span>
</pre>
