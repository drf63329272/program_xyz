<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,248" id="srcline248">248</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,249" id="srcline249">249</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,250" id="srcline250">250</a></span><span class="line"><span class="comment">%% TransformHead</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,251" id="srcline251">251</a></span><span class="line"><span class="comment">% E_spine_head: euler from spine3 to head</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,252" id="srcline252">252</a></span><span class="line"><span class="comment">% rotateOrder : rotate order of "E_spine_head"</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,253" id="srcline253">253</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S297T2U1351">HeadYaw</span>,<span class="var type1" id="S298T2U1352">HeadPitch</span>,<span class="var type1" id="S299T8U1353">Head_new</span> ] = TransformHead(  <span class="var type1" id="S300T17U1356">C_Spine_Head</span>,<span class="var type1" id="S301T17U1357">C_Spine_NeckNew</span>,<span class="mxinfo" id="T7:U6"><span class="var type2" id="S302T7V1U1358">rotateOrder_BVH</span></span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,254" id="srcline254">254</a></span><span class="line"><span class="mxinfo" id="T8:U8"><span class="var type1" id="S303T8U1361">rotateDirection_BVH</span> = <span class="mxinfo" id="T8:U10">[1,1,1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,255" id="srcline255">255</a></span><span class="line"><span class="mxinfo" id="T7:U11"><span class="var type1" id="S304T7U1369">Head_rotateOrder</span> = <span class="mxinfo" id="T7:U13"><span class="string">'YXZ'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,256" id="srcline256">256</a></span><span class="line"><span class="mxinfo" id="T17:U14"><span class="var type1" id="S305T17U1373">C_NeckNew_Spine</span> = <span class="mxinfo" id="T17:U16"><span class="fcn" id="F76N9:B1375">InverseC_Multi</span>( <span class="var type1" id="S301T17U1376">C_Spine_NeckNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,257" id="srcline257">257</a></span><span class="line"><span class="mxinfo" id="T17:U18"><span class="var type1" id="S307T17U1379">C_NeckNew_Head</span> = <span class="mxinfo" id="T17:U20"><span class="fcn" id="F73N4:B1381">CalculateC_Multi</span>( <span class="var type1" id="S305T17U1382">C_NeckNew_Spine</span>,<span class="var type1" id="S300T17U1383">C_Spine_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,258" id="srcline258">258</a></span><span class="line"><span class="mxinfo" id="T8:U23"><span class="var type1" id="S309T8U1386">E_Spine_Head</span> = <span class="mxinfo" id="T8:U25"><span class="fcn" id="F118N23:B1388">CToEuler_c</span>( <span class="var type1" id="S307T17U1389">C_NeckNew_Head</span>,<span class="var type1" id="S304T7U1390">Head_rotateOrder</span>,<span class="mxinfo" id="T8:U28"><span class="var type1" id="S303T8U1391">rotateDirection_BVH</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,259" id="srcline259">259</a></span><span class="line"><span class="mxinfo" id="T2:U30"><span class="mxinfo" id="T2:U31"><span class="var type1" id="S309T8U1395">E_Spine_Head</span>(:,<span class="mxinfo" id="T2:U33">3</span>)</span> = <span class="mxinfo" id="T2:U34">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,260" id="srcline260">260</a></span><span class="line"><span class="mxinfo" id="T2:U35"><span class="var type1" id="S297T2U1401">HeadYaw</span> = <span class="mxinfo" id="T2:U37"><span class="var type1" id="S309T8U1404">E_Spine_Head</span>(:,<span class="mxinfo" id="T2:U39">1</span>)</span>'</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,261" id="srcline261">261</a></span><span class="line"><span class="mxinfo" id="T2:U40"><span class="var type1" id="S298T2U1409">HeadPitch</span> = <span class="mxinfo" id="T2:U42"><span class="var type1" id="S309T8U1412">E_Spine_Head</span>(:,<span class="mxinfo" id="T2:U44">2</span>)</span>'</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,262" id="srcline262">262</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,263" id="srcline263">263</a></span><span class="line"><span class="comment">%%% get new BVH</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,264" id="srcline264">264</a></span><span class="line"><span class="mxinfo" id="T17:U45"><span class="var type1" id="S311T17U1417">C_Spine_HeadNew</span> = <span class="mxinfo" id="T17:U47"><span class="fcn" id="F43N26:B1419">EulerToC_c</span>( <span class="var type1" id="S309T8U1420">E_Spine_Head</span>,<span class="var type1" id="S304T7U1421">Head_rotateOrder</span> ,<span class="mxinfo" id="T8:U50">[1,1,1]</span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,265" id="srcline265">265</a></span><span class="line"><span class="mxinfo" id="T8:U51"><span class="var type1" id="S299T8U1429">Head_new</span> = <span class="mxinfo" id="T8:U53"><span class="fcn" id="F118N23:B1431">CToEuler_c</span>( <span class="var type1" id="S311T17U1432">C_Spine_HeadNew</span>,<span class="var type1" id="S302T7U1433">rotateOrder_BVH</span>,<span class="mxinfo" id="T8:U56"><span class="var type1" id="S303T8U1434">rotateDirection_BVH</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,266" id="srcline266">266</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,267" id="srcline267">267</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,268" id="srcline268">268</a></span><span class="line"><span class="comment">%% RightShoulder</span></span></span>
</pre>
