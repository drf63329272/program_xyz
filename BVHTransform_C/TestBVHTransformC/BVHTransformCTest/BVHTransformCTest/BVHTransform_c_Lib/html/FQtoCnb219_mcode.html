<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="71,1" id="srcline1"> 1</a></span><span class="line"><span class="comment">% buaa xyz 2014.1.10</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="71,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% 四元数 -&gt; 方向余弦矩阵</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,4" id="srcline4"> 4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="71,5" id="srcline5"> 5</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T11U3">Cnb</span> = FQtoCnb(<span class="var type1" id="S3T36U6">Q</span>) <span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% format long</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,7" id="srcline7"> 7</a></span><span class="line">coder.inline(<span class="string">'never'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="71,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="71,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo" id="T36:U3"><span class="var type1" id="S3T36U15">Q</span>=<span class="mxinfo" id="T36:U5"><span class="var type1" id="S3T36U17">Q</span>/<span class="mxinfo" id="T2:U7">norm(<span class="var type1" id="S3T36U20">Q</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo" id="T2:U9"><span class="var type1" id="S6T2U23">q0</span> = <span class="mxinfo" id="T2:U11"><span class="var type1" id="S3T36U25">Q</span>(<span class="mxinfo" id="T2:U13">1</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="71,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo" id="T2:U14"><span class="var type1" id="S7T2U29">q1</span> = <span class="mxinfo" id="T2:U16"><span class="var type1" id="S3T36U31">Q</span>(<span class="mxinfo" id="T2:U18">2</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="71,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo" id="T2:U19"><span class="var type1" id="S8T2U35">q2</span> = <span class="mxinfo" id="T2:U21"><span class="var type1" id="S3T36U37">Q</span>(<span class="mxinfo" id="T2:U23">3</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="71,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo" id="T2:U24"><span class="var type1" id="S9T2U41">q3</span> = <span class="mxinfo" id="T2:U26"><span class="var type1" id="S3T36U43">Q</span>(<span class="mxinfo" id="T2:U28">4</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="71,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo" id="T11:U29"><span class="var type1" id="S2T11U47">Cnb</span>=<span class="mxinfo" id="T11:U31">[   <span class="mxinfo" id="T8:U32"><span class="mxinfo" id="T2:U33"><span class="mxinfo" id="T2:U34"><span class="mxinfo" id="T2:U35"><span class="mxinfo" id="T2:U36"><span class="var type1" id="S6T2U54">q0</span>^2</span>+<span class="mxinfo" id="T2:U38"><span class="var type1" id="S7T2U57">q1</span>^2</span></span>-<span class="mxinfo" id="T2:U40"><span class="var type1" id="S8T2U60">q2</span>^2</span></span>-<span class="mxinfo" id="T2:U42"><span class="var type1" id="S9T2U63">q3</span>^2</span></span>,    <span class="mxinfo" id="T2:U44"><span class="mxinfo" id="T2:U45">2</span>*(<span class="mxinfo" id="T2:U46"><span class="mxinfo" id="T2:U47"><span class="var type1" id="S7T2U70">q1</span>*<span class="var type1" id="S8T2U71">q2</span></span>+<span class="mxinfo" id="T2:U50"><span class="var type1" id="S6T2U73">q0</span>*<span class="var type1" id="S9T2U74">q3</span></span></span>)</span>,            <span class="mxinfo" id="T2:U53"><span class="mxinfo" id="T2:U54">2</span>*(<span class="mxinfo" id="T2:U55"><span class="mxinfo" id="T2:U56"><span class="var type1" id="S7T2U80">q1</span>*<span class="var type1" id="S9T2U81">q3</span></span>-<span class="mxinfo" id="T2:U59"><span class="var type1" id="S6T2U83">q0</span>*<span class="var type1" id="S8T2U84">q2</span></span></span>)</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo" id="T11:U29"><span class="mxinfo" id="T11:U31">        <span class="mxinfo" id="T8:U62"><span class="mxinfo" id="T2:U63"><span class="mxinfo" id="T2:U64">2</span>*(<span class="mxinfo" id="T2:U65"><span class="mxinfo" id="T2:U66"><span class="var type1" id="S7T2U91">q1</span>*<span class="var type1" id="S8T2U92">q2</span></span>-<span class="mxinfo" id="T2:U69"><span class="var type1" id="S6T2U94">q0</span>*<span class="var type1" id="S9T2U95">q3</span></span></span>)</span>,        <span class="mxinfo" id="T2:U72"><span class="mxinfo" id="T2:U73"><span class="mxinfo" id="T2:U74"><span class="mxinfo" id="T2:U75"><span class="var type1" id="S6T2U100">q0</span>*<span class="var type1" id="S6T2U101">q0</span></span>-<span class="mxinfo" id="T2:U78"><span class="var type1" id="S7T2U103">q1</span>*<span class="var type1" id="S7T2U104">q1</span></span></span>+<span class="mxinfo" id="T2:U81"><span class="var type1" id="S8T2U106">q2</span>*<span class="var type1" id="S8T2U107">q2</span></span></span>-<span class="mxinfo" id="T2:U84"><span class="var type1" id="S9T2U109">q3</span>*<span class="var type1" id="S9T2U110">q3</span></span></span>,    <span class="mxinfo" id="T2:U87"><span class="mxinfo" id="T2:U88">2</span>*(<span class="mxinfo" id="T2:U89"><span class="mxinfo" id="T2:U90"><span class="var type1" id="S8T2U116">q2</span>*<span class="var type1" id="S9T2U117">q3</span></span>+<span class="mxinfo" id="T2:U93"><span class="var type1" id="S6T2U119">q0</span>*<span class="var type1" id="S7T2U120">q1</span></span></span>)</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo" id="T11:U29"><span class="mxinfo" id="T11:U31">        <span class="mxinfo" id="T8:U96"><span class="mxinfo" id="T2:U97"><span class="mxinfo" id="T2:U98">2</span>*(<span class="mxinfo" id="T2:U99"><span class="mxinfo" id="T2:U100"><span class="var type1" id="S7T2U127">q1</span>*<span class="var type1" id="S9T2U128">q3</span></span>+<span class="mxinfo" id="T2:U103"><span class="var type1" id="S6T2U130">q0</span>*<span class="var type1" id="S8T2U131">q2</span></span></span>)</span>,        <span class="mxinfo" id="T2:U106"><span class="mxinfo" id="T2:U107">2</span>*(<span class="mxinfo" id="T2:U108"><span class="mxinfo" id="T2:U109"><span class="var type1" id="S8T2U137">q2</span>*<span class="var type1" id="S9T2U138">q3</span></span>-<span class="mxinfo" id="T2:U112"><span class="var type1" id="S6T2U140">q0</span>*<span class="var type1" id="S7T2U141">q1</span></span></span>)</span>,            <span class="mxinfo" id="T2:U115"><span class="mxinfo" id="T2:U116"><span class="mxinfo" id="T2:U117"><span class="mxinfo" id="T2:U118"><span class="var type1" id="S6T2U146">q0</span>*<span class="var type1" id="S6T2U147">q0</span></span>-<span class="mxinfo" id="T2:U121"><span class="var type1" id="S7T2U149">q1</span>*<span class="var type1" id="S7T2U150">q1</span></span></span>-<span class="mxinfo" id="T2:U124"><span class="var type1" id="S8T2U152">q2</span>*<span class="var type1" id="S8T2U153">q2</span></span></span>+<span class="mxinfo" id="T2:U127"><span class="var type1" id="S9T2U155">q3</span>*<span class="var type1" id="S9T2U156">q3</span></span></span></span>     ]</span></span>;</span></span>
</pre>
