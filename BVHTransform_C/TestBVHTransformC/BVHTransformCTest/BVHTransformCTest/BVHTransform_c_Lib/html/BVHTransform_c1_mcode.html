<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="comment">%% xyz  2015.3.25</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% Transform BVH data Format</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% BVHData: 1*354  degree</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T37U3">NaoData</span> = BVHTransform_c( <span class="var type1" id="S3T1U6">BVHData</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="mxinfo" id="T1:U3"><span class="var type1" id="S3T1U9">BVHData</span> = <span class="mxinfo" id="T1:U5"><span class="mxinfo" id="T1:U6"><span class="var type1" id="S3T1U12">BVHData</span>*<span class="mxinfo" id="T2:U8">pi</span></span>/<span class="mxinfo" id="T2:U9">180</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="mxinfo" id="T2:U10"><span class="var type1" id="S5T2U18">Nframes</span> = <span class="mxinfo" id="T2:U12">size(<span class="var type1" id="S3T1U21">BVHData</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="mxinfo" id="T7:U14"><span class="var type1" id="S7T7U25">rotateOrder_BVH</span> = <span class="mxinfo" id="T7:U16"><span class="string">'YXZ'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="mxinfo" id="T8:U17"><span class="var type1" id="S8T8U29">rotateDirection_BVH</span> = <span class="mxinfo" id="T8:U19">[1,1,1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="mxinfo" id="T17:U20">[ <span class="var type1" id="S9T17U38">C_World_Hip</span>,<span class="var type1" id="S10T17U39">C_Hip_Spine</span>,<span class="var type1" id="S11T17U40">C_Spine_Spine1</span>,<span class="var type1" id="S12T17U41">C_Spine1_Spine2</span>,<span class="var type1" id="S13T17U42">C_Spine2_Spine3</span>,<span class="var type1" id="S14T17U43">C_Spine3_Neck</span>,<span class="var type1" id="S15T17U44">C_Neck_Head</span>,<span class="var type1" id="S16T17U45">C_Spine3_LShoulder</span>,<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="mxinfo" id="T17:U20"><span class="var type1" id="S17T17U46">C_LShoulder_LArm</span>,<span class="var type1" id="S18T17U47">C_LArm_LForeArm</span>,<span class="var type1" id="S19T17U48">C_LForeArm_LHand</span>,<span class="var type1" id="S20T17U49">C_Spine3_RShoulder</span>,<span class="var type1" id="S21T17U50">C_RShoulder_RArm</span>,<span class="var type1" id="S22T17U51">C_RArm_RForeArm</span>,<span class="var type1" id="S23T17U52">C_RForeArm_RHand</span>,<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="mxinfo" id="T17:U20"><span class="var type1" id="S24T17U53">C_Hip_RUpLeg</span>,<span class="var type1" id="S25T17U54">C_RUpLeg_RLeg</span>,<span class="var type1" id="S26T17U55">C_RLeg_RFoot</span>,<span class="var type1" id="S27T17U56">C_Hip_LUpLeg</span>,<span class="var type1" id="S28T17U57">C_LUpLeg_LLeg</span>,<span class="var type1" id="S29T17U58">C_LLeg_LFoot</span> ] = <span class="fcn" id="F44N3:B60">BVHDataToRotate_c</span>( <span class="var type1" id="S3T1U61">BVHData</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%% 所有BVH的旋转数据</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="mxinfo" id="T17:U43">[ <span class="var type1" id="S31T17U65">C_Hip_Spine2</span>,<span class="var type1" id="S32T17U66">C_Hip_Spine3</span>,<span class="var type1" id="S33T17U67">C_Spine_Spine3</span>, <span class="var type1" id="S34T17U68">C_Hip_LArm</span>,<span class="var type1" id="S35T17U69">C_Hip_LForeArm</span>,<span class="var type1" id="S36T17U70">C_Hip_LHand</span>, <span class="var type1" id="S37T17U71">C_Spine_LArm</span>,<span class="var type1" id="S38T17U72">C_Spine_LForeArm</span>,<span class="var type1" id="S39T17U73">C_Spine_LHand</span>, <span class="var type1" id="S40T17U74">C_Spine2_LArm</span>,<span class="var type1" id="S41T17U75">C_Spine2_LForeArm</span>,<span class="var type1" id="S42T17U76">C_Spine2_LHand</span>,<span class="var type1" id="S43T17U77">C_Spine3_LArm</span>,<span class="var type1" id="S44T17U78">C_Spine3_LForeArm</span>,<span class="var type1" id="S45T17U79">C_Spine3_LHand</span> ]  = <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo" id="T17:U43">    <span class="fcn" id="F74N6:B81">CalculatedLeftArmRotate</span>( <span class="var type1" id="S10T17U82">C_Hip_Spine</span>,<span class="var type1" id="S11T17U83">C_Spine_Spine1</span>,<span class="var type1" id="S12T17U84">C_Spine1_Spine2</span>,<span class="var type1" id="S13T17U85">C_Spine2_Spine3</span>,<span class="var type1" id="S16T17U86">C_Spine3_LShoulder</span>,<span class="var type1" id="S17T17U87">C_LShoulder_LArm</span>,<span class="var type1" id="S18T17U88">C_LArm_LForeArm</span>,<span class="var type1" id="S19T17U89">C_LForeArm_LHand</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo" id="T17:U67">[ <span class="var type1" id="S47T17U93">C_Hip_RArm</span>,<span class="var type1" id="S48T17U94">C_Hip_RForeArm</span>,<span class="var type1" id="S49T17U95">C_Hip_RHand</span>, <span class="var type1" id="S50T17U96">C_Spine_RArm</span>,<span class="var type1" id="S51T17U97">C_Spine_RForeArm</span>,<span class="var type1" id="S52T17U98">C_Spine_RHand</span>, <span class="var type1" id="S53T17U99">C_Spine2_RArm</span>,<span class="var type1" id="S54T17U100">C_Spine2_RForeArm</span>,<span class="var type1" id="S55T17U101">C_Spine2_RHand</span>,<span class="var type1" id="S56T17U102">C_Spine3_RArm</span>,<span class="var type1" id="S57T17U103">C_Spine3_RForeArm</span>,<span class="var type1" id="S58T17U104">C_Spine3_RHand</span> ]  = <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="mxinfo" id="T17:U67">    <span class="fcn" id="F75N8:B106">CalculatedRightArmRotate</span>( <span class="var type1" id="S32T17U107">C_Hip_Spine3</span>,<span class="var type1" id="S13T17U108">C_Spine2_Spine3</span>,<span class="var type1" id="S33T17U109">C_Spine_Spine3</span>,<span class="var type1" id="S20T17U110">C_Spine3_RShoulder</span>,<span class="var type1" id="S21T17U111">C_RShoulder_RArm</span>,<span class="var type1" id="S22T17U112">C_RArm_RForeArm</span>,<span class="var type1" id="S23T17U113">C_RForeArm_RHand</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="mxinfo" id="T17:U87">[ <span class="var type1" id="S60T17U117">C_Hip_LLeg</span>,<span class="var type1" id="S61T17U118">C_Spine2_LLeg</span>,<span class="var type1" id="S62T17U119">C_Spine3_LLeg</span> ] = <span class="fcn" id="F77N5:B121">CalculatedLLegRotate</span>( <span class="var type1" id="S31T17U122">C_Hip_Spine2</span>,<span class="var type1" id="S32T17U123">C_Hip_Spine3</span>,<span class="var type1" id="S27T17U124">C_Hip_LUpLeg</span>,<span class="var type1" id="S28T17U125">C_LUpLeg_LLeg</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="mxinfo" id="T17:U95">[ <span class="var type1" id="S64T17U129">C_Hip_RLeg</span>,<span class="var type1" id="S65T17U130">C_Spine2_RLeg</span>,<span class="var type1" id="S66T17U131">C_Spine3_RLeg</span> ] = <span class="fcn" id="F78N7:B133">CalculatedRLegRotate</span>( <span class="var type1" id="S31T17U134">C_Hip_Spine2</span>,<span class="var type1" id="S32T17U135">C_Hip_Spine3</span>,<span class="var type1" id="S24T17U136">C_Hip_RUpLeg</span>,<span class="var type1" id="S25T17U137">C_RUpLeg_RLeg</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="mxinfo" id="T2:U103"><span class="var type1" id="S68T2U140">HipYawPitch</span> = <span class="mxinfo" id="T2:U105">zeros(1,size(<span class="var type1" id="S10T17U146">C_Hip_Spine</span>,1))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%% common parameters to set</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">% reference joint : 'Hip'  'SPine'  'Spine3'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="mxinfo" id="T25:U107"><span class="var type1" id="S70T25U150">refJoint1</span> = <span class="mxinfo" id="T25:U109"><span class="string">'Spine2'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="mxinfo" id="T25:U110"><span class="var type1" id="S71T25U154">referenceOfHead</span> = <span class="var type1" id="S70T25U155">refJoint1</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="mxinfo" id="T25:U113"><span class="var type1" id="S72T25U158">referenceOfArm</span> = <span class="var type1" id="S70T25U159">refJoint1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="mxinfo" id="T25:U116"><span class="var type1" id="S73T25U162">referenceOfForeArm</span> = <span class="var type1" id="S70T25U163">refJoint1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="mxinfo" id="T25:U119"><span class="var type1" id="S74T25U166">referenceOfHand</span> =  <span class="var type1" id="S70T25U167">refJoint1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="mxinfo" id="T8:U122"><span class="var type1" id="S75T8U170">E_0</span> = <span class="mxinfo" id="T8:U124">zeros( <span class="var type1" id="S5T2U173">Nframes</span>,3 )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="mxinfo" id="T8:U126"><span class="var type1" id="S76T8U177">RightShoulder_new</span> = <span class="var type1" id="S75T8U178">E_0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo" id="T8:U129"><span class="var type1" id="S77T8U181">LeftShoulder_new</span> = <span class="mxinfo" id="T8:U131"><span class="var type1" id="S75T8U182">E_0</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo" id="T8:U133"><span class="var type1" id="S78T8U185">Spine3_new</span> = <span class="var type1" id="S75T8U186">E_0</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="mxinfo" id="T8:U136"><span class="var type1" id="S79T8U189">Spine2_new</span> = <span class="var type1" id="S75T8U190">E_0</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="mxinfo" id="T8:U139"><span class="var type1" id="S80T8U193">Spine_new</span> = <span class="var type1" id="S75T8U194">E_0</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="mxinfo" id="T8:U142"><span class="var type1" id="S81T8U197">Neck_new</span> = <span class="var type1" id="S75T8U198">E_0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="mxinfo" id="T17:U145"><span class="var type1" id="S82T17U201">C_I</span> = <span class="mxinfo" id="T17:U147">zeros( <span class="mxinfo" id="T2:U148"><span class="var type1" id="S5T2U204">Nframes</span></span>,<span class="mxinfo" id="T2:U150">3</span>,<span class="mxinfo" id="T2:U151">3</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S83T2U209">k</span>=<span class="mxinfo" id="T2:U153">1:<span class="var type1" id="S5T2U212">Nframes</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo" id="T17:U155"><span class="mxinfo" id="T17:U156"><span class="var type1" id="S82T17U216">C_I</span>(<span class="mxinfo" id="T2:U158"><span class="var type1" id="S83T2U217">k</span></span>,:,:)</span> = <span class="mxinfo" id="T11:U160">eye(3)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="mxinfo" id="T17:U161"><span class="var type1" id="S85T17U225">C_Spine3New_NeckNew</span> = <span class="var type1" id="S82T17U226">C_I</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="mxinfo" id="T17:U164"><span class="var type1" id="S86T17U229">C_Spine2New_Spine3New</span> = <span class="var type1" id="S82T17U230">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="mxinfo" id="T17:U167"><span class="var type1" id="S87T17U233">C_SpineNew_Spine3New</span> = <span class="var type1" id="S82T17U234">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="mxinfo" id="T17:U170"><span class="var type1" id="S88T17U237">C_HipNew_Spine3New</span> = <span class="var type1" id="S82T17U238">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="mxinfo" id="T17:U173"><span class="var type1" id="S89T17U241">C_Spine3New_LShoulderNew</span> = <span class="var type1" id="S82T17U242">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="mxinfo" id="T17:U176"><span class="var type1" id="S90T17U245">C_Spine3New_RShoulderNew</span> = <span class="var type1" id="S82T17U246">C_I</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="comment">%%% New Hip</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="mxinfo" id="T17:U179"><span class="var type1" id="S91T17U249">C_World_Spine2</span> = <span class="mxinfo" id="T17:U181"><span class="fcn" id="F73N4:B251">CalculateC_Multi</span>( <span class="var type1" id="S9T17U252">C_World_Hip</span>,<span class="var type1" id="S31T17U253">C_Hip_Spine2</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="mxinfo" id="T8:U184"><span class="var type1" id="S93T8U256">E_World_Spine2</span> = <span class="mxinfo" id="T8:U186"><span class="fcn" id="F118N23:B258">CToEuler_c</span>( <span class="var type1" id="S91T17U259">C_World_Spine2</span>,<span class="var type1" id="S7T7U260">rotateOrder_BVH</span>,<span class="mxinfo" id="T8:U189"><span class="var type1" id="S8T8U261">rotateDirection_BVH</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="mxinfo" id="T8:U191"><span class="var type1" id="S95T8U264">ROOT_Hips_RotationNew</span> = <span class="var type1" id="S93T8U265">E_World_Spine2</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="comment">%% head</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="mxinfo" id="T17:U194"><span class="var type1" id="S96T17U268">C_Spine3_Head</span> = <span class="mxinfo" id="T17:U196"><span class="fcn" id="F73N4:B270">CalculateC_Multi</span>( <span class="var type1" id="S14T17U271">C_Spine3_Neck</span>,<span class="var type1" id="S15T17U272">C_Neck_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"><span class="mxinfo" id="T17:U199"><span class="var type1" id="S97T17U275">C_Spine2_Head</span> = <span class="mxinfo" id="T17:U201"><span class="fcn" id="F73N4:B277">CalculateC_Multi</span>( <span class="var type1" id="S13T17U278">C_Spine2_Spine3</span>,<span class="var type1" id="S96T17U279">C_Spine3_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"><span class="mxinfo" id="T17:U204"><span class="var type1" id="S98T17U282">C_Spine_Head</span> = <span class="mxinfo" id="T17:U206"><span class="fcn" id="F73N4:B284">CalculateC_Multi</span>( <span class="var type1" id="S33T17U285">C_Spine_Spine3</span>,<span class="var type1" id="S96T17U286">C_Spine3_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="mxinfo" id="T17:U209"><span class="var type1" id="S99T17U289">C_Hip_Head</span> = <span class="mxinfo" id="T17:U211"><span class="fcn" id="F73N4:B291">CalculateC_Multi</span>( <span class="var type1" id="S32T17U292">C_Hip_Spine3</span>,<span class="var type1" id="S96T17U293">C_Spine3_Head</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="mxinfo" id="T17:U214"><span class="var type1" id="S100T17U296">C_Spine2New_NeckNew</span> = <span class="mxinfo" id="T17:U216"><span class="fcn" id="F73N4:B298">CalculateC_Multi</span>( <span class="var type1" id="S86T17U299">C_Spine2New_Spine3New</span>,<span class="var type1" id="S85T17U300">C_Spine3New_NeckNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="mxinfo" id="T17:U219"><span class="var type1" id="S101T17U303">C_SpineNew_NeckNew</span> = <span class="mxinfo" id="T17:U221"><span class="fcn" id="F73N4:B305">CalculateC_Multi</span>( <span class="var type1" id="S87T17U306">C_SpineNew_Spine3New</span>,<span class="var type1" id="S85T17U307">C_Spine3New_NeckNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="mxinfo" id="T17:U224"><span class="var type1" id="S102T17U310">C_HipNew_NeckNew</span> = <span class="mxinfo" id="T17:U226"><span class="fcn" id="F73N4:B312">CalculateC_Multi</span>( <span class="var type1" id="S88T17U313">C_HipNew_Spine3New</span>,<span class="var type1" id="S85T17U314">C_Spine3New_NeckNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line"><span class="mxinfo" id="T17:U229"><span class="var type1" id="S103T17U317">C_RefHead_Head</span> = <span class="var type1" id="S97T17U318">C_Spine2_Head</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="mxinfo" id="T17:U232"><span class="var type1" id="S104T17U321">C_RefHeadNew_NeckNew</span> = <span class="var type1" id="S100T17U322">C_Spine2New_NeckNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"><span class="mxinfo" id="T2:U235">[ <span class="var type1" id="S105T2U326">HeadYaw</span>,<span class="var type1" id="S106T2U327">HeadPitch</span>,<span class="var type1" id="S107T8U328">Head_new</span> ] = <span class="fcn" id="F119N10:B330">TransformHead</span>(  <span class="var type1" id="S103T17U331">C_RefHead_Head</span>,<span class="var type1" id="S104T17U332">C_RefHeadNew_NeckNew</span>,<span class="var type1" id="S7T7U333">rotateOrder_BVH</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="comment">%% Right Shoulder</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"><span class="mxinfo" id="T17:U242"><span class="var type1" id="S109T17U336">C_Spine2New_RShoulderNew</span> = <span class="mxinfo" id="T17:U244"><span class="fcn" id="F73N4:B338">CalculateC_Multi</span>( <span class="var type1" id="S86T17U339">C_Spine2New_Spine3New</span>,<span class="var type1" id="S90T17U340">C_Spine3New_RShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"><span class="mxinfo" id="T17:U247"><span class="var type1" id="S110T17U343">C_SpineNew_RShoulderNew</span> = <span class="mxinfo" id="T17:U249"><span class="fcn" id="F73N4:B345">CalculateC_Multi</span>( <span class="var type1" id="S87T17U346">C_SpineNew_Spine3New</span>,<span class="var type1" id="S90T17U347">C_Spine3New_RShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"><span class="mxinfo" id="T17:U252"><span class="var type1" id="S111T17U350">C_HipNew_RShoulderNew</span> = <span class="mxinfo" id="T17:U254"><span class="fcn" id="F73N4:B352">CalculateC_Multi</span>( <span class="var type1" id="S88T17U353">C_HipNew_Spine3New</span>,<span class="var type1" id="S90T17U354">C_Spine3New_RShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"><span class="mxinfo" id="T17:U257"><span class="var type1" id="S112T17U357">C_RefArm_RArm</span> = <span class="var type1" id="S53T17U358">C_Spine2_RArm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"><span class="mxinfo" id="T17:U260"><span class="var type1" id="S113T17U361">C_RefArmNew_RShoulderNew</span> = <span class="var type1" id="S109T17U362">C_Spine2New_RShoulderNew</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"><span class="mxinfo" id="T2:U263">[ <span class="var type1" id="S114T2U366">RShoulderPitch</span>,<span class="var type1" id="S115T2U367">RShoulderRoll</span>,<span class="var type1" id="S116T8U368">RightArm_new</span> ] = <span class="fcn" id="F157N21:B370">TransformRShoulder</span>(  <span class="var type1" id="S113T17U371">C_RefArmNew_RShoulderNew</span>,<span class="var type1" id="S112T17U372">C_RefArm_RArm</span>,<span class="var type1" id="S7T7U373">rotateOrder_BVH</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line"><span class="comment">%% Right Elbow</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"><span class="mxinfo" id="T17:U270"><span class="var type1" id="S118T17U376">C_RShoulderNew_RArmNew</span> = <span class="mxinfo" id="T17:U272"><span class="fcn" id="F43N26:B378">EulerToC_c</span>( <span class="var type1" id="S116T8U379">RightArm_new</span>,<span class="var type1" id="S7T7U380">rotateOrder_BVH</span>,<span class="mxinfo" id="T8:U275">[1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line"><span class="mxinfo" id="T17:U276"><span class="var type1" id="S120T17U388">C_Spine3New_RArmNew</span> = <span class="mxinfo" id="T17:U278"><span class="fcn" id="F73N4:B390">CalculateC_Multi</span>( <span class="var type1" id="S90T17U391">C_Spine3New_RShoulderNew</span>,<span class="var type1" id="S118T17U392">C_RShoulderNew_RArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"><span class="mxinfo" id="T17:U281"><span class="var type1" id="S121T17U395">C_Spine2New_RArmNew</span> = <span class="mxinfo" id="T17:U283"><span class="fcn" id="F73N4:B397">CalculateC_Multi</span>( <span class="var type1" id="S109T17U398">C_Spine2New_RShoulderNew</span>,<span class="var type1" id="S118T17U399">C_RShoulderNew_RArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"><span class="mxinfo" id="T17:U286"><span class="var type1" id="S122T17U402">C_SpineNew_RArmNew</span> = <span class="mxinfo" id="T17:U288"><span class="fcn" id="F73N4:B404">CalculateC_Multi</span>( <span class="var type1" id="S87T17U405">C_SpineNew_Spine3New</span>,<span class="var type1" id="S120T17U406">C_Spine3New_RArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line"><span class="mxinfo" id="T17:U291"><span class="var type1" id="S123T17U409">C_HipNew_RArmNew</span> = <span class="mxinfo" id="T17:U293"><span class="fcn" id="F73N4:B411">CalculateC_Multi</span>( <span class="var type1" id="S88T17U412">C_HipNew_Spine3New</span>,<span class="var type1" id="S120T17U413">C_Spine3New_RArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"><span class="mxinfo" id="T17:U296"><span class="var type1" id="S124T17U416">C_RefArm_RForeArm</span> = <span class="var type1" id="S54T17U417">C_Spine2_RForeArm</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line"><span class="mxinfo" id="T17:U299"><span class="var type1" id="S125T17U420">C_RefArmNew_RArmNew</span> = <span class="var type1" id="S121T17U421">C_Spine2New_RArmNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line"><span class="mxinfo" id="T8:U302">[ <span class="var type1" id="S126T8U425">RElbow_Nao</span>,<span class="var type1" id="S127T8U426">RightForeArm_new</span> ] = <span class="fcn" id="F175N17:B428">TransformRElbow</span>( <span class="var type1" id="S124T17U429">C_RefArm_RForeArm</span>,<span class="var type1" id="S125T17U430">C_RefArmNew_RArmNew</span>,<span class="var type1" id="S7T7U431">rotateOrder_BVH</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"><span class="mxinfo" id="T2:U308">[ <span class="var type1" id="S129T2U435">RElbowYaw</span>,<span class="var type1" id="S130T2U436">RElbowRoll</span> ] = deal( <span class="mxinfo" id="T2:U311"><span class="var type1" id="S126T8U441">RElbow_Nao</span>(:,<span class="mxinfo" id="T2:U313">1</span>)</span>',<span class="mxinfo" id="T2:U314"><span class="var type1" id="S126T8U446">RElbow_Nao</span>(:,<span class="mxinfo" id="T2:U316">2</span>)</span>' )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line"><span class="comment">%% RHand</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line"><span class="mxinfo" id="T17:U317"><span class="var type1" id="S132T17U451">C_RArmNew_RForeArmNew</span> = <span class="mxinfo" id="T17:U319"><span class="fcn" id="F43N26:B453">EulerToC_c</span>( <span class="var type1" id="S127T8U454">RightForeArm_new</span>,<span class="var type1" id="S7T7U455">rotateOrder_BVH</span>,<span class="mxinfo" id="T8:U322">[1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line"><span class="mxinfo" id="T17:U323"><span class="var type1" id="S133T17U463">C_Spine3New_RForeArmNew</span> = <span class="mxinfo" id="T17:U325"><span class="fcn" id="F73N4:B465">CalculateC_Multi</span>( <span class="var type1" id="S120T17U466">C_Spine3New_RArmNew</span>,<span class="var type1" id="S132T17U467">C_RArmNew_RForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line"><span class="mxinfo" id="T17:U328"><span class="var type1" id="S134T17U470">C_Spine2New_RForeArmNew</span> = <span class="mxinfo" id="T17:U330"><span class="fcn" id="F73N4:B472">CalculateC_Multi</span>( <span class="var type1" id="S121T17U473">C_Spine2New_RArmNew</span>,<span class="var type1" id="S132T17U474">C_RArmNew_RForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"><span class="mxinfo" id="T17:U333"><span class="var type1" id="S135T17U477">C_SpineNew_RForeArmNew</span> = <span class="mxinfo" id="T17:U335"><span class="fcn" id="F73N4:B479">CalculateC_Multi</span>( <span class="var type1" id="S87T17U480">C_SpineNew_Spine3New</span>,<span class="var type1" id="S133T17U481">C_Spine3New_RForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line"><span class="mxinfo" id="T17:U338"><span class="var type1" id="S136T17U484">C_HipNew_RForeArmNew</span> = <span class="mxinfo" id="T17:U340"><span class="fcn" id="F73N4:B486">CalculateC_Multi</span>( <span class="var type1" id="S88T17U487">C_HipNew_Spine3New</span>,<span class="var type1" id="S133T17U488">C_Spine3New_RForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"><span class="mxinfo" id="T17:U343"><span class="var type1" id="S137T17U491">C_RefArm_RHand</span> = <span class="var type1" id="S55T17U492">C_Spine2_RHand</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line"><span class="mxinfo" id="T17:U346"><span class="var type1" id="S138T17U495">C_RefArmNew_RForeArmNew</span> = <span class="var type1" id="S134T17U496">C_Spine2New_RForeArmNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="mxinfo" id="T2:U349">[ <span class="var type1" id="S139T2U500">RWristYaw</span>,<span class="var type1" id="S140T8U501">RightHand_new</span> ] = <span class="fcn" id="F179N19:B503">TransformRHand</span>( <span class="var type1" id="S137T17U504">C_RefArm_RHand</span>,<span class="var type1" id="S138T17U505">C_RefArmNew_RForeArmNew</span>,<span class="var type1" id="S7T7U506">rotateOrder_BVH</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line"><span class="comment">%% Left Shoulder</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="mxinfo" id="T17:U355"><span class="var type1" id="S142T17U509">C_Spine2New_LShoulderNew</span> = <span class="mxinfo" id="T17:U357"><span class="fcn" id="F73N4:B511">CalculateC_Multi</span>( <span class="var type1" id="S86T17U512">C_Spine2New_Spine3New</span>,<span class="var type1" id="S89T17U513">C_Spine3New_LShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line"><span class="mxinfo" id="T17:U360"><span class="var type1" id="S143T17U516">C_SpineNew_LShoulderNew</span> = <span class="mxinfo" id="T17:U362"><span class="fcn" id="F73N4:B518">CalculateC_Multi</span>( <span class="var type1" id="S87T17U519">C_SpineNew_Spine3New</span>,<span class="var type1" id="S89T17U520">C_Spine3New_LShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line"><span class="mxinfo" id="T17:U365"><span class="var type1" id="S144T17U523">C_HipNew_LShoulderNew</span> = <span class="mxinfo" id="T17:U367"><span class="fcn" id="F73N4:B525">CalculateC_Multi</span>( <span class="var type1" id="S88T17U526">C_HipNew_Spine3New</span>,<span class="var type1" id="S89T17U527">C_Spine3New_LShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line"><span class="mxinfo" id="T17:U370"><span class="var type1" id="S145T17U530">C_RefArm_LArm</span> = <span class="var type1" id="S40T17U531">C_Spine2_LArm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line"><span class="mxinfo" id="T17:U373"><span class="var type1" id="S146T17U534">C_RefArmNew_LShoulderNew</span> = <span class="var type1" id="S142T17U535">C_Spine2New_LShoulderNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line"><span class="mxinfo" id="T2:U376">[ <span class="var type1" id="S147T2U539">LShoulderPitch</span>,<span class="var type1" id="S148T2U540">LShoulderRoll</span>,<span class="var type1" id="S149T8U541">LeftArm_new</span> ] = <span class="fcn" id="F182N15:B543">TransformLShoulder</span>(  <span class="var type1" id="S146T17U544">C_RefArmNew_LShoulderNew</span>,<span class="var type1" id="S145T17U545">C_RefArm_LArm</span>,<span class="var type1" id="S7T7U546">rotateOrder_BVH</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line"><span class="comment">%% Left Elbow</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line"><span class="mxinfo" id="T17:U383"><span class="var type1" id="S89T17U549">C_Spine3New_LShoulderNew</span> = <span class="mxinfo" id="T17:U385"><span class="fcn" id="F43N26:B551">EulerToC_c</span>( <span class="var type1" id="S77T8U552">LeftShoulder_new</span>,<span class="var type1" id="S7T7U553">rotateOrder_BVH</span>,[1,1,1] )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"><span class="mxinfo" id="T17:U388"><span class="var type1" id="S151T17U561">C_LShoulderNew_LArmNew</span> = <span class="mxinfo" id="T17:U390"><span class="fcn" id="F43N26:B563">EulerToC_c</span>( <span class="var type1" id="S149T8U564">LeftArm_new</span>,<span class="var type1" id="S7T7U565">rotateOrder_BVH</span>,<span class="mxinfo" id="T8:U393">[1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line"><span class="mxinfo" id="T17:U394"><span class="var type1" id="S152T17U573">C_Spine3New_LArmNew</span> = <span class="mxinfo" id="T17:U396"><span class="fcn" id="F73N4:B575">CalculateC_Multi</span>( <span class="mxinfo" id="T17:U397"><span class="var type1" id="S89T17U576">C_Spine3New_LShoulderNew</span></span>,<span class="var type1" id="S151T17U577">C_LShoulderNew_LArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line"><span class="mxinfo" id="T17:U400"><span class="var type1" id="S153T17U580">C_Spine2New_LArmNew</span> = <span class="mxinfo" id="T17:U402"><span class="fcn" id="F73N4:B582">CalculateC_Multi</span>( <span class="var type1" id="S86T17U583">C_Spine2New_Spine3New</span>,<span class="var type1" id="S152T17U584">C_Spine3New_LArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line"><span class="mxinfo" id="T17:U405"><span class="var type1" id="S154T17U587">C_SpineNew_LArmNew</span> = <span class="mxinfo" id="T17:U407"><span class="fcn" id="F73N4:B589">CalculateC_Multi</span>( <span class="var type1" id="S87T17U590">C_SpineNew_Spine3New</span>,<span class="var type1" id="S152T17U591">C_Spine3New_LArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line"><span class="mxinfo" id="T17:U410"><span class="var type1" id="S155T17U594">C_HipNew_LArmNew</span> = <span class="mxinfo" id="T17:U412"><span class="fcn" id="F73N4:B596">CalculateC_Multi</span>( <span class="var type1" id="S88T17U597">C_HipNew_Spine3New</span>,<span class="var type1" id="S152T17U598">C_Spine3New_LArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line"><span class="mxinfo" id="T17:U415"><span class="var type1" id="S156T17U601">C_RefArm_LForeArm</span> = <span class="var type1" id="S41T17U602">C_Spine2_LForeArm</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line"><span class="mxinfo" id="T17:U418"><span class="var type1" id="S157T17U605">C_RefArmNew_LArmNew</span> = <span class="var type1" id="S153T17U606">C_Spine2New_LArmNew</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line"><span class="mxinfo" id="T8:U421">[ <span class="var type1" id="S158T8U610">LElbow_Nao</span>,<span class="var type1" id="S159T8U611">LeftForeArm_new</span> ] = <span class="fcn" id="F183N11:B613">TransformLElbow</span>( <span class="var type1" id="S156T17U614">C_RefArm_LForeArm</span>,<span class="var type1" id="S157T17U615">C_RefArmNew_LArmNew</span>,<span class="var type1" id="S7T7U616">rotateOrder_BVH</span> )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line"><span class="mxinfo" id="T2:U427">[ <span class="var type1" id="S161T2U620">LElbowYaw</span>,<span class="var type1" id="S162T2U621">LElbowRoll</span> ] = deal( <span class="mxinfo" id="T2:U430"><span class="var type1" id="S158T8U626">LElbow_Nao</span>(:,<span class="mxinfo" id="T2:U432">1</span>)</span>',<span class="mxinfo" id="T2:U433"><span class="var type1" id="S158T8U631">LElbow_Nao</span>(:,<span class="mxinfo" id="T2:U435">2</span>)</span>' )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line"><span class="comment">%% LHand</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line"><span class="mxinfo" id="T17:U436"><span class="var type1" id="S163T17U636">C_LArmNew_LForeArmNew</span> = <span class="mxinfo" id="T17:U438"><span class="fcn" id="F43N26:B638">EulerToC_c</span>( <span class="var type1" id="S159T8U639">LeftForeArm_new</span>,<span class="var type1" id="S7T7U640">rotateOrder_BVH</span> ,<span class="mxinfo" id="T8:U441">[1,1,1]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line"><span class="mxinfo" id="T17:U442"><span class="var type1" id="S164T17U648">C_Spine3New_LForeArmNew</span> = <span class="mxinfo" id="T17:U444"><span class="fcn" id="F73N4:B650">CalculateC_Multi</span>( <span class="var type1" id="S152T17U651">C_Spine3New_LArmNew</span>,<span class="var type1" id="S163T17U652">C_LArmNew_LForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line"><span class="mxinfo" id="T17:U447"><span class="var type1" id="S165T17U655">C_Spine2New_LForeArmNew</span> = <span class="mxinfo" id="T17:U449"><span class="fcn" id="F73N4:B657">CalculateC_Multi</span>( <span class="var type1" id="S86T17U658">C_Spine2New_Spine3New</span>,<span class="var type1" id="S164T17U659">C_Spine3New_LForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line"><span class="mxinfo" id="T17:U452"><span class="var type1" id="S166T17U662">C_SpineNew_LForeArmNew</span> = <span class="mxinfo" id="T17:U454"><span class="fcn" id="F73N4:B664">CalculateC_Multi</span>( <span class="var type1" id="S87T17U665">C_SpineNew_Spine3New</span>,<span class="var type1" id="S164T17U666">C_Spine3New_LForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line"><span class="mxinfo" id="T17:U457"><span class="var type1" id="S167T17U669">C_HipNew_LForeArmNew</span> = <span class="mxinfo" id="T17:U459"><span class="fcn" id="F73N4:B671">CalculateC_Multi</span>( <span class="var type1" id="S88T17U672">C_HipNew_Spine3New</span>,<span class="var type1" id="S164T17U673">C_Spine3New_LForeArmNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line"><span class="mxinfo" id="T17:U462"><span class="var type1" id="S168T17U676">C_RefArm_LHand</span> = <span class="var type1" id="S42T17U677">C_Spine2_LHand</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line"><span class="mxinfo" id="T17:U465"><span class="var type1" id="S169T17U680">C_RefArmNew_LForeArmNew</span> = <span class="var type1" id="S165T17U681">C_Spine2New_LForeArmNew</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line"><span class="mxinfo" id="T2:U468">[ <span class="var type1" id="S170T2U685">LWristYaw</span>,<span class="var type1" id="S171T8U686">LeftHand_new</span> ] = <span class="fcn" id="F184N13:B688">TransformLHand</span>( <span class="var type1" id="S168T17U689">C_RefArm_LHand</span>,<span class="var type1" id="S169T17U690">C_RefArmNew_LForeArmNew</span>,<span class="var type1" id="S7T7U691">rotateOrder_BVH</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line"><span class="comment">%% RLeg</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line"><span class="mxinfo" id="T17:U474"><span class="var type1" id="S173T17U694">C_Spine2_Hip</span> = <span class="mxinfo" id="T17:U476"><span class="fcn" id="F76N9:B696">InverseC_Multi</span>(<span class="var type1" id="S31T17U697">C_Hip_Spine2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line"><span class="mxinfo" id="T17:U478"><span class="var type1" id="S175T17U700">C_Spine2_RUpLeg</span> = <span class="mxinfo" id="T17:U480"><span class="fcn" id="F73N4:B702">CalculateC_Multi</span>( <span class="var type1" id="S173T17U703">C_Spine2_Hip</span>,<span class="var type1" id="S24T17U704">C_Hip_RUpLeg</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line"><span class="mxinfo" id="T2:U483">[ <span class="var type1" id="S176T2U708">RHipRoll</span>,<span class="var type1" id="S177T2U709">RHipPitch</span>,<span class="var type1" id="S178T8U710">RightUpLeg_new</span> ] = <span class="fcn" id="F222N22:B712">TransformRUpLeg</span>( <span class="var type1" id="S175T17U713">C_Spine2_RUpLeg</span>,<span class="mxinfo" id="T2:U488"><span class="var type1" id="S68T2U714">HipYawPitch</span></span>,<span class="var type1" id="S7T7U715">rotateOrder_BVH</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line"><span class="mxinfo" id="T17:U491"><span class="var type1" id="S180T17U718">C_Hip_RUpLegNew</span> = <span class="mxinfo" id="T17:U493"><span class="fcn" id="F43N26:B720">EulerToC_c</span>( <span class="var type1" id="S178T8U721">RightUpLeg_new</span>,<span class="var type1" id="S7T7U722">rotateOrder_BVH</span> ,<span class="mxinfo" id="T8:U496">[1,1,1]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line"><span class="mxinfo" id="T17:U497"><span class="var type1" id="S181T17U730">C_Spine2_RUpLegNew</span> = <span class="mxinfo" id="T17:U499"><span class="fcn" id="F73N4:B732">CalculateC_Multi</span>( <span class="var type1" id="S173T17U733">C_Spine2_Hip</span>,<span class="var type1" id="S180T17U734">C_Hip_RUpLegNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line"><span class="mxinfo" id="T2:U502">[ <span class="var type1" id="S182T2U738">RKneePitch</span>,<span class="var type1" id="S183T8U739">RightLeg_new</span> ] = <span class="fcn" id="F223N20:B741">TransformRLeg</span>( <span class="var type1" id="S181T17U742">C_Spine2_RUpLegNew</span>,<span class="var type1" id="S64T17U743">C_Hip_RLeg</span>,<span class="var type1" id="S7T7U744">rotateOrder_BVH</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line"><span class="mxinfo" id="T2:U508">[ <span class="var type1" id="S185T2U748">RAnklePitch</span>,<span class="var type1" id="S186T2U749">RAnkleRoll</span>,<span class="var type1" id="S187T8U750">RightFoot_new</span> ] = <span class="fcn" id="F229N18:B752">TransformRFoot</span>( <span class="var type1" id="S26T17U753">C_RLeg_RFoot</span>,<span class="var type1" id="S7T7U754">rotateOrder_BVH</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line"><span class="comment">%% LLeg</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line"><span class="mxinfo" id="T17:U514"><span class="var type1" id="S189T17U757">C_Spine2_LUpLeg</span> = <span class="mxinfo" id="T17:U516"><span class="fcn" id="F73N4:B759">CalculateC_Multi</span>( <span class="var type1" id="S173T17U760">C_Spine2_Hip</span>,<span class="var type1" id="S27T17U761">C_Hip_LUpLeg</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line"><span class="mxinfo" id="T2:U519">[ <span class="var type1" id="S190T2U765">LHipRoll</span>,<span class="var type1" id="S191T2U766">LHipPitch</span>,<span class="var type1" id="S192T8U767">LeftUpLeg_new</span> ] = <span class="fcn" id="F230N16:B769">TransformLUpLeg</span>( <span class="var type1" id="S189T17U770">C_Spine2_LUpLeg</span>,<span class="mxinfo" id="T2:U524"><span class="var type1" id="S68T2U771">HipYawPitch</span></span>,<span class="var type1" id="S7T7U772">rotateOrder_BVH</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line"><span class="mxinfo" id="T17:U527"><span class="var type1" id="S194T17U775">C_Hip_LUpLegNew</span> = <span class="mxinfo" id="T17:U529"><span class="fcn" id="F43N26:B777">EulerToC_c</span>( <span class="var type1" id="S192T8U778">LeftUpLeg_new</span>,<span class="var type1" id="S7T7U779">rotateOrder_BVH</span>,<span class="mxinfo" id="T8:U532">[1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line"><span class="mxinfo" id="T17:U533"><span class="var type1" id="S195T17U787">C_Spine2_LUpLegNew</span> = <span class="mxinfo" id="T17:U535"><span class="fcn" id="F73N4:B789">CalculateC_Multi</span>( <span class="var type1" id="S173T17U790">C_Spine2_Hip</span>,<span class="var type1" id="S194T17U791">C_Hip_LUpLegNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line"><span class="mxinfo" id="T2:U538">[ <span class="var type1" id="S196T2U795">LKneePitch</span>,<span class="var type1" id="S197T8U796">LeftLeg_new</span> ] = <span class="fcn" id="F231N14:B798">TransformLLeg</span>( <span class="var type1" id="S195T17U799">C_Spine2_LUpLegNew</span>,<span class="var type1" id="S60T17U800">C_Hip_LLeg</span>,<span class="var type1" id="S7T7U801">rotateOrder_BVH</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line"><span class="mxinfo" id="T2:U544">[ <span class="var type1" id="S199T2U805">LAnklePitch</span>,<span class="var type1" id="S200T2U806">LAnkleRoll</span>,<span class="var type1" id="S201T8U807">LeftFoot_new</span> ] = <span class="fcn" id="F232N12:B809">TransformLFoot</span>( <span class="var type1" id="S29T17U810">C_LLeg_LFoot</span>,<span class="var type1" id="S7T7U811">rotateOrder_BVH</span> )</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line"><span class="comment">%% Get Nao</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line"><span class="mxinfo" id="T2:U550"><span class="var type1" id="S5T2U814">Nframes</span> = <span class="mxinfo" id="T2:U552">size(<span class="var type1" id="S105T2U817">HeadYaw</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line"><span class="mxinfo" id="T2:U554"><span class="var type1" id="S203T2U821">LHand</span> = <span class="mxinfo" id="T2:U556">zeros( 1,<span class="var type1" id="S5T2U825">Nframes</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line"><span class="mxinfo" id="T2:U558"><span class="var type1" id="S204T2U828">RHand</span> = <span class="mxinfo" id="T2:U560">zeros( 1,<span class="var type1" id="S5T2U832">Nframes</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line"><span class="mxinfo" id="T37:U562"><span class="var type1" id="S2T37U835">NaoData</span> = <span class="mxinfo" id="T37:U564">[ <span class="var type1" id="S105T2U838">HeadYaw</span>; <span class="var type1" id="S106T2U840">HeadPitch</span>; <span class="var type1" id="S147T2U842">LShoulderPitch</span>; <span class="var type1" id="S148T2U844">LShoulderRoll</span>; <span class="var type1" id="S161T2U846">LElbowYaw</span>;  <span class="var type1" id="S162T2U848">LElbowRoll</span>; <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line"><span class="mxinfo" id="T37:U562"><span class="mxinfo" id="T37:U564">           <span class="var type1" id="S114T2U850">RShoulderPitch</span>; <span class="var type1" id="S115T2U852">RShoulderRoll</span>; <span class="var type1" id="S129T2U854">RElbowYaw</span> ; <span class="var type1" id="S130T2U856">RElbowRoll</span>; <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line"><span class="mxinfo" id="T37:U562"><span class="mxinfo" id="T37:U564">           <span class="var type1" id="S68T2U858">HipYawPitch</span>; <span class="var type1" id="S190T2U860">LHipRoll</span> ; <span class="var type1" id="S191T2U862">LHipPitch</span> ; <span class="var type1" id="S196T2U864">LKneePitch</span> ; <span class="var type1" id="S176T2U866">RHipRoll</span> ; <span class="var type1" id="S177T2U868">RHipPitch</span>; <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line"><span class="mxinfo" id="T37:U562"><span class="mxinfo" id="T37:U564">           <span class="var type1" id="S182T2U870">RKneePitch</span> ; <span class="var type1" id="S199T2U872">LAnklePitch</span> ; <span class="var type1" id="S200T2U874">LAnkleRoll</span> ; <span class="var type1" id="S185T2U876">RAnklePitch</span> ; <span class="var type1" id="S186T2U878">RAnkleRoll</span>; <span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line"><span class="mxinfo" id="T37:U562"><span class="mxinfo" id="T37:U564">           <span class="var type1" id="S170T2U880">LWristYaw</span> ; <span class="var type1" id="S139T2U882">RWristYaw</span> ; <span class="var type1" id="S203T2U884">LHand</span> ; <span class="var type1" id="S204T2U886">RHand</span>   ]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line"><span class="mxinfo" id="T37:U590"><span class="var type1" id="S2T37U889">NaoData</span> =  <span class="mxinfo" id="T37:U592"><span class="mxinfo" id="T37:U593"><span class="var type1" id="S2T37U892">NaoData</span> *<span class="mxinfo" id="T2:U595">180</span></span>/<span class="mxinfo" id="T2:U596">pi</span></span></span>  ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line"><span class="comment">%% Analyse Left Arm BVH</span></span></span>
</pre>
