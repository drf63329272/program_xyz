<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,266" id="srcline266">266</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,267" id="srcline267">267</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,268" id="srcline268">268</a></span><span class="line"><span class="comment">%% RightShoulder</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,269" id="srcline269">269</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S314T2U1437">RShoulderPitch</span>,<span class="var type1" id="S315T2U1438">RShoulderRoll</span>,<span class="var type1" id="S316T8U1439">RightArm_new</span> ] = TransformRShoulder(  <span class="var type1" id="S317T17U1442">C_Spine3_RShoulderNew</span>,<span class="var type1" id="S318T17U1443">C_Spine3_RArm</span>,<span class="mxinfo" id="T7:U6"><span class="var type2" id="S319T7V1U1444">rotateOrder_BVH</span></span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,270" id="srcline270">270</a></span><span class="line"><span class="mxinfo" id="T8:U8"><span class="var type1" id="S320T8U1447">rotateDirection_BVH</span> = <span class="mxinfo" id="T8:U10">[1,1,1]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,271" id="srcline271">271</a></span><span class="line"><span class="mxinfo" id="T17:U11"><span class="var type1" id="S321T17U1455">C_RShoulderNew_Spine3</span> = <span class="mxinfo" id="T17:U13"><span class="fcn" id="F76N9:B1457">InverseC_Multi</span>( <span class="var type1" id="S317T17U1458">C_Spine3_RShoulderNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,272" id="srcline272">272</a></span><span class="line"><span class="mxinfo" id="T17:U15"><span class="var type1" id="S323T17U1461">C_RShoulderNew_RArm</span> = <span class="mxinfo" id="T17:U17"><span class="fcn" id="F73N4:B1463">CalculateC_Multi</span>( <span class="var type1" id="S321T17U1464">C_RShoulderNew_Spine3</span>,<span class="var type1" id="S318T17U1465">C_Spine3_RArm</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,273" id="srcline273">273</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,274" id="srcline274">274</a></span><span class="line"><span class="comment">%%% 对 C_RShoulderNew_RArm 进行零位补偿</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,275" id="srcline275">275</a></span><span class="line"><span class="mxinfo" id="T2:U20"><span class="var type1" id="S325T2U1468">Nframes</span> = <span class="mxinfo" id="T2:U22">size(<span class="var type1" id="S317T17U1471">C_Spine3_RShoulderNew</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,276" id="srcline276">276</a></span><span class="line"><span class="mxinfo" id="T8:U24"><span class="var type1" id="S327T8U1475">E_naoZero_NoitomZero_YXZ</span> = <span class="mxinfo" id="T8:U26">[-pi/2,0,0]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,277" id="srcline277">277</a></span><span class="line"><span class="mxinfo" id="T8:U27"><span class="var type1" id="S327T8U1487">E_naoZero_NoitomZero_YXZ</span> = <span class="mxinfo" id="T8:U29">repmat( <span class="var type1" id="S327T8U1490">E_naoZero_NoitomZero_YXZ</span>,<span class="var type1" id="S325T2U1491">Nframes</span>,1 )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,278" id="srcline278">278</a></span><span class="line"><span class="mxinfo" id="T17:U32"><span class="var type1" id="S330T17U1495">C_naoZero_NoitomZero_YXZ</span> = <span class="mxinfo" id="T17:U34"><span class="fcn" id="F43N26:B1497">EulerToC_c</span>( <span class="var type1" id="S327T8U1498">E_naoZero_NoitomZero_YXZ</span>,<span class="string">'YXZ'</span>,[1,1,1] )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,279" id="srcline279">279</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,280" id="srcline280">280</a></span><span class="line"><span class="mxinfo" id="T17:U36"><span class="var type1" id="S332T17U1507">C_RShoulderNew_RArm_Nao</span> = <span class="mxinfo" id="T17:U38"><span class="fcn" id="F73N4:B1509">CalculateC_Multi</span>( <span class="mxinfo" id="T17:U39"><span class="var type1" id="S330T17U1510">C_naoZero_NoitomZero_YXZ</span></span>,<span class="var type1" id="S323T17U1511">C_RShoulderNew_RArm</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,281" id="srcline281">281</a></span><span class="line"><span class="mxinfo" id="T8:U42"><span class="var type1" id="S333T8U1514">E_RShoulderNew_RArm_Nao</span> = <span class="mxinfo" id="T8:U44"><span class="fcn" id="F153N23:B1516">CToEuler_c</span>( <span class="var type1" id="S332T17U1517">C_RShoulderNew_RArm_Nao</span>,<span class="string">'ZYX'</span>,<span class="mxinfo" id="T8:U46"><span class="var type1" id="S320T8U1519">rotateDirection_BVH</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,282" id="srcline282">282</a></span><span class="line"><span class="mxinfo" id="T2:U48"><span class="mxinfo" id="T2:U49"><span class="var type1" id="S333T8U1523">E_RShoulderNew_RArm_Nao</span>(:,<span class="mxinfo" id="T2:U51">3</span>)</span> = <span class="mxinfo" id="T2:U52">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,283" id="srcline283">283</a></span><span class="line"><span class="mxinfo" id="T17:U53"><span class="var type1" id="S335T17U1529">C_RShoulderNew_RArm_NaoNew</span> = <span class="mxinfo" id="T17:U55"><span class="fcn" id="F155N26:B1531">EulerToC_c</span>( <span class="var type1" id="S333T8U1532">E_RShoulderNew_RArm_Nao</span>,<span class="string">'ZYX'</span>,<span class="mxinfo" id="T8:U57">[1,1,1]</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,284" id="srcline284">284</a></span><span class="line"><span class="mxinfo" id="T2:U58"><span class="var type1" id="S314T2U1541">RShoulderPitch</span> = <span class="mxinfo" id="T2:U60"><span class="var type1" id="S333T8U1544">E_RShoulderNew_RArm_Nao</span>(:,<span class="mxinfo" id="T2:U62">1</span>)</span>'</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,285" id="srcline285">285</a></span><span class="line"><span class="mxinfo" id="T2:U63"><span class="var type1" id="S315T2U1549">RShoulderRoll</span> = <span class="mxinfo" id="T2:U65"><span class="var type1" id="S333T8U1552">E_RShoulderNew_RArm_Nao</span>(:,<span class="mxinfo" id="T2:U67">2</span>)</span>'</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,286" id="srcline286">286</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,287" id="srcline287">287</a></span><span class="line"><span class="comment">%%% get new BVH</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,288" id="srcline288">288</a></span><span class="line"><span class="comment">% 零位补偿回去</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,289" id="srcline289">289</a></span><span class="line"><span class="mxinfo" id="T8:U68"><span class="var type1" id="S336T8U1557">E_NoitomZero_naoZero_ZYX</span> = <span class="mxinfo" id="T8:U70">[0,pi/2,0]</span></span>;  <span class="comment">% 'ZYX'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,290" id="srcline290">290</a></span><span class="line"><span class="mxinfo" id="T8:U71"><span class="var type1" id="S336T8U1568">E_NoitomZero_naoZero_ZYX</span> = <span class="mxinfo" id="T8:U73">repmat( <span class="var type1" id="S336T8U1571">E_NoitomZero_naoZero_ZYX</span>,<span class="var type1" id="S325T2U1572">Nframes</span>,1 )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,291" id="srcline291">291</a></span><span class="line"><span class="mxinfo" id="T17:U76"><span class="var type1" id="S337T17U1576">C_NoitomZero_naoZero_ZYX</span> = <span class="mxinfo" id="T17:U78"><span class="fcn" id="F155N26:B1578">EulerToC_c</span>( <span class="var type1" id="S336T8U1579">E_NoitomZero_naoZero_ZYX</span>,<span class="string">'ZYX'</span> ,[1,1,1])</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,292" id="srcline292">292</a></span><span class="line"><span class="mxinfo" id="T17:U80"><span class="var type1" id="S338T17U1588">C_RShoulderNew_RArm_NoitomNew</span> = <span class="mxinfo" id="T17:U82"><span class="fcn" id="F73N4:B1590">CalculateC_Multi</span>( <span class="mxinfo" id="T17:U83"><span class="var type1" id="S337T17U1591">C_NoitomZero_naoZero_ZYX</span></span>,<span class="var type1" id="S335T17U1592">C_RShoulderNew_RArm_NaoNew</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,293" id="srcline293">293</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,294" id="srcline294">294</a></span><span class="line"><span class="mxinfo" id="T8:U86"><span class="var type1" id="S316T8U1595">RightArm_new</span> = <span class="mxinfo" id="T8:U88"><span class="fcn" id="F118N23:B1597">CToEuler_c</span>( <span class="var type1" id="S338T17U1598">C_RShoulderNew_RArm_NoitomNew</span>,<span class="var type1" id="S319T7U1599">rotateOrder_BVH</span>,<span class="mxinfo" id="T8:U91"><span class="var type1" id="S320T8U1600">rotateDirection_BVH</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,295" id="srcline295">295</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,296" id="srcline296">296</a></span><span class="line"><span class="comment">%% LeftShoulder</span></span></span>
</pre>
