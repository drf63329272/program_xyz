<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line"><span class="comment">%% 根据 BodyDirection 求姿态</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line"><span class="comment">% 符号有待验证！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line"><span class="comment">%   BodyDirection  人朝北为 [1 0 0]</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S80T24U670">Cr_r1</span> = BodyDirection2Cr_r1( <span class="var type1" id="S81T6U673">BodyDirection</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211">211</a></span><span class="line">coder.inline(<span class="string">'never'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,212" id="srcline212">212</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,213" id="srcline213">213</a></span><span class="line"><span class="mxinfo" id="T13:U3"><span class="var type1" id="S83T13U682">V</span> = <span class="mxinfo" id="T13:U5">[1 0 0]</span></span>;   <span class="comment">% 正北</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,214" id="srcline214">214</a></span><span class="line"><span class="mxinfo" id="T2:U6"><span class="var type1" id="S84T2U690">thita</span> = <span class="mxinfo" id="T2:U8">acos( <span class="mxinfo" id="T2:U9"><span class="mxinfo" id="T2:U10"><span class="mxinfo" id="T13:U11"><span class="var type1" id="S83T13U695">V</span></span>*<span class="var type1" id="S81T6U696">BodyDirection</span></span> / <span class="mxinfo" id="T2:U14">normest(<span class="var type1" id="S81T6U699">BodyDirection</span>)</span></span>   )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,215" id="srcline215">215</a></span><span class="line"><span class="comment">% 通过叉乘可判断角度方向</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,216" id="srcline216">216</a></span><span class="line"><span class="mxinfo" id="T13:U16"><span class="var type1" id="S87T13U702">temp</span> = <span class="mxinfo" id="T13:U18">cross(<span class="mxinfo" id="T13:U19"><span class="var type1" id="S83T13U705">V</span></span>,<span class="var type1" id="S81T6U706">BodyDirection</span>)</span></span> ;  <span class="comment">% 从 V 到 BodyDirection 逆时针180°以内时，temp朝上，temp(3)&lt;0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217">217</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T14:U22"><span class="mxinfo" id="T2:U23"><span class="var type1" id="S87T13U711">temp</span>(<span class="mxinfo" id="T2:U25">3</span>)</span>&gt;<span class="mxinfo" id="T2:U26">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218">218</a></span><span class="line">        <span class="comment">% 从 V 到 BodyDirection 逆时针转动超过180°</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219">219</a></span><span class="line">      <span class="mxinfo" id="T2:U27"><span class="var type1" id="S84T2U716">thita</span> = <span class="mxinfo" id="T2:U29">-<span class="var type1" id="S84T2U718">thita</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220">220</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221">221</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222">222</a></span><span class="line"><span class="mxinfo" id="T24:U31"><span class="var type1" id="S80T24U721">Cr_r1</span> = <span class="mxinfo" id="T24:U33"><span class="fcn" id="F52N34:B723">RotateZ</span>( <span class="var type1" id="S84T2U724">thita</span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225">225</a></span><span class="line"><span class="comment">%% InertialData  和 otherMakers 置 NaN</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,226" id="srcline226">226</a></span><span class="line"><span class="comment">%% 用于给 C++ 自动生成 初始化 函数</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,227" id="srcline227">227</a></span><span class="line"></span></span>
</pre>
