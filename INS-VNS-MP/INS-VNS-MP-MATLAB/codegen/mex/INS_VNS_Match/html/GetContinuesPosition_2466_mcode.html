<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="111,59" id="srcline59"> 59</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="111,60" id="srcline60"> 60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="111,61" id="srcline61"> 61</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="111,62" id="srcline62"> 62</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="111,63" id="srcline63"> 63</a></span><span class="line"><span class="comment">%% 寻找 otherMakers 中第 k_vision 个时刻， 第 i_marker 个马克点 对应的连续线段（在前时刻基础上查找）</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,64" id="srcline64"> 64</a></span><span class="line"><span class="comment">% ConPosition_i [3*ConN_i] ConN_i 是该连续线段的长度</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,65" id="srcline65"> 65</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S33T84U276">ConPosition_i_new</span>,<span class="var type1" id="S34T2U277">dataN_i_P_new</span>] = GetContinuesPosition_2<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,66" id="srcline66"> 66</a></span><span class="line">    ( <span class="var type1" id="S35T69U280">otherMakers</span>,<span class="var type1" id="S36T2U281">k_vision</span>,<span class="var type1" id="S37T2U282">i_marker</span>,<span class="var type1" id="S38T84U283">ConPosition_i</span>,<span class="var type1" id="S39T2U284">dataN_i_PValid</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="111,67" id="srcline67"> 67</a></span><span class="line"><span class="mxinfo" id="T2:U8"><span class="var type1" id="S40T2U287">ContinuesFlag</span> = <span class="mxinfo" id="T2:U10"><span class="mxinfo" id="T64:U11"><span class="mxinfo" id="T62:U12"><span class="var type1" id="S35T69U291">otherMakers</span>(<span class="var type1" id="S36T2U292">k_vision</span>)</span>.ContinuesFlag</span>(<span class="var type1" id="S37T2U294">i_marker</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="111,68" id="srcline68"> 68</a></span><span class="line"><span class="mxinfo" id="T64:U16"><span class="var type1" id="S41T64U297">ContinuesLasti_All</span> = <span class="mxinfo" id="T64:U18"><span class="mxinfo" id="T62:U19"><span class="var type1" id="S35T69U300">otherMakers</span>(<span class="var type1" id="S36T2U301">k_vision</span>)</span>.ContinuesLasti</span></span> ;  <span class="comment">% 当前时刻 所有马克点 对应的 上时刻马克点序号</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,69" id="srcline69"> 69</a></span><span class="line"><span class="mxinfo" id="T2:U22"><span class="var type1" id="S42T2U305">ContinuesLasti_cur</span> = <span class="mxinfo" id="T2:U24"><span class="var type1" id="S41T64U307">ContinuesLasti_All</span>(<span class="var type1" id="S37T2U308">i_marker</span>)</span></span> ;  <span class="comment">% 当前时刻 当期马克点 对应的 上时刻马克点序号</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,70" id="srcline70"> 70</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T3:U27">isnan(<span class="var type1" id="S40T2U315">ContinuesFlag</span>)</span> || <span class="mxinfo" id="T3:U29"><span class="var type1" id="S40T2U317">ContinuesFlag</span>==<span class="mxinfo" id="T2:U31">0</span></span> || <span class="mxinfo" id="T3:U32">isnan(<span class="var type1" id="S42T2U321">ContinuesLasti_cur</span>)</span> <span class="comment">% 无2个以上连续马克点</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,71" id="srcline71"> 71</a></span><span class="line">    <span class="mxinfo" id="T84:U34"><span class="var type1" id="S33T84U324">ConPosition_i_new</span> = <span class="var type1" id="S38T84U325">ConPosition_i</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="111,72" id="srcline72"> 72</a></span><span class="line">    <span class="mxinfo" id="T2:U37"><span class="var type1" id="S34T2U328">dataN_i_P_new</span> = <span class="var type1" id="S39T2U329">dataN_i_PValid</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="111,73" id="srcline73"> 73</a></span><span class="line">    <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="111,74" id="srcline74"> 74</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,75" id="srcline75"> 75</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="111,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">% 先将 otherMakersContinues 按照新的马克点序号排序</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,77" id="srcline77"> 77</a></span><span class="line"><span class="comment">% otherMakersContinues = ReOrderContinues( ContinuesLasti_All,otherMakersContinues ) ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,78" id="srcline78"> 78</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="111,79" id="srcline79"> 79</a></span><span class="line"><span class="mxinfo" id="T2:U40"><span class="var type1" id="S44T2U333">ContinuesLastK</span> = <span class="mxinfo" id="T2:U42"><span class="mxinfo" id="T64:U43"><span class="mxinfo" id="T62:U44"><span class="var type1" id="S35T69U337">otherMakers</span>(<span class="var type1" id="S36T2U338">k_vision</span>)</span>.ContinuesLastK</span>(<span class="var type1" id="S37T2U340">i_marker</span>)</span></span> ;  <span class="comment">% 连续线段最早点的时刻</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,80" id="srcline80"> 80</a></span><span class="line"><span class="mxinfo" id="T2:U48"><span class="var type1" id="S45T2U343">ConN_i</span> = <span class="mxinfo" id="T2:U50"><span class="mxinfo" id="T2:U51"><span class="var type1" id="S36T2U346">k_vision</span>-<span class="var type1" id="S44T2U347">ContinuesLastK</span></span>+<span class="mxinfo" id="T2:U54">1</span></span></span> ; <span class="comment">% 连续线段长度</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,81" id="srcline81"> 81</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="111,82" id="srcline82"> 82</a></span><span class="line"><span class="mxinfo" id="T45:U55"><span class="var type1" id="S46T45U351">NewPosition_i</span> = <span class="mxinfo" id="T45:U57"><span class="mxinfo" id="T63:U58"><span class="mxinfo" id="T62:U59"><span class="var type1" id="S35T69U355">otherMakers</span>(<span class="var type1" id="S36T2U356">k_vision</span>)</span>.Position</span>(:, <span class="var type1" id="S37T2U359">i_marker</span> )</span></span>;  <span class="comment">% 最新的点</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,83" id="srcline83"> 83</a></span><span class="line"><span class="comment">% [~,ConPosition_i] = Read_otherMakersContinues_i( otherMakersContinues,i_marker ); % 更新前的连续线段</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,84" id="srcline84"> 84</a></span><span class="line"><span class="comment">% dataN_i_P = otherMakersContinues.dataN( 1,i_marker );  % 第 i_marker 马克点 位置有效长度</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,85" id="srcline85"> 85</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T3:U63"><span class="var type1" id="S45T2U363">ConN_i</span> == <span class="mxinfo" id="T2:U65">2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="111,86" id="srcline86"> 86</a></span><span class="line">   <span class="comment">%% 新的线段开始 2个点</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,87" id="srcline87"> 87</a></span><span class="line">   <span class="mxinfo" id="T45:U66"><span class="var type1" id="S47T45U367">NewPosition_i_2</span> = <span class="mxinfo" id="T45:U68"><span class="mxinfo" id="T63:U69"><span class="mxinfo" id="T62:U70"><span class="var type1" id="S35T69U371">otherMakers</span>(<span class="mxinfo" id="T2:U72"><span class="var type1" id="S36T2U373">k_vision</span>-<span class="mxinfo" id="T2:U74">1</span></span>)</span>.Position</span>(:, <span class="var type1" id="S42T2U377">ContinuesLasti_cur</span> )</span></span>;   <span class="comment">% 前一个（第一个点）</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,88" id="srcline88"> 88</a></span><span class="line">   <span class="mxinfo" id="T59:U76"><span class="var type1" id="S46T59U380">NewPosition_i</span> = <span class="mxinfo" id="T59:U78">[ <span class="var type1" id="S47T45U383">NewPosition_i_2</span> <span class="var type1" id="S46T45U384">NewPosition_i</span> ]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="111,89" id="srcline89"> 89</a></span><span class="line">   <span class="mxinfo" id="T120:U81"><span class="mxinfo" id="T120:U82"><span class="var type1" id="S33T84U388">ConPosition_i_new</span>( :,<span class="mxinfo" id="T53:U84"><span class="mxinfo" id="T2:U85">1</span>:<span class="mxinfo" id="T2:U86">2</span></span> )</span> = <span class="var type1" id="S46T59U393">NewPosition_i</span></span>;   <span class="comment">% 更新后的连续线段</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,90" id="srcline90"> 90</a></span><span class="line">   <span class="mxinfo" id="T2:U88"><span class="var type1" id="S34T2U396">dataN_i_P_new</span> = <span class="mxinfo" id="T2:U90">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="111,91" id="srcline91"> 91</a></span><span class="line">   <span class="keyword">if</span> <span class="mxinfo" id="T3:U91"><span class="var type1" id="S39T2U401">dataN_i_PValid</span> ~=<span class="mxinfo" id="T2:U93">0</span></span>  <span class="comment">% 正确的情况下，应该不存在，返回空</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,92" id="srcline92"> 92</a></span><span class="line">      <span class="autoExtrinsicFcn" id="F467N26:B405">disp</span>(<span class="string">'wrong-1 in GetContinuesPosition_2'</span>) </span></span>
<span class="srcline"><span class="lineno"><a href="111,93" id="srcline93"> 93</a></span><span class="line">   <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,94" id="srcline94"> 94</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,95" id="srcline95"> 95</a></span><span class="line">    <span class="comment">%% 延续前时刻的线段 增加一个点</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,96" id="srcline96"> 96</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="111,97" id="srcline97"> 97</a></span><span class="line">    <span class="message error" id="M24F466C">[ <span class="var type0" id="S33T0U411"><span class="message error" id="M25F466C">ConPosition_i_new</span></span>,<span class="var type0" id="S34T0U412"><span class="message error" id="M26F466C">dataN_i_P_new</span></span> ] = <span class="fcn" id="F468N2:B414">AddListData</span>( <span class="var type1" id="S38T84U415">ConPosition_i</span>,<span class="var type1" id="S39T2U416">dataN_i_PValid</span>,<span class="var type1" id="S46T45U417">NewPosition_i</span> )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="111,98" id="srcline98"> 98</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,99" id="srcline99"> 99</a></span><span class="line"><span class="comment">% 检查长度</span></span></span>
<span class="srcline"><span class="lineno"><a href="111,100" id="srcline100">100</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T3:U97"><span class="var type1" id="S34T2U421">dataN_i_P_new</span> ~= <span class="var type1" id="S45T2U422">ConN_i</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="111,101" id="srcline101">101</a></span><span class="line">    <span class="autoExtrinsicFcn" id="F473N26:B425">disp</span>(<span class="string">'wrong-2 in GetContinuesPosition_2'</span>) </span></span>
<span class="srcline"><span class="lineno"><a href="111,102" id="srcline102">102</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="111,103" id="srcline103">103</a></span><span class="line"></span></span>
</pre>
