<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="137,1" id="srcline1"> 1</a></span><span class="line"><span class="comment">%% xyz  2015.4.9</span></span></span>
<span class="srcline"><span class="lineno"><a href="137,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="137,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% quaternion to Euler angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="137,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="137,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% Input</span></span></span>
<span class="srcline"><span class="lineno"><a href="137,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% Q: [ NFrames*4 ]</span></span></span>
<span class="srcline"><span class="lineno"><a href="137,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">% rotateOrder:  XYZ  XZY  <span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="137,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% rotateDirection: anticlockwise(1) or clockwise(-1)  [1,1,1]</span></span></span>
<span class="srcline"><span class="lineno"><a href="137,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% CosBeitaSign: 1 / -1 . </span></span></span>
<span class="srcline"><span class="lineno"><a href="137,10" id="srcline10">10</a></span><span class="line"><span class="comment">%       CosBeitaSign = 1 : cos(beita)&gt;0, beita [ -pi/2,pi/2 ]</span></span></span>
<span class="srcline"><span class="lineno"><a href="137,11" id="srcline11">11</a></span><span class="line"><span class="comment">%       CosBeitaSign = -1 : cos(beita)&lt;0, beita [ -pi,-pi/2 ] or [ pi/2,pi ]</span></span></span>
<span class="srcline"><span class="lineno"><a href="137,12" id="srcline12">12</a></span><span class="line"><span class="comment">%%%  NOTE: There are two kinds of Euler Angles applied to the C. </span></span></span>
<span class="srcline"><span class="lineno"><a href="137,13" id="srcline13">13</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="137,14" id="srcline14">14</a></span><span class="line"><span class="comment">% Output</span></span></span>
<span class="srcline"><span class="lineno"><a href="137,15" id="srcline15">15</a></span><span class="line"><span class="comment">% euler:  [3*N];   euler(:,k) = [eu_1,eu_2,eu_3];   rad   </span></span></span>
<span class="srcline"><span class="lineno"><a href="137,16" id="srcline16">16</a></span><span class="line"><span class="comment">%       store order of euler angle: the rotate order</span></span></span>
<span class="srcline"><span class="lineno"><a href="137,17" id="srcline17">17</a></span><span class="line"><span class="comment">%       eu_1,eu_3: [-pi,pi]</span></span></span>
<span class="srcline"><span class="lineno"><a href="137,18" id="srcline18">18</a></span><span class="line"><span class="comment">%       eu_2:   CosBeitaSign=1: [-pi/2,pi/2]      </span></span></span>
<span class="srcline"><span class="lineno"><a href="137,19" id="srcline19">19</a></span><span class="line"><span class="comment">%               CosBeitaSign=-1:[ -pi,-pi/2 ] or [ pi/2,pi ]</span></span></span>
<span class="srcline"><span class="lineno"><a href="137,20" id="srcline20">20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="137,21" id="srcline21">21</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T6U3">euler</span> = Q2Euler(<span class="var type1" id="S3T63U6">Q</span>,<span class="mxinfo" id="T32:U3"><span class="var type2" id="S4T32V2U7">rotateOrder</span></span>,<span class="var type1" id="S5T13U8">rotateDirection</span>,<span class="var type1" id="S6T2U9">CosBeitaSign</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="137,22" id="srcline22">22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="137,23" id="srcline23">23</a></span><span class="line">coder.inline(<span class="string">'never'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="137,24" id="srcline24">24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="137,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo" id="T24:U7"><span class="var type1" id="S8T24U18">C</span> = <span class="mxinfo" id="T24:U9"><span class="fcn" id="F503N31:B20">Q2C</span>(<span class="var type1" id="S3T63U21">Q</span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="137,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo" id="T6:U11"><span class="var type1" id="S2T6U24">euler</span> = <span class="mxinfo" id="T6:U13"><span class="fcn" id="F519N3:B26">C2Euler</span>( <span class="var type1" id="S8T24U27">C</span>,<span class="var type1" id="S4T32U28">rotateOrder</span>,<span class="var type1" id="S5T13U29">rotateDirection</span>,<span class="mxinfo" id="T2:U17"><span class="var type1" id="S6T2U30">CosBeitaSign</span></span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="137,27" id="srcline27">27</a></span><span class="line"><span class="mxinfo" id="T6:U19"><span class="var type1" id="S2T6U33">euler</span> = <span class="mxinfo" id="T6:U21"><span class="fcn" id="F518N27:B35">MakeEuler_In2Pi</span>( <span class="var type1" id="S2T6U36">euler</span> )</span></span> ;</span></span>
</pre>
