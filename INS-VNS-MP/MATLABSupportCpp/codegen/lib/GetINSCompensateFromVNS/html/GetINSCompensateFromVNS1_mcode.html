<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% otherMakers(k).ContinuesFlag = zeros(1,M) ; % 不连续</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">% otherMakers(k).ContinuesLastPosition = NaN(3,M)  ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">% otherMakers(k).ContinuesLastTime = NaN[1*M] ; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">% otherMakers(k).ContinuesLastK = NaN[1*M];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%% InertialData</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">% InertialData.frequency (k)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">% InertialData.time (k)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">% InertialData.HipQuaternion(k)  [4*N]</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">% InertialData.HipPosition (k)  [3*N]</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">% InertialData.HeadQuaternion (k)  [4*N]</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">% InertialData.HeadPosition (k)  [3*N]</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">% InertialData.BodyDirection(k)  [3*1]</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">% InertialData.DataStyle(k)  'GlobalBoneQuat'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%% 用 Optitrack 的 OtherMarker 补偿惯性系统</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%% 得到惯性 Hip 位置补偿量 InertialPositionCompensate</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">% InertialPositionCompensate [ 3*N ]  m  NED系</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T1U3">InertialData1</span>,<span class="var type1" id="S3T7U4">otherMakers1</span>,<span class="var type1" id="S4T6U5">compensateRate1</span>,<span class="var type1" id="S5T12U6">InertialData2</span>,<span class="var type1" id="S6T14U7">otherMakers2</span> ] = GetINSCompensateFromVNS( <span class="var type1" id="S7T1U10">InertialData</span>,<span class="var type1" id="S8T7U11">otherMakers</span>,<span class="var type1" id="S9T6U12">compensateRate</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line">coder.extrinsic(<span class="string">'fprintf'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line">coder.inline(<span class="string">'never'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line">coder.extrinsic(<span class="string">'DrawTracedINSVNS'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line">coder.varsize(<span class="string">'otherMakers2'</span>,<span class="string">'v_Position'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">%% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="mxinfo" id="T6:U9"><span class="var type1" id="S11T6U40">I_N</span> = <span class="mxinfo" id="T6:U11">size( <span class="var type1" id="S7T1U44">InertialData</span>.time,2 )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo" id="T6:U13"><span class="var type1" id="S13T6U49">V_N</span> = <span class="mxinfo" id="T6:U15">length(<span class="var type1" id="S8T7U52">otherMakers</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="mxinfo" id="T6:U17"><span class="var type1" id="S15T6U55">MaxOtherMarkerBufN</span> = <span class="mxinfo" id="T6:U19">size(<span class="var type1" id="S8T7U60">otherMakers</span>(1).ContinuesFlag,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">%% InertialData  和 otherMakers 置 NaN</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="mxinfo" id="T1:U21">[<span class="var type1" id="S7T1U67">InertialData</span>,<span class="var type1" id="S8T7U68">otherMakers</span>] = <span class="fcn" id="F3N3:B70">Set_InertialData_otherMakers_NaN</span>( <span class="var type1" id="S7T1U71">InertialData</span>,<span class="var type1" id="S8T7U72">otherMakers</span> )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="comment">%% InertialData 格式数据创建</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="mxinfo" id="T3:U26"><span class="mxinfo" id="T3:U27"><span class="var type1" id="S5T12U76">InertialData2</span>.HeadQuaternion</span> = <span class="mxinfo" id="T3:U29"><span class="var type1" id="S7T1U79">InertialData</span>.HeadQuaternion</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="comment">%% InertialData 格式数据Copy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="mxinfo" id="T1:U31"><span class="var type1" id="S2T1U83">InertialData1</span> = <span class="var type1" id="S7T1U84">InertialData</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"><span class="comment">%% otherMakers 格式数据创建</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="mxinfo" id="T14:U34"><span class="var type1" id="S6T14U87">otherMakers2</span> =<span class="mxinfo" id="T15:U36"><span class="var type1" id="S8T7U89">otherMakers</span>(<span class="mxinfo" id="T6:U38">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="mxinfo" id="T15:U39"><span class="mxinfo" id="T15:U40"><span class="var type1" id="S6T14U94">otherMakers2</span>(<span class="mxinfo" id="T6:U42">15</span>)</span> =<span class="mxinfo" id="T15:U43"><span class="var type1" id="S8T7U97">otherMakers</span>(<span class="mxinfo" id="T6:U45">5</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="comment">%% otherMakers 格式数据Copy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"><span class="mxinfo" id="T7:U46"><span class="var type1" id="S3T7U101">otherMakers1</span> =<span class="var type1" id="S8T7U102">otherMakers</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="comment">%% compensateRate</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"><span class="mxinfo" id="T6:U49"><span class="var type1" id="S4T6U105">compensateRate1</span> = <span class="var type1" id="S9T6U106">compensateRate</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"><span class="comment">%% InertialData 数据赋值</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="mxinfo" id="T6:U52"><span class="mxinfo" id="T6:U53"><span class="var type1" id="S2T1U110">InertialData1</span>.frequency</span> = <span class="mxinfo" id="T6:U55">96</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"><span class="mxinfo" id="T5:U56"><span class="mxinfo" id="T5:U57"><span class="mxinfo" id="T4:U58"><span class="var type1" id="S7T1U117">InertialData</span>.HipPosition</span>(:,<span class="mxinfo" id="T6:U60">1</span>)</span> = <span class="mxinfo" id="T5:U61">zeros(<span class="mxinfo" id="T6:U62">3</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"><span class="mxinfo" id="T16:U63"><span class="mxinfo" id="T16:U64"><span class="mxinfo" id="T3:U65"><span class="var type1" id="S7T1U129">InertialData</span>.HipQuaternion</span>(:,<span class="mxinfo" id="T6:U67">1</span>)</span> = <span class="mxinfo" id="T16:U68">NaN(<span class="mxinfo" id="T6:U69">4</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">%% otherMakers 数据赋值</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"><span class="mxinfo" id="T6:U70"><span class="mxinfo" id="T6:U71"><span class="mxinfo" id="T15:U72"><span class="var type1" id="S3T7U141">otherMakers1</span>(<span class="mxinfo" id="T6:U74">1</span>)</span>.frequency</span> = <span class="mxinfo" id="T6:U75">30</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"><span class="mxinfo" id="T5:U76"><span class="var type1" id="S19T5U147">P1</span> = <span class="mxinfo" id="T5:U78">[<span class="mxinfo" id="T6:U79">1</span>;<span class="mxinfo" id="T6:U80">2</span>;<span class="mxinfo" id="T6:U81">3</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"><span class="mxinfo" id="T5:U82"><span class="var type1" id="S20T5U157">P2</span> = <span class="mxinfo" id="T5:U84">[<span class="mxinfo" id="T6:U85">0.1</span>;<span class="mxinfo" id="T6:U86">0.2</span>;<span class="mxinfo" id="T6:U87">0.3</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"><span class="mxinfo" id="T17:U88"><span class="mxinfo" id="T17:U89"><span class="mxinfo" id="T8:U90"><span class="mxinfo" id="T15:U91"><span class="var type1" id="S3T7U170">otherMakers1</span>(<span class="mxinfo" id="T6:U93">1</span>)</span>.Position</span>(:,<span class="mxinfo" id="T18:U94"><span class="mxinfo" id="T6:U95">1</span>:<span class="mxinfo" id="T6:U96">2</span></span>)</span> = <span class="mxinfo" id="T17:U97">[<span class="var type1" id="S19T5U179">P1</span> <span class="var type1" id="S20T5U180">P2</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line"><span class="mxinfo" id="T10:U100"><span class="mxinfo" id="T10:U101"><span class="mxinfo" id="T15:U102"><span class="var type1" id="S3T7U185">otherMakers1</span>(<span class="mxinfo" id="T6:U104">1</span>)</span>.MarkerSet</span> = <span class="mxinfo" id="T10:U105">int8(<span class="mxinfo" id="T6:U106">16</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line"><span class="comment">% %% 给 otherMakers 赋值函数 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"><span class="comment">% frequency = otherMakers(2).frequency;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"><span class="comment">% time = otherMakers(2).time;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line"><span class="comment">% v_Position = zeros(3,20);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line"><span class="comment">% v_Position(:,32) = [1;3;-2];</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"><span class="comment">% otherMakersN = otherMakers(6).otherMakersN;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line"><span class="comment">% for visual_k=1:100</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line"><span class="comment">%     otherMakers1 = Assign_otherMakers_1( otherMakers1,visual_k,frequency,time,v_Position,otherMakersN );</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"><span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line"><span class="comment">%% InertialData  和 otherMakers 置 NaN</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line"><span class="comment">%% 用于给 C++ 自动生成 初始化 函数</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line"></span></span>
</pre>
