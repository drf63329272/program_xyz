<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="49,648" id="srcline648">648</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,649" id="srcline649">649</a></span><span class="line"><span class="comment">%% 马克点连续性判断</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,650" id="srcline650">650</a></span><span class="line"><span class="comment">% dPi_ConJudge ： 连续性判断指标的大小：前后两帧的位移模</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,651" id="srcline651">651</a></span><span class="line"><span class="comment">% ContinuesFlag = 0   不连续</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,652" id="srcline652">652</a></span><span class="line"><span class="comment">%               =1    连续，且是与跟踪成功马克点连续</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,653" id="srcline653">653</a></span><span class="line"><span class="comment">%               =2   连续，和跟踪失败的点连续</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,654" id="srcline654">654</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S241T41U2704">otherMakers_k</span>,<span class="var type1" id="S242T2U2705">dPi_ConJudge</span> ] = ContinuesJudge( <span class="mxinfo" id="T41:U3"><span class="mxinfo" id="T41:U4"><span class="var type1" id="S241T41U2708">otherMakers_k</span></span></span>,<span class="var type1" id="S243T68U2709">otherMakers_k_last</span>,<span class="var type1" id="S244T44U2710">trackedMakerPosition</span>,<span class="var type1" id="S245T4U2711">k_vision</span>,<span class="var type1" id="S246T34U2712">makerTrackThreshold</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,655" id="srcline655">655</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,656" id="srcline656">656</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,657" id="srcline657">657</a></span><span class="line"><span class="comment">% 前一时刻跟踪成功时，给出当前点是否相对跟踪成功的点连续。  Continues = 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,658" id="srcline658">658</a></span><span class="line"><span class="comment">% 前一时刻跟踪失败时，给出当前每个点是否为连续点的结果,且记录着个点能连续到往前最早（但不超过dT）的点的位置和时间。</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,659" id="srcline659">659</a></span><span class="line"><span class="comment">%        Continues = 2 ，</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,660" id="srcline660">660</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,661" id="srcline661">661</a></span><span class="line"><span class="comment">% global inertialFre visionFre  moveDistance</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,662" id="srcline662">662</a></span><span class="line"><span class="comment">% 记录每个马克点的连续特性</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,663" id="srcline663">663</a></span><span class="line"><span class="mxinfo" id="T2:U10"><span class="var type1" id="S247T2U2715">MaxOtherMarkerBufN</span> = <span class="mxinfo" id="T2:U12">size(<span class="var type1" id="S241T41U2719">otherMakers_k</span>.ContinuesFlag,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,664" id="srcline664">664</a></span><span class="line"><span class="mxinfo" id="T4:U14"><span class="var type1" id="S249T4U2724">M</span> = <span class="mxinfo" id="T4:U16"><span class="var type1" id="S241T41U2726">otherMakers_k</span>.otherMakersN</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,665" id="srcline665">665</a></span><span class="line"><span class="mxinfo" id="T7:U18"><span class="mxinfo" id="T7:U19"><span class="var type1" id="S241T41U2731">otherMakers_k</span>.ContinuesFlag</span> = <span class="mxinfo" id="T7:U21">zeros(<span class="mxinfo" id="T2:U22">1</span>,<span class="mxinfo" id="T2:U23"><span class="var type1" id="S247T2U2736">MaxOtherMarkerBufN</span></span>)</span></span> ; <span class="comment">% 不连续</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,666" id="srcline666">666</a></span><span class="line"><span class="mxinfo" id="T3:U25"><span class="mxinfo" id="T3:U26"><span class="var type1" id="S241T41U2740">otherMakers_k</span>.ContinuesLastPosition</span> = <span class="mxinfo" id="T3:U28">NaN(<span class="mxinfo" id="T2:U29">3</span>,<span class="mxinfo" id="T2:U30"><span class="var type1" id="S247T2U2745">MaxOtherMarkerBufN</span></span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,667" id="srcline667">667</a></span><span class="line"><span class="mxinfo" id="T7:U32"><span class="mxinfo" id="T7:U33"><span class="var type1" id="S241T41U2749">otherMakers_k</span>.ContinuesLastTime</span> = <span class="mxinfo" id="T7:U35">NaN(<span class="mxinfo" id="T2:U36">1</span>,<span class="mxinfo" id="T2:U37"><span class="var type1" id="S247T2U2754">MaxOtherMarkerBufN</span></span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,668" id="srcline668">668</a></span><span class="line"><span class="mxinfo" id="T3:U39"><span class="var type1" id="S252T3U2757">otherMakersPosition_k</span> = <span class="mxinfo" id="T3:U41"><span class="var type1" id="S241T41U2759">otherMakers_k</span>.Position</span></span> ;  </span></span>
<span class="srcline"><span class="lineno"><a href="49,669" id="srcline669">669</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,670" id="srcline670">670</a></span><span class="line"><span class="mxinfo" id="T2:U43"><span class="var type1" id="S242T2U2763">dPi_ConJudge</span>=<span class="mxinfo" id="T2:U45">nan</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,671" id="srcline671">671</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,672" id="srcline672">672</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T19:U46"><span class="var type1" id="S245T4U2769">k_vision</span>&gt;<span class="mxinfo" id="T2:U48">1</span></span> </span></span>
<span class="srcline"><span class="lineno"><a href="49,673" id="srcline673">673</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="49,674" id="srcline674">674</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T19:U49">~<span class="mxinfo" id="T19:U50">isnan(<span class="mxinfo" id="T2:U51"><span class="var type1" id="S244T44U2777">trackedMakerPosition</span>(<span class="mxinfo" id="T2:U53">1</span>,<span class="mxinfo" id="T4:U54"><span class="var type1" id="S245T4U2780">k_vision</span>-<span class="mxinfo" id="T4:U56">1</span></span>)</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,675" id="srcline675">675</a></span><span class="line">        <span class="comment">%% 只判断当前马克点是否与前时刻跟踪成功的马克点连续</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,676" id="srcline676">676</a></span><span class="line">        <span class="mxinfo" id="T6:U57"><span class="var type1" id="S255T6U2784">trackedMakerPosition_kLast</span> = <span class="mxinfo" id="T6:U59"><span class="var type1" id="S244T44U2786">trackedMakerPosition</span>(:,<span class="mxinfo" id="T4:U61"><span class="var type1" id="S245T4U2789">k_vision</span>-<span class="mxinfo" id="T4:U63">1</span></span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,677" id="srcline677">677</a></span><span class="line">        <span class="mxinfo" id="T69:U64"><span class="var type1" id="S256T69U2793">otherMakersPosition_k_Dis</span> = <span class="mxinfo" id="T69:U66"><span class="mxinfo" id="T69:U67"><span class="var type1" id="S252T3U2796">otherMakersPosition_k</span>(:,<span class="mxinfo" id="T19:U69"><span class="mxinfo" id="T4:U70">1</span>:<span class="var type1" id="S249T4U2800">M</span></span>)</span>-<span class="mxinfo" id="T43:U72">repmat(<span class="var type1" id="S255T6U2803">trackedMakerPosition_kLast</span>,1,<span class="var type1" id="S249T4U2805">M</span>)</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,678" id="srcline678">678</a></span><span class="line">        <span class="mxinfo" id="T45:U75"><span class="var type1" id="S258T45U2808">otherMakersPosition_k_Dis_Norm</span> = <span class="mxinfo" id="T45:U77">zeros(<span class="mxinfo" id="T2:U78">1</span>,<span class="var type1" id="S249T4U2812">M</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,679" id="srcline679">679</a></span><span class="line">        <span class="mxinfo" id="T4:U80"><span class="keyword">for</span> <span class="var type1" id="S259T4U2815">j</span>=<span class="mxinfo" id="T4:U82">1</span>:<span class="var type1" id="S249T4U2818">M</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,680" id="srcline680">680</a></span><span class="line"><span class="mxinfo" id="T4:U80">            <span class="mxinfo" id="T2:U84"><span class="mxinfo" id="T2:U85"><span class="var type1" id="S258T45U2822">otherMakersPosition_k_Dis_Norm</span>(<span class="var type1" id="S259T4U2823">j</span>)</span> = <span class="mxinfo" id="T2:U88">normest(<span class="mxinfo" id="T6:U89"><span class="var type1" id="S256T69U2827">otherMakersPosition_k_Dis</span>(:,<span class="var type1" id="S259T4U2829">j</span>)</span>)</span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,681" id="srcline681">681</a></span><span class="line"><span class="mxinfo" id="T4:U80">        <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,682" id="srcline682">682</a></span><span class="line">        <span class="mxinfo" id="T2:U92">[<span class="var type1" id="S242T2U2833">dPi_ConJudge</span>,<span class="var type1" id="S261T2U2834">minCon_k</span>] = min(<span class="var type1" id="S258T45U2837">otherMakersPosition_k_Dis_Norm</span>)</span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="49,683" id="srcline683">683</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T19:U96"><span class="var type1" id="S242T2U2841">dPi_ConJudge</span> &lt; <span class="mxinfo" id="T2:U98"><span class="var type1" id="S246T34U2843">makerTrackThreshold</span>.MaxContinuesDisplacement</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,684" id="srcline684">684</a></span><span class="line">    <span class="comment">%         trackedMakerPosition_k_OK = otherMakersPosition_k(:,m) ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,685" id="srcline685">685</a></span><span class="line">    <span class="comment">%         TrackFlag = 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,686" id="srcline686">686</a></span><span class="line">    <span class="comment">%         fprintf('马克点连续：位移=%0.4f，跟踪OK \n',Min_otherMakersPosition_k_Dis_Norm);</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,687" id="srcline687">687</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="49,688" id="srcline688">688</a></span><span class="line">            <span class="mxinfo" id="T2:U100"><span class="mxinfo" id="T2:U101"><span class="mxinfo" id="T7:U102"><span class="var type1" id="S241T41U2849">otherMakers_k</span>.ContinuesFlag</span>(<span class="var type1" id="S261T2U2851">minCon_k</span>)</span> = <span class="mxinfo" id="T2:U105">1</span></span> ; <span class="comment">% 连续，且是与跟踪成功马克点连续</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,689" id="srcline689">689</a></span><span class="line">            <span class="mxinfo" id="T6:U106"><span class="mxinfo" id="T6:U107"><span class="mxinfo" id="T3:U108"><span class="var type1" id="S241T41U2857">otherMakers_k</span>.ContinuesLastPosition</span>(:,<span class="var type1" id="S261T2U2860">minCon_k</span>)</span> = <span class="var type1" id="S255T6U2861">trackedMakerPosition_kLast</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,690" id="srcline690">690</a></span><span class="line">            <span class="mxinfo" id="T2:U112"><span class="mxinfo" id="T2:U113"><span class="mxinfo" id="T7:U114"><span class="var type1" id="S241T41U2866">otherMakers_k</span>.ContinuesLastTime</span>(<span class="var type1" id="S261T2U2868">minCon_k</span>)</span> = <span class="mxinfo" id="T2:U117"><span class="var type1" id="S243T68U2870">otherMakers_k_last</span>.time</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,691" id="srcline691">691</a></span><span class="line">            <span class="mxinfo" id="T2:U119"><span class="mxinfo" id="T2:U120"><span class="mxinfo" id="T7:U121"><span class="var type1" id="S241T41U2876">otherMakers_k</span>.ContinuesLastK</span>(<span class="var type1" id="S261T2U2878">minCon_k</span>)</span> = <span class="mxinfo" id="T4:U124"><span class="var type1" id="S245T4U2880">k_vision</span>-<span class="mxinfo" id="T4:U126">1</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,692" id="srcline692">692</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,693" id="srcline693">693</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="49,694" id="srcline694">694</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,695" id="srcline695">695</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="49,696" id="srcline696">696</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,697" id="srcline697">697</a></span><span class="line">        <span class="comment">%% 判断当前马克点是否为连续马克点，记录每个点对应的最早（但不超过dT）连续点</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,698" id="srcline698">698</a></span><span class="line">        <span class="mxinfo" id="T4:U127"><span class="var type1" id="S263T4U2886">M_last</span> = <span class="mxinfo" id="T4:U129"><span class="var type1" id="S243T68U2888">otherMakers_k_last</span>.otherMakersN</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,699" id="srcline699">699</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T19:U131"><span class="var type1" id="S263T4U2893">M_last</span>==<span class="mxinfo" id="T2:U133">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,700" id="srcline700">700</a></span><span class="line">            <span class="comment">% 上时刻无马克点</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,701" id="srcline701">701</a></span><span class="line">            <span class="mxinfo" id="T4:U134"><span class="keyword">for</span> <span class="var type1" id="S264T4U2897">i</span>=<span class="mxinfo" id="T4:U136">1</span>:<span class="var type1" id="S249T4U2900">M</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,702" id="srcline702">702</a></span><span class="line"><span class="mxinfo" id="T4:U134">                <span class="mxinfo" id="T2:U138"><span class="mxinfo" id="T2:U139"><span class="mxinfo" id="T7:U140"><span class="var type1" id="S241T41U2905">otherMakers_k</span>.ContinuesFlag</span>(<span class="var type1" id="S264T4U2907">i</span>)</span> = <span class="mxinfo" id="T2:U143">0</span></span> ; </span><span class="comment"><span class="mxinfo" id="T4:U134">% 不连续</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,703" id="srcline703">703</a></span><span class="line"><span class="mxinfo" id="T4:U134">                <span class="mxinfo" id="T6:U144"><span class="mxinfo" id="T6:U145"><span class="mxinfo" id="T3:U146"><span class="var type1" id="S241T41U2913">otherMakers_k</span>.ContinuesLastPosition</span>(:,<span class="var type1" id="S264T4U2916">i</span>)</span> = <span class="mxinfo" id="T2:U149">NaN</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,704" id="srcline704">704</a></span><span class="line"><span class="mxinfo" id="T4:U134">                <span class="mxinfo" id="T2:U150"><span class="mxinfo" id="T2:U151"><span class="mxinfo" id="T7:U152"><span class="var type1" id="S241T41U2923">otherMakers_k</span>.ContinuesLastTime</span>(<span class="var type1" id="S264T4U2925">i</span>)</span> = <span class="mxinfo" id="T2:U155">NaN</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,705" id="srcline705">705</a></span><span class="line"><span class="mxinfo" id="T4:U134">                <span class="mxinfo" id="T2:U156"><span class="mxinfo" id="T2:U157"><span class="mxinfo" id="T7:U158"><span class="var type1" id="S241T41U2932">otherMakers_k</span>.ContinuesLastK</span>(<span class="var type1" id="S264T4U2934">i</span>)</span> = <span class="mxinfo" id="T2:U161">NaN</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,706" id="srcline706">706</a></span><span class="line"><span class="mxinfo" id="T4:U134">            <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,707" id="srcline707">707</a></span><span class="line">            <span class="mxinfo" id="T2:U162"><span class="var type1" id="S242T2U2939">dPi_ConJudge</span>=<span class="mxinfo" id="T2:U164">nan</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,708" id="srcline708">708</a></span><span class="line">            <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,709" id="srcline709">709</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,710" id="srcline710">710</a></span><span class="line">        <span class="comment">% 一共有 M*M_last 种组合</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,711" id="srcline711">711</a></span><span class="line">        <span class="mxinfo" id="T4:U165"><span class="keyword">for</span> <span class="var type1" id="S264T4U2945">i</span>=<span class="mxinfo" id="T4:U167">1</span>:<span class="var type1" id="S249T4U2948">M</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,712" id="srcline712">712</a></span><span class="line"><span class="mxinfo" id="T4:U165">            <span class="mxinfo" id="T69:U169"><span class="var type1" id="S265T69U2951">dPi</span> = <span class="mxinfo" id="T69:U171"><span class="mxinfo" id="T43:U172">repmat(<span class="mxinfo" id="T6:U173"><span class="mxinfo" id="T3:U174"><span class="var type1" id="S241T41U2957">otherMakers_k</span>.Position</span>( :,<span class="var type1" id="S264T4U2960">i</span> )</span>,1,<span class="var type1" id="S263T4U2962">M_last</span>)</span>- <span class="mxinfo" id="T69:U178"><span class="mxinfo" id="T69:U179"><span class="var type1" id="S243T68U2965">otherMakers_k_last</span>.Position</span>(:,<span class="mxinfo" id="T19:U181"><span class="mxinfo" id="T4:U182">1</span>:<span class="var type1" id="S263T4U2970">M_last</span></span>)</span></span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,713" id="srcline713">713</a></span><span class="line"><span class="mxinfo" id="T4:U165">            <span class="mxinfo" id="T45:U184"><span class="var type1" id="S266T45U2973">dPiNorm</span> = <span class="mxinfo" id="T45:U186">zeros(<span class="mxinfo" id="T2:U187">1</span>,<span class="var type1" id="S263T4U2977">M_last</span>)</span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,714" id="srcline714">714</a></span><span class="line"><span class="mxinfo" id="T4:U165">            <span class="mxinfo" id="T4:U189"><span class="keyword">for</span> <span class="var type1" id="S259T4U2980">j</span>=<span class="mxinfo" id="T4:U191">1</span>:<span class="var type1" id="S263T4U2983">M_last</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,715" id="srcline715">715</a></span><span class="line"><span class="mxinfo" id="T4:U165"><span class="mxinfo" id="T4:U189">                <span class="mxinfo" id="T2:U193"><span class="mxinfo" id="T2:U194"><span class="var type1" id="S266T45U2987">dPiNorm</span>(<span class="var type1" id="S259T4U2988">j</span>)</span> = <span class="mxinfo" id="T2:U197">normest(<span class="mxinfo" id="T6:U198"><span class="var type1" id="S265T69U2992">dPi</span>(:,<span class="var type1" id="S259T4U2994">j</span>)</span>)</span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,716" id="srcline716">716</a></span><span class="line"><span class="mxinfo" id="T4:U165"><span class="mxinfo" id="T4:U189">            <span class="keyword">end</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,717" id="srcline717">717</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="49,718" id="srcline718">718</a></span><span class="line"><span class="mxinfo" id="T4:U165">            <span class="mxinfo" id="T2:U201">[<span class="var type1" id="S242T2U2998">dPi_ConJudge</span>,<span class="var type1" id="S267T2U2999">min_i</span>] = min(<span class="var type1" id="S266T45U3002">dPiNorm</span>)</span>;</span>   </span></span>
<span class="srcline"><span class="lineno"><a href="49,719" id="srcline719">719</a></span><span class="line"><span class="mxinfo" id="T4:U165">            <span class="keyword">if</span> <span class="mxinfo" id="T19:U205"><span class="mxinfo" id="T2:U206">normest(<span class="var type1" id="S242T2U3008">dPi_ConJudge</span>)</span> &lt; <span class="mxinfo" id="T2:U208"><span class="var type1" id="S246T34U3010">makerTrackThreshold</span>.MaxContinuesDisplacement</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,720" id="srcline720">720</a></span><span class="line"><span class="mxinfo" id="T4:U165">                </span><span class="comment"><span class="mxinfo" id="T4:U165">%  otherMakers_k.Position( :,i ) 与 otherMakers_k_last.Position(:,min_i) 连续</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,721" id="srcline721">721</a></span><span class="line"><span class="mxinfo" id="T4:U165">                </span><span class="comment"><span class="mxinfo" id="T4:U165">% 找到一个连续的点，记录上一点</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,722" id="srcline722">722</a></span><span class="line"><span class="mxinfo" id="T4:U165">                <span class="mxinfo" id="T2:U210"><span class="mxinfo" id="T2:U211"><span class="mxinfo" id="T7:U212"><span class="var type1" id="S241T41U3016">otherMakers_k</span>.ContinuesFlag</span>(<span class="var type1" id="S264T4U3018">i</span>)</span> = <span class="mxinfo" id="T2:U215">2</span></span> ; </span><span class="comment"><span class="mxinfo" id="T4:U165">% 连续，和跟踪失败的点连续</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,723" id="srcline723">723</a></span><span class="line"><span class="mxinfo" id="T4:U165">                </span><span class="comment"><span class="mxinfo" id="T4:U165">% 如果前一个点为连续点，则将前一个点的连续记录传递过来</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,724" id="srcline724">724</a></span><span class="line"><span class="mxinfo" id="T4:U165">                <span class="keyword">if</span> <span class="mxinfo" id="T19:U216"><span class="mxinfo" id="T2:U217"><span class="mxinfo" id="T7:U218"><span class="var type1" id="S243T68U3025">otherMakers_k_last</span>.ContinuesFlag</span>(<span class="var type1" id="S267T2U3027">min_i</span>)</span> == <span class="mxinfo" id="T2:U221">2</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,725" id="srcline725">725</a></span><span class="line"><span class="mxinfo" id="T4:U165">                    <span class="mxinfo" id="T2:U222"><span class="mxinfo" id="T2:U223"><span class="mxinfo" id="T7:U224"><span class="var type1" id="S241T41U3033">otherMakers_k</span>.ContinuesLastK</span>(<span class="var type1" id="S264T4U3035">i</span>)</span> = <span class="mxinfo" id="T2:U227"><span class="mxinfo" id="T7:U228"><span class="var type1" id="S243T68U3038">otherMakers_k_last</span>.ContinuesLastK</span>(<span class="var type1" id="S267T2U3040">min_i</span>)</span></span> ; </span><span class="comment"><span class="mxinfo" id="T4:U165">% 传递记录上一个时刻存储的连续信息</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,726" id="srcline726">726</a></span><span class="line"><span class="mxinfo" id="T4:U165">                    <span class="mxinfo" id="T6:U231"><span class="mxinfo" id="T6:U232"><span class="mxinfo" id="T3:U233"><span class="var type1" id="S241T41U3045">otherMakers_k</span>.ContinuesLastPosition</span>(:,<span class="var type1" id="S264T4U3048">i</span>)</span> = <span class="mxinfo" id="T6:U236"><span class="mxinfo" id="T3:U237"><span class="var type1" id="S243T68U3051">otherMakers_k_last</span>.ContinuesLastPosition</span>(:,<span class="var type1" id="S267T2U3054">min_i</span>)</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,727" id="srcline727">727</a></span><span class="line"><span class="mxinfo" id="T4:U165">                    <span class="mxinfo" id="T2:U240"><span class="mxinfo" id="T2:U241"><span class="mxinfo" id="T7:U242"><span class="var type1" id="S241T41U3059">otherMakers_k</span>.ContinuesLastTime</span>(<span class="var type1" id="S264T4U3061">i</span>)</span> = <span class="mxinfo" id="T2:U245"><span class="mxinfo" id="T7:U246"><span class="var type1" id="S243T68U3064">otherMakers_k_last</span>.ContinuesLastTime</span>(<span class="var type1" id="S267T2U3066">min_i</span>)</span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,728" id="srcline728">728</a></span><span class="line"><span class="mxinfo" id="T4:U165">                <span class="keyword">elseif</span> <span class="mxinfo" id="T19:U249"><span class="mxinfo" id="T2:U250"><span class="mxinfo" id="T7:U251"><span class="var type1" id="S243T68U3071">otherMakers_k_last</span>.ContinuesFlag</span>(<span class="var type1" id="S267T2U3073">min_i</span>)</span> == <span class="mxinfo" id="T2:U254">0</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,729" id="srcline729">729</a></span><span class="line"><span class="mxinfo" id="T4:U165">                    <span class="mxinfo" id="T2:U255"><span class="mxinfo" id="T2:U256"><span class="mxinfo" id="T7:U257"><span class="var type1" id="S241T41U3079">otherMakers_k</span>.ContinuesLastK</span>(<span class="var type1" id="S264T4U3081">i</span>)</span> = <span class="mxinfo" id="T4:U260"><span class="var type1" id="S245T4U3083">k_vision</span>-<span class="mxinfo" id="T4:U262">1</span></span></span> ; </span><span class="comment"><span class="mxinfo" id="T4:U165">% 直接记录上一个时刻</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,730" id="srcline730">730</a></span><span class="line"><span class="mxinfo" id="T4:U165">                    <span class="mxinfo" id="T6:U263"><span class="mxinfo" id="T6:U264"><span class="mxinfo" id="T3:U265"><span class="var type1" id="S241T41U3089">otherMakers_k</span>.ContinuesLastPosition</span>(:,<span class="var type1" id="S264T4U3092">i</span>)</span> = <span class="mxinfo" id="T6:U268"><span class="mxinfo" id="T69:U269"><span class="var type1" id="S243T68U3095">otherMakers_k_last</span>.Position</span>( :,<span class="var type1" id="S267T2U3098">min_i</span> )</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,731" id="srcline731">731</a></span><span class="line"><span class="mxinfo" id="T4:U165">                    <span class="mxinfo" id="T2:U272"><span class="mxinfo" id="T2:U273"><span class="mxinfo" id="T7:U274"><span class="var type1" id="S241T41U3103">otherMakers_k</span>.ContinuesLastTime</span>(<span class="var type1" id="S264T4U3105">i</span>)</span> = <span class="mxinfo" id="T2:U277"><span class="var type1" id="S243T68U3107">otherMakers_k_last</span>.time</span></span> ;</span>                    </span></span>
<span class="srcline"><span class="lineno"><a href="49,732" id="srcline732">732</a></span><span class="line"><span class="mxinfo" id="T4:U165">                <span class="keyword">elseif</span> <span class="mxinfo" id="T19:U279"><span class="mxinfo" id="T2:U280"><span class="mxinfo" id="T7:U281"><span class="var type1" id="S243T68U3113">otherMakers_k_last</span>.ContinuesFlag</span>(<span class="var type1" id="S267T2U3115">min_i</span>)</span> == <span class="mxinfo" id="T2:U284">1</span></span></span> </span></span>
<span class="srcline"><span class="lineno"><a href="49,733" id="srcline733">733</a></span><span class="line"><span class="mxinfo" id="T4:U165">                    </span><span class="comment"><span class="mxinfo" id="T4:U165">% 与跟踪成功点连续检测成功，但跟踪识别失败的情况，传递到现在。如果传递时间超过2秒，则不再传递。</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,734" id="srcline734">734</a></span><span class="line"><span class="mxinfo" id="T4:U165">                    <span class="keyword">if</span> <span class="mxinfo" id="T19:U285">(<span class="mxinfo" id="T2:U286"><span class="mxinfo" id="T2:U287"><span class="mxinfo" id="T7:U288"><span class="var type1" id="S243T68U3124">otherMakers_k_last</span>.ContinuesLastTime</span>(<span class="var type1" id="S267T2U3126">min_i</span>)</span>-<span class="mxinfo" id="T2:U291"><span class="var type1" id="S241T41U3128">otherMakers_k</span>.time</span></span>) &gt; <span class="mxinfo" id="T2:U293">20</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,735" id="srcline735">735</a></span><span class="line"><span class="mxinfo" id="T4:U165">                        <span class="mxinfo" id="T2:U294"><span class="mxinfo" id="T2:U295"><span class="mxinfo" id="T7:U296"><span class="var type1" id="S241T41U3135">otherMakers_k</span>.ContinuesFlag</span>(<span class="var type1" id="S264T4U3137">i</span>)</span> = <span class="mxinfo" id="T2:U299">2</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,736" id="srcline736">736</a></span><span class="line"><span class="mxinfo" id="T4:U165">                    <span class="keyword">else</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,737" id="srcline737">737</a></span><span class="line"><span class="mxinfo" id="T4:U165">                        <span class="mxinfo" id="T2:U300"><span class="mxinfo" id="T2:U301"><span class="mxinfo" id="T7:U302"><span class="var type1" id="S241T41U3144">otherMakers_k</span>.ContinuesFlag</span>(<span class="var type1" id="S264T4U3146">i</span>)</span> = <span class="mxinfo" id="T2:U305">1</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,738" id="srcline738">738</a></span><span class="line"><span class="mxinfo" id="T4:U165">                    <span class="keyword">end</span></span>                    </span></span>
<span class="srcline"><span class="lineno"><a href="49,739" id="srcline739">739</a></span><span class="line"><span class="mxinfo" id="T4:U165">                    <span class="mxinfo" id="T2:U306"><span class="mxinfo" id="T2:U307"><span class="mxinfo" id="T7:U308"><span class="var type1" id="S241T41U3152">otherMakers_k</span>.ContinuesLastK</span>(<span class="var type1" id="S264T4U3154">i</span>)</span> = <span class="mxinfo" id="T2:U311"><span class="mxinfo" id="T7:U312"><span class="var type1" id="S243T68U3157">otherMakers_k_last</span>.ContinuesLastK</span>(<span class="var type1" id="S267T2U3159">min_i</span>)</span></span> ; </span><span class="comment"><span class="mxinfo" id="T4:U165">% 传递记录上一个时刻存储的连续信息</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,740" id="srcline740">740</a></span><span class="line"><span class="mxinfo" id="T4:U165">                    <span class="mxinfo" id="T6:U315"><span class="mxinfo" id="T6:U316"><span class="mxinfo" id="T3:U317"><span class="var type1" id="S241T41U3164">otherMakers_k</span>.ContinuesLastPosition</span>(:,<span class="var type1" id="S264T4U3167">i</span>)</span> = <span class="mxinfo" id="T6:U320"><span class="mxinfo" id="T3:U321"><span class="var type1" id="S243T68U3170">otherMakers_k_last</span>.ContinuesLastPosition</span>(:,<span class="var type1" id="S267T2U3173">min_i</span>)</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,741" id="srcline741">741</a></span><span class="line"><span class="mxinfo" id="T4:U165">                    <span class="mxinfo" id="T2:U324"><span class="mxinfo" id="T2:U325"><span class="mxinfo" id="T7:U326"><span class="var type1" id="S241T41U3178">otherMakers_k</span>.ContinuesLastTime</span>(<span class="var type1" id="S264T4U3180">i</span>)</span> = <span class="mxinfo" id="T2:U329"><span class="mxinfo" id="T7:U330"><span class="var type1" id="S243T68U3183">otherMakers_k_last</span>.ContinuesLastTime</span>(<span class="var type1" id="S267T2U3185">min_i</span>)</span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,742" id="srcline742">742</a></span><span class="line"><span class="mxinfo" id="T4:U165">                <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,743" id="srcline743">743</a></span><span class="line"><span class="mxinfo" id="T4:U165">            <span class="keyword">else</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,744" id="srcline744">744</a></span><span class="line"><span class="mxinfo" id="T4:U165">                <span class="mxinfo" id="T2:U333"><span class="mxinfo" id="T2:U334"><span class="mxinfo" id="T7:U335"><span class="var type1" id="S241T41U3191">otherMakers_k</span>.ContinuesFlag</span>(<span class="var type1" id="S264T4U3193">i</span>)</span> = <span class="mxinfo" id="T2:U338">0</span></span> ; </span><span class="comment"><span class="mxinfo" id="T4:U165">% 不连续</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,745" id="srcline745">745</a></span><span class="line"><span class="mxinfo" id="T4:U165">                <span class="mxinfo" id="T6:U339"><span class="mxinfo" id="T6:U340"><span class="mxinfo" id="T3:U341"><span class="var type1" id="S241T41U3199">otherMakers_k</span>.ContinuesLastPosition</span>(:,<span class="var type1" id="S264T4U3202">i</span>)</span> = <span class="mxinfo" id="T2:U344">NaN</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,746" id="srcline746">746</a></span><span class="line"><span class="mxinfo" id="T4:U165">                <span class="mxinfo" id="T2:U345"><span class="mxinfo" id="T2:U346"><span class="mxinfo" id="T7:U347"><span class="var type1" id="S241T41U3209">otherMakers_k</span>.ContinuesLastTime</span>(<span class="var type1" id="S264T4U3211">i</span>)</span> = <span class="mxinfo" id="T2:U350">NaN</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,747" id="srcline747">747</a></span><span class="line"><span class="mxinfo" id="T4:U165">                <span class="mxinfo" id="T2:U351"><span class="mxinfo" id="T2:U352"><span class="mxinfo" id="T7:U353"><span class="var type1" id="S241T41U3218">otherMakers_k</span>.ContinuesLastK</span>(<span class="var type1" id="S264T4U3220">i</span>)</span> = <span class="mxinfo" id="T2:U356">NaN</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,748" id="srcline748">748</a></span><span class="line"><span class="mxinfo" id="T4:U165">            <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,749" id="srcline749">749</a></span><span class="line">                        </span></span>
<span class="srcline"><span class="lineno"><a href="49,750" id="srcline750">750</a></span><span class="line"><span class="mxinfo" id="T4:U165">        <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,751" id="srcline751">751</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="49,752" id="srcline752">752</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,753" id="srcline753">753</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,754" id="srcline754">754</a></span><span class="line">    <span class="mxinfo" id="T2:U357"><span class="var type1" id="S242T2U3226">dPi_ConJudge</span>=<span class="mxinfo" id="T2:U359">nan</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,755" id="srcline755">755</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,756" id="srcline756">756</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,757" id="srcline757">757</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,758" id="srcline758">758</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,759" id="srcline759">759</a></span><span class="line"><span class="comment">%% 查找惯性k时刻前运动了大于 dS 距离的最近的点</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,760" id="srcline760">760</a></span><span class="line"><span class="comment">% 且该点trackedMakerPosition跟踪成功</span></span></span>
</pre>
