<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="49,6" id="srcline6">  6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%% 跟踪测量见说明文档</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,8" id="srcline8">  8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%% 判断思路：比较2个相对位移矢量：1）dT(3 sec)运动时间时  2）dS（1m）运动位移长度时</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">% 1)dT(3 sec)时间内，惯性和视觉位移向量的大小差&lt;0.1m，方向差&lt;60°（当位移矢量长度小于0.2m时不比较方向）</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,11" id="srcline11"> 11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,12" id="srcline12"> 12</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T13U3">trackedMakerPosition_InertialTime_Out</span>,<span class="var type1" id="S3T1U4">otherMakers</span> ] = <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,13" id="srcline13"> 13</a></span><span class="line">    GetRightOtherMaker( <span class="mxinfo" id="T1:U3"><span class="mxinfo" id="T1:U4"><span class="var type1" id="S3T1U7">otherMakers</span></span></span>,<span class="var type1" id="S4T13U8">InertialPosition</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,14" id="srcline14"> 14</a></span><span class="line">coder.extrinsic(<span class="string">'fprintf'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="49,15" id="srcline15"> 15</a></span><span class="line">coder.extrinsic(<span class="string">'DrawTracedINSVNS'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="49,16" id="srcline16"> 16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,17" id="srcline17"> 17</a></span><span class="line"><span class="keyword">global</span>    <span class="var type0" id="S6T0U22">visionFre</span> <span class="var type0" id="S7T0U23">inertialFre</span> </span></span>
<span class="srcline"><span class="lineno"><a href="49,18" id="srcline18"> 18</a></span><span class="line"><span class="keyword">global</span>      <span class="var type1" id="S8T2U25">IsGetFirstMarker</span> </span></span>
<span class="srcline"><span class="lineno"><a href="49,19" id="srcline19"> 19</a></span><span class="line"><span class="keyword">global</span>      <span class="var type0" id="S9T0U27">CalStartVN</span> <span class="var type0" id="S10T0U28">CalEndVN</span>  <span class="var type0" id="S11T0U29">CalStartIN</span>  <span class="var type0" id="S12T0U30">CalEndIN</span>  </span></span>
<span class="srcline"><span class="lineno"><a href="49,20" id="srcline20"> 20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%% 阈值参数设置</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,22" id="srcline22"> 22</a></span><span class="line"><span class="keyword">persistent</span> <span class="var type1" id="S13T34U32">makerTrackThreshold</span> <span class="var type1" id="S14T36U33">INSVNSCalibSet</span> </span></span>
<span class="srcline"><span class="lineno"><a href="49,23" id="srcline23"> 23</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T19:U10"><span class="mxinfo" id="T19:U11">isempty(<span class="var type0" id="S13T0U38">makerTrackThreshold</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,24" id="srcline24"> 24</a></span><span class="line">    <span class="mxinfo" id="T34:U12">[ <span class="var type1" id="S13T34U42">makerTrackThreshold</span>,<span class="var type1" id="S14T36U43">INSVNSCalibSet</span> ] = <span class="fcn" id="F110N21:B45">SetParameters</span>( )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,25" id="srcline25"> 25</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,26" id="srcline26"> 26</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,27" id="srcline27"> 27</a></span><span class="line"><span class="mxinfo" id="T2:U15"><span class="var type1" id="S8T2U48">IsGetFirstMarker</span> = <span class="mxinfo" id="T2:U17">0</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,28" id="srcline28"> 28</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,29" id="srcline29"> 29</a></span><span class="line"><span class="mxinfo" id="T2:U18"><span class="var type1" id="S17T2U52">dT_Ninertial</span> = <span class="mxinfo" id="T2:U20">fix(<span class="mxinfo" id="T2:U21"><span class="mxinfo" id="T2:U22"><span class="var type1" id="S13T34U57">makerTrackThreshold</span>.moveTime</span>*<span class="var type1" id="S7T2U59">inertialFre</span></span>)</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,30" id="srcline30"> 30</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">%% 在线/离线 第一次要求预定义变量大小</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,32" id="srcline32"> 32</a></span><span class="line"><span class="keyword">persistent</span>   <span class="var type1" id="S19T13U61">trackedMakerPosition_InertialTime</span>  <span class="var type1" id="S20T44U62">trackedMakerPosition</span> <span class="var type1" id="S21T15U63">TrackFlag</span> <span class="var type1" id="S22T54U64">trackedMarkerVelocity</span>  <span class="var type1" id="S23T66U65">InertialVelocity</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,33" id="srcline33"> 33</a></span><span class="line"><span class="keyword">persistent</span> <span class="var type1" id="S24T53U67">INSVNSCalib_VS_k</span>  <span class="var type1" id="S25T2U68">Calib_N_New</span>  <span class="var type1" id="S26T2U69">IsCalibDataEnough</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,34" id="srcline34"> 34</a></span><span class="line"><span class="mxinfo" id="T2:U33"><span class="var type1" id="S27T2U72">MarkerTN</span> = <span class="mxinfo" id="T2:U35">length(<span class="var type1" id="S3T1U75">otherMakers</span>)</span></span>;   <span class="comment">%  视觉时间长度</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,35" id="srcline35"> 35</a></span><span class="line"><span class="mxinfo" id="T2:U37"><span class="var type1" id="S29T2U78">InertialN</span> = <span class="mxinfo" id="T2:U39">size(<span class="var type1" id="S4T13U81">InertialPosition</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,36" id="srcline36"> 36</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,37" id="srcline37"> 37</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T19:U41"><span class="mxinfo" id="T19:U42">isempty(<span class="var type0" id="S23T0U87">InertialVelocity</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,38" id="srcline38"> 38</a></span><span class="line">    <span class="mxinfo" id="T15:U43"><span class="var type1" id="S21T15U90">TrackFlag</span> = <span class="mxinfo" id="T15:U45">zeros(<span class="mxinfo" id="T2:U46">1</span>,<span class="mxinfo" id="T2:U47"><span class="var type1" id="S27T2U94">MarkerTN</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,39" id="srcline39"> 39</a></span><span class="line">    <span class="mxinfo" id="T44:U49"><span class="var type1" id="S20T44U97">trackedMakerPosition</span> = <span class="mxinfo" id="T44:U51">NaN(<span class="mxinfo" id="T2:U52">3</span>,<span class="mxinfo" id="T2:U53"><span class="var type1" id="S27T2U101">MarkerTN</span></span>)</span></span>; <span class="comment">% 判断成功的马克点位置</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,40" id="srcline40"> 40</a></span><span class="line">    <span class="mxinfo" id="T13:U55"><span class="var type1" id="S19T13U104">trackedMakerPosition_InertialTime</span> = <span class="mxinfo" id="T13:U57">NaN( <span class="mxinfo" id="T2:U58">3</span>,<span class="mxinfo" id="T2:U59"><span class="var type1" id="S29T2U108">InertialN</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,41" id="srcline41"> 41</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="49,42" id="srcline42"> 42</a></span><span class="line">    <span class="mxinfo" id="T66:U61"><span class="var type1" id="S23T66U111">InertialVelocity</span> = <span class="mxinfo" id="T66:U63">NaN(<span class="mxinfo" id="T2:U64">5</span>,<span class="mxinfo" id="T2:U65"><span class="var type1" id="S29T2U115">InertialN</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,43" id="srcline43"> 43</a></span><span class="line">    <span class="mxinfo" id="T54:U67"><span class="var type1" id="S22T54U118">trackedMarkerVelocity</span> = <span class="mxinfo" id="T54:U69">NaN(<span class="mxinfo" id="T2:U70">5</span>,<span class="mxinfo" id="T2:U71"><span class="var type1" id="S27T2U122">MarkerTN</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="49,44" id="srcline44"> 44</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="49,45" id="srcline45"> 45</a></span><span class="line">    <span class="mxinfo" id="T53:U73"><span class="var type1" id="S24T53U125">INSVNSCalib_VS_k</span> = <span class="mxinfo" id="T53:U75">NaN(<span class="mxinfo" id="T2:U76">2</span>,<span class="mxinfo" id="T2:U77">50</span>)</span></span>; <span class="comment">% INSVNSCalib_VS_k（:,i）存储一段位移</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,46" id="srcline46"> 46</a></span><span class="line">    <span class="mxinfo" id="T2:U78"><span class="var type1" id="S25T2U132">Calib_N_New</span> = <span class="mxinfo" id="T2:U80">0</span></span>;   <span class="comment">% 搜索乘的位移段个数</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,47" id="srcline47"> 47</a></span><span class="line">    <span class="mxinfo" id="T2:U81"><span class="var type1" id="S26T2U136">IsCalibDataEnough</span> = <span class="mxinfo" id="T2:U83">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,48" id="srcline48"> 48</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,49" id="srcline49"> 49</a></span><span class="line"><span class="comment">%% 这些判断指标只在离线时记录</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,50" id="srcline50"> 50</a></span><span class="line"><span class="keyword">persistent</span> <span class="var type1" id="S33T15U139">dPi_ConJudge</span> <span class="var type1" id="S34T15U140">dPError_dT_xy</span>  <span class="var type1" id="S35T15U141">dPError_dT_z</span>  <span class="var type1" id="S36T15U142">dPError_dS_xyNorm</span> <span class="var type1" id="S37T15U143">dP_Inertial_xyNorm</span>  <span class="var type1" id="S38T15U144">angleErr_dS</span>  <span class="var type1" id="S39T15U145">angleErr_dT_Min</span> <span class="var type1" id="S40T15U146">ConTrackedFailed</span> <span class="var type1" id="S41T15U147">INSVNSMarkHC_Min</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,51" id="srcline51"> 51</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T19:U93"><span class="mxinfo" id="T19:U94">isempty(<span class="var type0" id="S33T0U152">dPi_ConJudge</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,52" id="srcline52"> 52</a></span><span class="line">    <span class="mxinfo" id="T15:U95"><span class="var type1" id="S33T15U155">dPi_ConJudge</span> = <span class="mxinfo" id="T15:U97">NaN(<span class="mxinfo" id="T2:U98">1</span>,<span class="mxinfo" id="T2:U99"><span class="var type1" id="S27T2U159">MarkerTN</span></span>)</span></span>;   </span></span>
<span class="srcline"><span class="lineno"><a href="49,53" id="srcline53"> 53</a></span><span class="line">    <span class="mxinfo" id="T15:U101"><span class="var type1" id="S34T15U162">dPError_dT_xy</span> = <span class="mxinfo" id="T15:U103">NaN(<span class="mxinfo" id="T2:U104">1</span>,<span class="mxinfo" id="T2:U105"><span class="var type1" id="S27T2U166">MarkerTN</span></span>)</span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="49,54" id="srcline54"> 54</a></span><span class="line">    <span class="mxinfo" id="T15:U107"><span class="var type1" id="S35T15U169">dPError_dT_z</span> = <span class="mxinfo" id="T15:U109">NaN(<span class="mxinfo" id="T2:U110">1</span>,<span class="mxinfo" id="T2:U111"><span class="var type1" id="S27T2U173">MarkerTN</span></span>)</span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="49,55" id="srcline55"> 55</a></span><span class="line">    <span class="mxinfo" id="T15:U113"><span class="var type1" id="S36T15U176">dPError_dS_xyNorm</span> = <span class="mxinfo" id="T15:U115">NaN(<span class="mxinfo" id="T2:U116">1</span>,<span class="mxinfo" id="T2:U117"><span class="var type1" id="S27T2U180">MarkerTN</span></span>)</span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="49,56" id="srcline56"> 56</a></span><span class="line">    <span class="mxinfo" id="T15:U119"><span class="var type1" id="S37T15U183">dP_Inertial_xyNorm</span> = <span class="mxinfo" id="T15:U121">NaN(<span class="mxinfo" id="T2:U122">1</span>,<span class="mxinfo" id="T2:U123"><span class="var type1" id="S27T2U187">MarkerTN</span></span>)</span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="49,57" id="srcline57"> 57</a></span><span class="line">    <span class="mxinfo" id="T15:U125"><span class="var type1" id="S38T15U190">angleErr_dS</span> = <span class="mxinfo" id="T15:U127">NaN(<span class="mxinfo" id="T2:U128">1</span>,<span class="mxinfo" id="T2:U129"><span class="var type1" id="S27T2U194">MarkerTN</span></span>)</span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="49,58" id="srcline58"> 58</a></span><span class="line">    <span class="mxinfo" id="T15:U131"><span class="var type1" id="S39T15U197">angleErr_dT_Min</span> = <span class="mxinfo" id="T15:U133">NaN(<span class="mxinfo" id="T2:U134">1</span>,<span class="mxinfo" id="T2:U135"><span class="var type1" id="S27T2U201">MarkerTN</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="49,59" id="srcline59"> 59</a></span><span class="line">    <span class="mxinfo" id="T15:U137"><span class="var type1" id="S40T15U204">ConTrackedFailed</span> = <span class="mxinfo" id="T15:U139">zeros(<span class="mxinfo" id="T2:U140">1</span>,<span class="mxinfo" id="T2:U141"><span class="var type1" id="S27T2U208">MarkerTN</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,60" id="srcline60"> 60</a></span><span class="line">    <span class="mxinfo" id="T15:U143"><span class="var type1" id="S41T15U211">INSVNSMarkHC_Min</span> = <span class="mxinfo" id="T15:U145">NaN(<span class="mxinfo" id="T2:U146">1</span>,<span class="mxinfo" id="T2:U147"><span class="var type1" id="S27T2U215">MarkerTN</span></span>)</span></span>;               </span></span>
<span class="srcline"><span class="lineno"><a href="49,61" id="srcline61"> 61</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,62" id="srcline62"> 62</a></span><span class="line"><span class="keyword">persistent</span> <span class="var type1" id="S42T28U217">Crw</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,63" id="srcline63"> 63</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T19:U150"><span class="mxinfo" id="T19:U151">isempty(<span class="var type0" id="S42T0U222">Crw</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,64" id="srcline64"> 64</a></span><span class="line">   <span class="mxinfo" id="T28:U152"><span class="var type1" id="S42T28U225">Crw</span> = <span class="mxinfo" id="T28:U154">eye(3)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="49,65" id="srcline65"> 65</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,66" id="srcline66"> 66</a></span><span class="line"><span class="comment">%% 求惯性速度</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,67" id="srcline67"> 67</a></span><span class="line"><span class="mxinfo" id="T4:U155"><span class="keyword">for</span> <span class="var type1" id="S44T4U231">k</span>=<span class="var type1" id="S11T4U233">CalStartIN</span>:<span class="var type1" id="S12T4U234">CalEndIN</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,68" id="srcline68"> 68</a></span><span class="line"><span class="mxinfo" id="T4:U155">    <span class="mxinfo" id="T39:U159">[ <span class="var type1" id="S45T70U238">InertialVelocity_i</span>,<span class="var type1" id="S46T4U239">k_calV</span> ] = <span class="fcn" id="F166N9:B241">CalVelocity</span>( <span class="var type1" id="S4T13U242">InertialPosition</span>,<span class="var type1" id="S44T4U243">k</span>,<span class="var type1" id="S7T2U244">inertialFre</span>,<span class="mxinfo" id="T2:U165"><span class="var type1" id="S14T36U246">INSVNSCalibSet</span>.dT_CalV_Calib</span>,<span class="mxinfo" id="T2:U167"><span class="var type1" id="S14T36U249">INSVNSCalibSet</span>.MinXYVNorm_CalAngle</span> )</span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,69" id="srcline69"> 69</a></span><span class="line"><span class="mxinfo" id="T4:U155">    <span class="keyword">if</span> <span class="mxinfo" id="T19:U169"><span class="var type1" id="S46T4U254">k_calV</span>&gt;<span class="mxinfo" id="T2:U171">0</span></span></span> </span></span>
<span class="srcline"><span class="lineno"><a href="49,70" id="srcline70"> 70</a></span><span class="line"><span class="mxinfo" id="T4:U155">        <span class="mxinfo" id="T55:U172"><span class="mxinfo" id="T55:U173"><span class="var type1" id="S23T66U259">InertialVelocity</span>(:,<span class="var type1" id="S46T4U261">k_calV</span>)</span> = <span class="var type1" id="S45T70U262">InertialVelocity_i</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,71" id="srcline71"> 71</a></span><span class="line"><span class="mxinfo" id="T4:U155">    <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,72" id="srcline72"> 72</a></span><span class="line"><span class="mxinfo" id="T4:U155"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,73" id="srcline73"> 73</a></span><span class="line"><span class="comment">%% 单马克点跟踪 </span></span></span>
<span class="srcline"><span class="lineno"><a href="49,74" id="srcline74"> 74</a></span><span class="line">coder.extrinsic(<span class="string">'waitbar'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="49,75" id="srcline75"> 75</a></span><span class="line">coder.extrinsic(<span class="string">'close'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="49,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">%  wh = waitbar(0,'SearchDistanceK');</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,77" id="srcline77"> 77</a></span><span class="line"><span class="mxinfo" id="T4:U177"><span class="keyword">for</span> <span class="var type1" id="S44T4U277">k</span>=<span class="var type1" id="S9T4U279">CalStartVN</span>:<span class="var type1" id="S10T4U280">CalEndVN</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,78" id="srcline78"> 78</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="mxinfo" id="T41:U181"><span class="var type1" id="S48T41U283">otherMakers_k</span> = <span class="mxinfo" id="T41:U183"><span class="var type1" id="S3T1U285">otherMakers</span>(<span class="var type1" id="S44T4U286">k</span>)</span></span> ;</span>  </span></span>
<span class="srcline"><span class="lineno"><a href="49,79" id="srcline79"> 79</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="mxinfo" id="T4:U186"><span class="var type1" id="S49T4U289">inertial_k</span> = <span class="mxinfo" id="T4:U188"><span class="var type1" id="S48T41U291">otherMakers_k</span>.inertial_k</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,80" id="srcline80"> 80</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="49,81" id="srcline81"> 81</a></span><span class="line"><span class="mxinfo" id="T4:U177">    </span><span class="comment"><span class="mxinfo" id="T4:U177">%  last_dT_k</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,82" id="srcline82"> 82</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="mxinfo" id="T4:U190"><span class="var type1" id="S50T4U295">inertial_dT_k_last</span> = <span class="mxinfo" id="T2:U192"><span class="var type1" id="S49T4U297">inertial_k</span> - <span class="var type1" id="S17T2U298">dT_Ninertial</span></span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,83" id="srcline83"> 83</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="mxinfo" id="T4:U195"><span class="var type1" id="S50T4U301">inertial_dT_k_last</span> = <span class="mxinfo" id="T4:U197">max(<span class="var type1" id="S50T4U304">inertial_dT_k_last</span>,<span class="mxinfo" id="T2:U199">1</span>)</span></span>;</span>        </span></span>
<span class="srcline"><span class="lineno"><a href="49,84" id="srcline84"> 84</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,85" id="srcline85"> 85</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="keyword">if</span> <span class="mxinfo" id="T19:U200"><span class="var type1" id="S44T4U309">k</span>&gt;<span class="mxinfo" id="T2:U202">1</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,86" id="srcline86"> 86</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="mxinfo" id="T68:U203"><span class="var type1" id="S52T68U313">otherMakers_k_last</span> = <span class="mxinfo" id="T41:U205"><span class="var type1" id="S3T1U315">otherMakers</span>(<span class="mxinfo" id="T4:U207"><span class="var type1" id="S44T4U317">k</span>-<span class="mxinfo" id="T4:U209">1</span></span>)</span></span> ;</span> </span></span>
<span class="srcline"><span class="lineno"><a href="49,87" id="srcline87"> 87</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="keyword">if</span> coder.target(<span class="string">'MATLAB'</span>) &amp;&amp; isnan(<span class="var type0" id="S52T0U331">otherMakers_k_last</span>.ContinuesFlag) &amp;&amp; <span class="var type0" id="S52T0U335">otherMakers_k_last</span>.otherMakersN&gt;0</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,88" id="srcline88"> 88</a></span><span class="line"><span class="mxinfo" id="T4:U177">           fprintf(<span class="string">'判定第%0.0f个点时，前一个otherMakers点没有结果\n'</span>,<span class="var type0" id="S44T0U342">k</span>);</span> </span></span>
<span class="srcline"><span class="lineno"><a href="49,89" id="srcline89"> 89</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,90" id="srcline90"> 90</a></span><span class="line"><span class="mxinfo" id="T4:U177">        </span><span class="comment"><span class="mxinfo" id="T4:U177">% otherMakers_k_last 必须是更新了判定结果的，检查一下</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,91" id="srcline91"> 91</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="49,92" id="srcline92"> 92</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="49,93" id="srcline93"> 93</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         if k&gt;2 &amp;&amp; isnan(trackedMakerPosition(1,k-2))</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,94" id="srcline94"> 94</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%             if sum(otherMakers_k_last.ContinuesFlag==1)~=0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,95" id="srcline95"> 95</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%                disp('err')</span> </span></span></span>
<span class="srcline"><span class="lineno"><a href="49,96" id="srcline96"> 96</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%             end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,97" id="srcline97"> 97</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,98" id="srcline98"> 98</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="keyword">else</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,99" id="srcline99"> 99</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="mxinfo" id="T68:U210"><span class="var type1" id="S52T68U346">otherMakers_k_last</span> = <span class="mxinfo" id="T68:U212"><span class="fcn" id="F182N17:B348">GetEmpty_otherMakers</span>(<span class="var type1" id="S48T41U349">otherMakers_k</span>)</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,100" id="srcline100">100</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,101" id="srcline101">101</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,102" id="srcline102">102</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="mxinfo" id="T39:U214">[ <span class="var type1" id="S20T44U354">trackedMakerPosition</span>(:,<span class="var type1" id="S44T4U356">k</span>),<span class="var type1" id="S56T41U357">otherMakersNew_k</span>,<span class="var type1" id="S21T15U359">TrackFlag</span>(<span class="var type1" id="S44T4U360">k</span>),<span class="var type1" id="S57T51U361">JudgeIndex</span>  ] = <span class="fcn" id="F285N18:B363">JudgeMaker</span><span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,103" id="srcline103">103</a></span><span class="line"><span class="mxinfo" id="T4:U177"><span class="mxinfo" id="T39:U214">        ( <span class="var type1" id="S48T41U364">otherMakers_k</span>,<span class="var type1" id="S52T68U365">otherMakers_k_last</span>,<span class="var type1" id="S44T4U366">k</span>,<span class="var type1" id="S49T4U367">inertial_k</span>,<span class="var type1" id="S20T44U368">trackedMakerPosition</span>,<span class="var type1" id="S4T13U369">InertialPosition</span>,<span class="var type1" id="S50T4U370">inertial_dT_k_last</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,104" id="srcline104">104</a></span><span class="line"><span class="mxinfo" id="T4:U177"><span class="mxinfo" id="T39:U214">        <span class="var type1" id="S13T34U371">makerTrackThreshold</span> )</span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,105" id="srcline105">105</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="keyword">if</span> coder.target(<span class="string">'MATLAB'</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,106" id="srcline106">106</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="var type0" id="S33T0U382">dPi_ConJudge</span>(<span class="var type0" id="S44T0U383">k</span>) = <span class="var type0" id="S57T0U385">JudgeIndex</span>.dPi_ConJudge  ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,107" id="srcline107">107</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="var type0" id="S34T0U390">dPError_dT_xy</span>(<span class="var type0" id="S44T0U391">k</span>) = <span class="var type0" id="S57T0U393">JudgeIndex</span>.dPError_dT_xy ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,108" id="srcline108">108</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="var type0" id="S35T0U398">dPError_dT_z</span>(<span class="var type0" id="S44T0U399">k</span>) = <span class="var type0" id="S57T0U401">JudgeIndex</span>.dPError_dT_z ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,109" id="srcline109">109</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="var type0" id="S36T0U406">dPError_dS_xyNorm</span>(<span class="var type0" id="S44T0U407">k</span>) = <span class="var type0" id="S57T0U409">JudgeIndex</span>.dPError_dS_xyNorm ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,110" id="srcline110">110</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="var type0" id="S37T0U414">dP_Inertial_xyNorm</span>(<span class="var type0" id="S44T0U415">k</span>) = <span class="var type0" id="S57T0U417">JudgeIndex</span>.dP_Inertial_xyNorm ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,111" id="srcline111">111</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="var type0" id="S39T0U422">angleErr_dT_Min</span>(<span class="var type0" id="S44T0U423">k</span>) = <span class="var type0" id="S57T0U425">JudgeIndex</span>.angleErr_dT_Min ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,112" id="srcline112">112</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="var type0" id="S38T0U430">angleErr_dS</span>(<span class="var type0" id="S44T0U431">k</span>) = <span class="var type0" id="S57T0U433">JudgeIndex</span>.angleErr_dS ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,113" id="srcline113">113</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="var type0" id="S41T0U438">INSVNSMarkHC_Min</span>(<span class="var type0" id="S44T0U439">k</span>) = <span class="var type0" id="S57T0U441">JudgeIndex</span>.INSVNSMarkHC_Min ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,114" id="srcline114">114</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,115" id="srcline115">115</a></span><span class="line">       </span></span>
<span class="srcline"><span class="lineno"><a href="49,116" id="srcline116">116</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="keyword">if</span> <span class="mxinfo" id="T19:U229"><span class="mxinfo" id="T2:U230">sum(<span class="mxinfo" id="T52:U231"><span class="mxinfo" id="T7:U232"><span class="var type1" id="S56T41U451">otherMakersNew_k</span>.ContinuesFlag</span>==<span class="mxinfo" id="T2:U234">1</span></span>)</span>~=<span class="mxinfo" id="T2:U235">0</span></span> &amp;&amp; <span class="mxinfo" id="T19:U236">isnan(<span class="mxinfo" id="T2:U237"><span class="var type1" id="S20T44U458">trackedMakerPosition</span>(<span class="mxinfo" id="T2:U239">1</span>,<span class="var type1" id="S44T4U460">k</span>)</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,117" id="srcline117">117</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="mxinfo" id="T2:U241"><span class="mxinfo" id="T2:U242"><span class="var type1" id="S40T15U464">ConTrackedFailed</span>(<span class="var type1" id="S44T4U465">k</span>)</span> = <span class="mxinfo" id="T2:U245">1</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,118" id="srcline118">118</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="keyword">else</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,119" id="srcline119">119</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="mxinfo" id="T2:U246"><span class="mxinfo" id="T2:U247"><span class="var type1" id="S40T15U471">ConTrackedFailed</span>(<span class="var type1" id="S44T4U472">k</span>)</span> = <span class="mxinfo" id="T2:U250">0</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,120" id="srcline120">120</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,121" id="srcline121">121</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="49,122" id="srcline122">122</a></span><span class="line"><span class="mxinfo" id="T4:U177">    </span><span class="comment"><span class="mxinfo" id="T4:U177">%% 求  INSMarkH0  VNSMarkH0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,123" id="srcline123">123</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="keyword">if</span> <span class="mxinfo" id="T19:U251">isnan(<span class="mxinfo" id="T2:U252"><span class="var type1" id="S13T34U480">makerTrackThreshold</span>.INSMarkH0</span>)</span> &amp;&amp; <span class="mxinfo" id="T19:U254">~<span class="mxinfo" id="T19:U255">isnan(<span class="mxinfo" id="T2:U256"><span class="var type1" id="S20T44U486">trackedMakerPosition</span>(<span class="mxinfo" id="T2:U258">1</span>,<span class="var type1" id="S44T4U488">k</span>)</span>)</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,124" id="srcline124">124</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="mxinfo" id="T90:U260"><span class="extrinsicFcn" id="F565N42:B491">fprintf</span>( <span class="mxinfo" id="T101:U261"><span class="string">'第一个点搜素成功 time = %0.1f sec, TrackFlag(%d) = %0.1f ,'</span></span>,<span class="mxinfo" id="T4:U262"><span class="var type1" id="S44T4U494">k</span>/<span class="var type1" id="S6T2U495">visionFre</span></span>,<span class="var type1" id="S44T4U496">k</span>,<span class="mxinfo" id="T2:U266"><span class="var type1" id="S21T15U498">TrackFlag</span>(<span class="var type1" id="S44T4U499">k</span>)</span> )</span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,125" id="srcline125">125</a></span><span class="line"><span class="mxinfo" id="T4:U177">        </span><span class="comment"><span class="mxinfo" id="T4:U177">% 检测Hip的俯仰和横滚小才取值！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,126" id="srcline126">126</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="mxinfo" id="T2:U269"><span class="mxinfo" id="T2:U270"><span class="var type1" id="S13T34U503">makerTrackThreshold</span>.INSMarkH0</span> = <span class="mxinfo" id="T2:U272">- <span class="mxinfo" id="T2:U273"><span class="var type1" id="S4T13U507">InertialPosition</span>(<span class="mxinfo" id="T2:U275">3</span>,<span class="var type1" id="S49T4U509">inertial_k</span>)</span></span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,127" id="srcline127">127</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="mxinfo" id="T2:U277"><span class="mxinfo" id="T2:U278"><span class="var type1" id="S13T34U513">makerTrackThreshold</span>.VNSMarkH0</span> = <span class="mxinfo" id="T2:U280">- <span class="mxinfo" id="T2:U281"><span class="var type1" id="S20T44U517">trackedMakerPosition</span>(<span class="mxinfo" id="T2:U283">3</span>,<span class="var type1" id="S44T4U519">k</span>)</span></span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,128" id="srcline128">128</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="49,129" id="srcline129">129</a></span><span class="line"> </span></span>
<span class="srcline"><span class="lineno"><a href="49,130" id="srcline130">130</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         HipQuaternion_k = HipQuaternion( :,inertial_k );</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,131" id="srcline131">131</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         HipAttitude = GetHipAttitude( HipQuaternion_k );</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,132" id="srcline132">132</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%</span>         </span></span></span>
<span class="srcline"><span class="lineno"><a href="49,133" id="srcline133">133</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         HipQuaternion_k = Qinv( HipQuaternion_k ) ; % 四元数定义由 顺时针 改为 逆时针。</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,134" id="srcline134">134</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%</span>         </span></span></span>
<span class="srcline"><span class="lineno"><a href="49,135" id="srcline135">135</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         CHip_k = Q2C(HipQuaternion_k);</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,136" id="srcline136">136</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%</span>         </span></span></span>
<span class="srcline"><span class="lineno"><a href="49,137" id="srcline137">137</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         C_HipLUF_NED0 = RotateX(pi/2) * RotateY(-pi/2);  % Hip 的左上前系 到 NED的0姿态系</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,138" id="srcline138">138</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         C_NED_HipNED0 = C_HipLUF_NED0 * CHip_k ;</span>               </span></span></span>
<span class="srcline"><span class="lineno"><a href="49,139" id="srcline139">139</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         Attitude = C2Euler( C_NED_HipNED0,'ZYX' )*180/pi</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,140" id="srcline140">140</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="49,141" id="srcline141">141</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="49,142" id="srcline142">142</a></span><span class="line"><span class="mxinfo" id="T4:U177">        </span><span class="comment"><span class="mxinfo" id="T4:U177">%% 第一次跟踪马克点成功</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,143" id="srcline143">143</a></span><span class="line"><span class="mxinfo" id="T4:U177">        </span><span class="comment"><span class="mxinfo" id="T4:U177">% 标定视觉与光学的原点（不考虑方向差）</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,144" id="srcline144">144</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         Xrw_r = trackedMakerPosition(1:2,k) - InertialPosition(1:2,inertial_k);</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,145" id="srcline145">145</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         Xrw_r = [Xrw_r;0];</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,146" id="srcline146">146</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         N_otherMakers = length( otherMakers );</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,147" id="srcline147">147</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         for i=1:N_otherMakers</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,148" id="srcline148">148</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%             if ~isempty(otherMakers(i).Position)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,149" id="srcline149">149</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%                 m = size( otherMakers(i).Position,2 );</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,150" id="srcline150">150</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%                 otherMakers(i).Position = otherMakers(i).Position - repmat(Xrw_r,1,m) ;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,151" id="srcline151">151</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%                 trackedMakerPosition(:,i) = trackedMakerPosition(:,i) - Xrw_r ;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,152" id="srcline152">152</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%             end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,153" id="srcline153">153</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,154" id="srcline154">154</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,155" id="srcline155">155</a></span><span class="line"><span class="mxinfo" id="T4:U177">    </span><span class="comment"><span class="mxinfo" id="T4:U177">%% 求视觉速度</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,156" id="srcline156">156</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="mxinfo" id="T39:U285">[ <span class="var type1" id="S60T70U523">trackedMarkerVelocity_k</span>,<span class="var type1" id="S46T4U524">k_calV</span> ] = <span class="fcn" id="F300N9:B526">CalVelocity</span><span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,157" id="srcline157">157</a></span><span class="line"><span class="mxinfo" id="T4:U177"><span class="mxinfo" id="T39:U285">        ( <span class="var type1" id="S20T44U527">trackedMakerPosition</span>,<span class="var type1" id="S44T4U528">k</span>,<span class="var type1" id="S6T2U529">visionFre</span>,<span class="mxinfo" id="T2:U291"><span class="var type1" id="S14T36U531">INSVNSCalibSet</span>.dT_CalV_Calib</span>,<span class="mxinfo" id="T2:U293"><span class="var type1" id="S14T36U534">INSVNSCalibSet</span>.MinXYVNorm_CalAngle</span> )</span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,158" id="srcline158">158</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="keyword">if</span> <span class="mxinfo" id="T19:U295"><span class="var type1" id="S46T4U539">k_calV</span>&gt;<span class="mxinfo" id="T2:U297">0</span></span></span> </span></span>
<span class="srcline"><span class="lineno"><a href="49,159" id="srcline159">159</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="mxinfo" id="T55:U298"><span class="mxinfo" id="T55:U299"><span class="var type1" id="S22T54U544">trackedMarkerVelocity</span>(:,<span class="var type1" id="S46T4U546">k_calV</span>)</span> = <span class="var type1" id="S60T70U547">trackedMarkerVelocity_k</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,160" id="srcline160">160</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="keyword">if</span> <span class="mxinfo" id="T19:U303"><span class="var type1" id="S26T2U551">IsCalibDataEnough</span>==<span class="mxinfo" id="T2:U305">0</span></span>   </span><span class="comment"><span class="mxinfo" id="T4:U177">% 只搜索一次</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,161" id="srcline161">161</a></span><span class="line"><span class="mxinfo" id="T4:U177">        </span><span class="comment"><span class="mxinfo" id="T4:U177">%% 搜索可用于标定的数据</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,162" id="srcline162">162</a></span><span class="line"><span class="mxinfo" id="T4:U177">    </span><span class="comment"><span class="mxinfo" id="T4:U177">%         dbstop in SearchCalibData</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,163" id="srcline163">163</a></span><span class="line"><span class="mxinfo" id="T4:U177">            <span class="mxinfo" id="T2:U306"><span class="var type1" id="S61T2U555">Calib_N_Last</span> = <span class="var type1" id="S25T2U556">Calib_N_New</span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,164" id="srcline164">164</a></span><span class="line"><span class="mxinfo" id="T4:U177">            <span class="mxinfo" id="T53:U309">[ <span class="var type1" id="S24T53U560">INSVNSCalib_VS_k</span>,<span class="var type1" id="S25T2U561">Calib_N_New</span>,<span class="var type1" id="S26T2U562">IsCalibDataEnough</span>,<span class="var type1" id="S62T71U563">dX_Vision</span> ] = <span class="fcn" id="F321N34:B565">SearchCalibData</span><span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,165" id="srcline165">165</a></span><span class="line"><span class="mxinfo" id="T4:U177"><span class="mxinfo" id="T53:U309">                ( <span class="var type1" id="S24T53U566">INSVNSCalib_VS_k</span>,<span class="var type1" id="S61T2U567">Calib_N_Last</span>,<span class="var type1" id="S22T54U568">trackedMarkerVelocity</span>,<span class="var type1" id="S20T44U569">trackedMakerPosition</span>,<span class="var type1" id="S46T4U570">k_calV</span>,<span class="var type1" id="S14T36U571">INSVNSCalibSet</span> )</span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,166" id="srcline166">166</a></span><span class="line"><span class="mxinfo" id="T4:U177">            <span class="keyword">if</span> <span class="mxinfo" id="T19:U320"><span class="var type1" id="S26T2U575">IsCalibDataEnough</span>==<span class="mxinfo" id="T2:U322">1</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,167" id="srcline167">167</a></span><span class="line"><span class="mxinfo" id="T4:U177">                <span class="mxinfo" id="T90:U323"><span class="extrinsicFcn" id="F578N42:B579">fprintf</span>( <span class="mxinfo" id="T102:U324"><span class="string">'第一个用于坐标系映射计算的点OK，time = %0.1f sec \n'</span></span>,<span class="mxinfo" id="T4:U325"><span class="var type1" id="S44T4U582">k</span>/<span class="var type1" id="S6T2U583">visionFre</span></span> )</span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,168" id="srcline168">168</a></span><span class="line"><span class="mxinfo" id="T4:U177">                <span class="mxinfo" id="T28:U328"><span class="var type1" id="S42T28U586">Crw</span> = <span class="mxinfo" id="T28:U330"><span class="fcn" id="F531N25:B588">INSVNSCalib</span>( <span class="var type1" id="S24T53U589">INSVNSCalib_VS_k</span>,<span class="var type1" id="S25T2U590">Calib_N_New</span>,<span class="var type1" id="S62T71U591">dX_Vision</span>,<span class="var type1" id="S4T13U592">InertialPosition</span> )</span></span>;</span>                 </span></span>
<span class="srcline"><span class="lineno"><a href="49,169" id="srcline169">169</a></span><span class="line"><span class="mxinfo" id="T4:U177">            <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,170" id="srcline170">170</a></span><span class="line"><span class="mxinfo" id="T4:U177">        <span class="keyword">end</span></span>        </span></span>
<span class="srcline"><span class="lineno"><a href="49,171" id="srcline171">171</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,172" id="srcline172">172</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="mxinfo" id="T41:U335"><span class="var type1" id="S56T41U595">otherMakersNew_k</span> = <span class="mxinfo" id="T41:U337"><span class="fcn" id="F550N15:B597">CompensateSecond</span>( <span class="var type1" id="S56T41U598">otherMakersNew_k</span>,<span class="var type1" id="S42T28U599">Crw</span>  )</span></span>;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,173" id="srcline173">173</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="mxinfo" id="T41:U340"><span class="mxinfo" id="T41:U341"><span class="var type1" id="S3T1U603">otherMakers</span>(<span class="var type1" id="S44T4U604">k</span>)</span>=<span class="var type1" id="S56T41U605">otherMakersNew_k</span></span>;     </span><span class="comment"><span class="mxinfo" id="T4:U177">% 更新 otherMakers(k)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,174" id="srcline174">174</a></span><span class="line"><span class="mxinfo" id="T4:U177">    </span><span class="comment"><span class="mxinfo" id="T4:U177">%% 转成惯性马克点的时序</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,175" id="srcline175">175</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="49,176" id="srcline176">176</a></span><span class="line"><span class="mxinfo" id="T4:U177">    <span class="mxinfo" id="T6:U345"><span class="mxinfo" id="T6:U346"><span class="var type1" id="S19T13U609">trackedMakerPosition_InertialTime</span>(:,<span class="var type1" id="S49T4U611">inertial_k</span>)</span> = <span class="mxinfo" id="T6:U349"><span class="var type1" id="S20T44U613">trackedMakerPosition</span>(:,<span class="var type1" id="S44T4U615">k</span>)</span></span> ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,177" id="srcline177">177</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%</span>     </span></span></span>
<span class="srcline"><span class="lineno"><a href="49,178" id="srcline178">178</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%     if mod(k,fix(MarkerTN/10))==0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,179" id="srcline179">179</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%         waitbar(k/MarkerTN);</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,180" id="srcline180">180</a></span><span class="line"><span class="comment"><span class="mxinfo" id="T4:U177">%     end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,181" id="srcline181">181</a></span><span class="line"><span class="mxinfo" id="T4:U177"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,182" id="srcline182">182</a></span><span class="line"><span class="comment">%  close(wh);</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,183" id="srcline183">183</a></span><span class="line"> <span class="comment">%% Output</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,184" id="srcline184">184</a></span><span class="line"><span class="mxinfo" id="T13:U352"><span class="var type1" id="S2T13U618">trackedMakerPosition_InertialTime_Out</span> = <span class="var type1" id="S19T13U619">trackedMakerPosition_InertialTime</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,185" id="srcline185">185</a></span><span class="line"> </span></span>
<span class="srcline"><span class="lineno"><a href="49,186" id="srcline186">186</a></span><span class="line"> <span class="comment">%% result analyse</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,187" id="srcline187">187</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,188" id="srcline188">188</a></span><span class="line"><span class="keyword">if</span> coder.target(<span class="string">'MATLAB'</span>)  &amp;&amp; (<span class="var type0" id="S10T0U631">CalEndVN</span> == <span class="var type0" id="S27T0U632">MarkerTN</span>  || <span class="var type0" id="S12T0U634">CalEndIN</span> &gt;= <span class="var type0" id="S29T0U636">InertialN</span>-2  )</span></span>
<span class="srcline"><span class="lineno"><a href="49,189" id="srcline189">189</a></span><span class="line">     <span class="var type0" id="S66T0U641">trackedMaker</span>.trackedMakerPosition = <span class="var type0" id="S20T0U643">trackedMakerPosition</span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,190" id="srcline190">190</a></span><span class="line"><span class="comment">%      trackedMaker.time = otherMakersTime ;</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,191" id="srcline191">191</a></span><span class="line">     <span class="var type0" id="S66T0U647">trackedMaker</span>.MarkerSet = <span class="var type0" id="S3T0U651">otherMakers</span>(1).MarkerSet ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,192" id="srcline192">192</a></span><span class="line">     <span class="var type0" id="S67T0U656">N</span> = length(<span class="var type0" id="S20T0U659">trackedMakerPosition</span>) ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,193" id="srcline193">193</a></span><span class="line">    <span class="keyword">for</span> <span class="var type0" id="S44T0U662">k</span>=1:<span class="var type0" id="S67T0U665">N</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,194" id="srcline194">194</a></span><span class="line">        <span class="var type0" id="S3T0U670">otherMakers</span>(<span class="var type0" id="S44T0U671">k</span>).trackedMakerPosition = <span class="var type0" id="S20T0U674">trackedMakerPosition</span>(:,<span class="var type0" id="S44T0U676">k</span>) ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,195" id="srcline195">195</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,196" id="srcline196">196</a></span><span class="line">    <span class="keyword">for</span> <span class="var type0" id="S44T0U679">k</span>=1:<span class="var type0" id="S67T0U682">N</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,197" id="srcline197">197</a></span><span class="line">        <span class="var type0" id="S68T0U685">i</span> = <span class="var type0" id="S67T0U688">N</span>-<span class="var type0" id="S44T0U689">k</span>+1;</span></span>
<span class="srcline"><span class="lineno"><a href="49,198" id="srcline198">198</a></span><span class="line">        <span class="keyword">if</span> ~isnan(<span class="var type0" id="S20T0U697">trackedMakerPosition</span>(1,<span class="var type0" id="S68T0U699">i</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="49,199" id="srcline199">199</a></span><span class="line">            <span class="var type0" id="S66T0U703">trackedMaker</span>.LastMakerPosition = <span class="var type0" id="S20T0U706">trackedMakerPosition</span>(:,<span class="var type0" id="S68T0U708">i</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="49,200" id="srcline200">200</a></span><span class="line">            <span class="var type0" id="S66T0U712">trackedMaker</span>.LastMakerTime = <span class="var type0" id="S3T0U716">otherMakers</span>(<span class="var type0" id="S68T0U717">i</span>).time ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,201" id="srcline201">201</a></span><span class="line">            <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,202" id="srcline202">202</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,203" id="srcline203">203</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,204" id="srcline204">204</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="49,205" id="srcline205">205</a></span><span class="line">    DrawTracedINSVNS( <span class="var type0" id="S21T0U723">TrackFlag</span>,<span class="var type0" id="S66T0U724">trackedMaker</span>,<span class="var type0" id="S4T0U725">InertialPosition</span>,<span class="var type0" id="S22T0U726">trackedMarkerVelocity</span>,<span class="var type0" id="S23T0U727">InertialVelocity</span>,<span class="var type0" id="S24T0U728">INSVNSCalib_VS_k</span>,<span class="var type0" id="S14T0U729">INSVNSCalibSet</span> ) ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,206" id="srcline206">206</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="49,207" id="srcline207">207</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,208" id="srcline208">208</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,209" id="srcline209">209</a></span><span class="line"><span class="keyword">if</span> coder.target(<span class="string">'MATLAB'</span>) &amp;&amp; (<span class="var type0" id="S10T0U741">CalEndVN</span> == <span class="var type0" id="S27T0U742">MarkerTN</span>  || <span class="var type0" id="S12T0U744">CalEndIN</span> &gt;= <span class="var type0" id="S29T0U746">InertialN</span>-2  )</span></span>
<span class="srcline"><span class="lineno"><a href="49,210" id="srcline210">210</a></span><span class="line">    <span class="var type0" id="S70T0U750">otherMakersTime</span> = ( 1:<span class="var type0" id="S27T0U755">MarkerTN</span> )/1;</span></span>
<span class="srcline"><span class="lineno"><a href="49,211" id="srcline211">211</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,212" id="srcline212">212</a></span><span class="line">    figure(<span class="string">'name'</span>,<span class="string">'trackFlag'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,213" id="srcline213">213</a></span><span class="line">    plot(<span class="var type0" id="S21T0U765">TrackFlag</span>,<span class="string">'.'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,214" id="srcline214">214</a></span><span class="line">    <span class="comment">% plot(otherMakersTime,TrackFlag,'.')</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,215" id="srcline215">215</a></span><span class="line">    <span class="comment">% xlabel('time sec')</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,216" id="srcline216">216</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,217" id="srcline217">217</a></span><span class="line">    figure(<span class="string">'name'</span>,<span class="string">'dPi_ConJudge'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,218" id="srcline218">218</a></span><span class="line">    plot(<span class="var type0" id="S70T0U775">otherMakersTime</span>,<span class="var type0" id="S33T0U776">dPi_ConJudge</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,219" id="srcline219">219</a></span><span class="line">    <span class="var type0" id="S73T0U779">temp</span> = <span class="var type0" id="S13T0U781">makerTrackThreshold</span>.MaxContinuesDisplacement ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,220" id="srcline220">220</a></span><span class="line">    line( [<span class="var type0" id="S70T0U789">otherMakersTime</span>(1) <span class="var type0" id="S70T0U792">otherMakersTime</span>(<span class="var type0" id="S27T0U793">MarkerTN</span>)],[<span class="var type0" id="S73T0U796">temp</span> <span class="var type0" id="S73T0U797">temp</span>],<span class="string">'color'</span>,<span class="string">'r'</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,221" id="srcline221">221</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,222" id="srcline222">222</a></span><span class="line">    xlabel(<span class="string">'time sec'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,223" id="srcline223">223</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,224" id="srcline224">224</a></span><span class="line">    figure(<span class="string">'name'</span>,<span class="string">'INSVNSMarkHC_Min'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,225" id="srcline225">225</a></span><span class="line">    plot(<span class="var type0" id="S70T0U812">otherMakersTime</span>,<span class="var type0" id="S41T0U813">INSVNSMarkHC_Min</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,226" id="srcline226">226</a></span><span class="line">    <span class="var type0" id="S73T0U816">temp</span> = <span class="var type0" id="S13T0U818">makerTrackThreshold</span>.MaxMarkHighChange ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,227" id="srcline227">227</a></span><span class="line">    line( [<span class="var type0" id="S70T0U826">otherMakersTime</span>(1) <span class="var type0" id="S70T0U829">otherMakersTime</span>(<span class="var type0" id="S27T0U830">MarkerTN</span>)],[<span class="var type0" id="S73T0U833">temp</span> <span class="var type0" id="S73T0U834">temp</span>],<span class="string">'color'</span>,<span class="string">'r'</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,228" id="srcline228">228</a></span><span class="line">    <span class="var type0" id="S73T0U839">temp</span> = -<span class="var type0" id="S13T0U842">makerTrackThreshold</span>.MaxMarkHighChange ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,229" id="srcline229">229</a></span><span class="line">    line( [<span class="var type0" id="S70T0U850">otherMakersTime</span>(1) <span class="var type0" id="S70T0U853">otherMakersTime</span>(<span class="var type0" id="S27T0U854">MarkerTN</span>)],[<span class="var type0" id="S73T0U857">temp</span> <span class="var type0" id="S73T0U858">temp</span>],<span class="string">'color'</span>,<span class="string">'r'</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,230" id="srcline230">230</a></span><span class="line">    xlabel(<span class="string">'time sec'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,231" id="srcline231">231</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,232" id="srcline232">232</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,233" id="srcline233">233</a></span><span class="line">    figure(<span class="string">'name'</span>,<span class="string">'dPError_dT_xy'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,234" id="srcline234">234</a></span><span class="line">    plot(<span class="var type0" id="S70T0U873">otherMakersTime</span>,<span class="var type0" id="S34T0U874">dPError_dT_xy</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,235" id="srcline235">235</a></span><span class="line">    <span class="var type0" id="S73T0U877">temp</span> = <span class="var type0" id="S13T0U879">makerTrackThreshold</span>.PositionErrorBear_dT ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,236" id="srcline236">236</a></span><span class="line">    line( [<span class="var type0" id="S70T0U887">otherMakersTime</span>(1) <span class="var type0" id="S70T0U890">otherMakersTime</span>(<span class="var type0" id="S27T0U891">MarkerTN</span>)],[<span class="var type0" id="S73T0U894">temp</span> <span class="var type0" id="S73T0U895">temp</span>],<span class="string">'color'</span>,<span class="string">'r'</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,237" id="srcline237">237</a></span><span class="line">    xlabel(<span class="string">'time sec'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,238" id="srcline238">238</a></span><span class="line">    legend( <span class="string">'dPError\_dT\_xy'</span>,<span class="string">'PositionErrorBear\_dT'</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,239" id="srcline239">239</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,240" id="srcline240">240</a></span><span class="line">    figure(<span class="string">'name'</span>,<span class="string">'dPError_dT_z'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,241" id="srcline241">241</a></span><span class="line">    plot(<span class="var type0" id="S70T0U915">otherMakersTime</span>,<span class="var type0" id="S35T0U916">dPError_dT_z</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,242" id="srcline242">242</a></span><span class="line">    <span class="var type0" id="S73T0U919">temp</span> = <span class="var type0" id="S13T0U921">makerTrackThreshold</span>.PositionErrorBear_dT ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,243" id="srcline243">243</a></span><span class="line">    line( [<span class="var type0" id="S70T0U929">otherMakersTime</span>(1) <span class="var type0" id="S70T0U932">otherMakersTime</span>(<span class="var type0" id="S27T0U933">MarkerTN</span>)],[<span class="var type0" id="S73T0U936">temp</span> <span class="var type0" id="S73T0U937">temp</span>],<span class="string">'color'</span>,<span class="string">'r'</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,244" id="srcline244">244</a></span><span class="line">    xlabel(<span class="string">'time sec'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,245" id="srcline245">245</a></span><span class="line">    legend( <span class="string">'dPError\_dT\_z'</span>,<span class="string">'PositionErrorBear\_dT'</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,246" id="srcline246">246</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,247" id="srcline247">247</a></span><span class="line">    figure(<span class="string">'name'</span>,<span class="string">'dP_Inertial_xyNorm'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,248" id="srcline248">248</a></span><span class="line">    plot(<span class="var type0" id="S70T0U957">otherMakersTime</span>,<span class="var type0" id="S37T0U958">dP_Inertial_xyNorm</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,249" id="srcline249">249</a></span><span class="line">    <span class="var type0" id="S73T0U961">temp</span> = <span class="var type0" id="S13T0U963">makerTrackThreshold</span>.MaxStaticDisp_dT ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,250" id="srcline250">250</a></span><span class="line">    line( [<span class="var type0" id="S70T0U971">otherMakersTime</span>(1) <span class="var type0" id="S70T0U974">otherMakersTime</span>(<span class="var type0" id="S27T0U975">MarkerTN</span>)],[<span class="var type0" id="S73T0U978">temp</span> <span class="var type0" id="S73T0U979">temp</span>],<span class="string">'color'</span>,<span class="string">'r'</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,251" id="srcline251">251</a></span><span class="line">    xlabel(<span class="string">'time sec'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,252" id="srcline252">252</a></span><span class="line">    legend( <span class="string">'dPError\_dT'</span>,<span class="string">'MaxStaticDisp\_dT'</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,253" id="srcline253">253</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,254" id="srcline254">254</a></span><span class="line">    figure(<span class="string">'name'</span>,<span class="string">'angleErr_dT_Min'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,255" id="srcline255">255</a></span><span class="line">    plot(<span class="var type0" id="S70T0U999">otherMakersTime</span>,<span class="var type0" id="S39T0U1002">angleErr_dT_Min</span>*180/pi)</span></span>
<span class="srcline"><span class="lineno"><a href="49,256" id="srcline256">256</a></span><span class="line">    <span class="var type0" id="S73T0U1008">temp</span> = <span class="var type0" id="S13T0U1012">makerTrackThreshold</span>.Max_dPAngle_dS*180/pi ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,257" id="srcline257">257</a></span><span class="line">    line( [<span class="var type0" id="S70T0U1023">otherMakersTime</span>(1) <span class="var type0" id="S70T0U1026">otherMakersTime</span>(<span class="var type0" id="S27T0U1027">MarkerTN</span>)],[<span class="var type0" id="S73T0U1030">temp</span> <span class="var type0" id="S73T0U1031">temp</span>],<span class="string">'color'</span>,<span class="string">'r'</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,258" id="srcline258">258</a></span><span class="line">    xlabel(<span class="string">'time sec'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,259" id="srcline259">259</a></span><span class="line">    legend( <span class="string">'dPError\_dT'</span>,<span class="string">'MaxStaticDisp\_dT'</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,260" id="srcline260">260</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,261" id="srcline261">261</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,262" id="srcline262">262</a></span><span class="line">    figure(<span class="string">'name'</span>,<span class="string">'dPError_dS_xyNorm'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,263" id="srcline263">263</a></span><span class="line">    plot(<span class="var type0" id="S70T0U1051">otherMakersTime</span>,<span class="var type0" id="S36T0U1052">dPError_dS_xyNorm</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,264" id="srcline264">264</a></span><span class="line">    <span class="var type0" id="S73T0U1055">temp</span> = <span class="var type0" id="S13T0U1057">makerTrackThreshold</span>.MaxPositionError_dS ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,265" id="srcline265">265</a></span><span class="line">    line( [<span class="var type0" id="S70T0U1065">otherMakersTime</span>(1) <span class="var type0" id="S70T0U1068">otherMakersTime</span>(<span class="var type0" id="S27T0U1069">MarkerTN</span>)],[<span class="var type0" id="S73T0U1072">temp</span> <span class="var type0" id="S73T0U1073">temp</span>],<span class="string">'color'</span>,<span class="string">'r'</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,266" id="srcline266">266</a></span><span class="line">    xlabel(<span class="string">'time sec'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,267" id="srcline267">267</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,268" id="srcline268">268</a></span><span class="line">    figure(<span class="string">'name'</span>,<span class="string">'angleErr_dS'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,269" id="srcline269">269</a></span><span class="line">    plot(<span class="var type0" id="S70T0U1088">otherMakersTime</span>,<span class="var type0" id="S38T0U1091">angleErr_dS</span>*180/pi)</span></span>
<span class="srcline"><span class="lineno"><a href="49,270" id="srcline270">270</a></span><span class="line">    <span class="var type0" id="S73T0U1097">temp</span> = <span class="var type0" id="S13T0U1101">makerTrackThreshold</span>.Max_dPAngle_dS*180/pi ;</span></span>
<span class="srcline"><span class="lineno"><a href="49,271" id="srcline271">271</a></span><span class="line">    line( [<span class="var type0" id="S70T0U1112">otherMakersTime</span>(1) <span class="var type0" id="S70T0U1115">otherMakersTime</span>(<span class="var type0" id="S27T0U1116">MarkerTN</span>)],[<span class="var type0" id="S73T0U1119">temp</span> <span class="var type0" id="S73T0U1120">temp</span>],<span class="string">'color'</span>,<span class="string">'r'</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="49,272" id="srcline272">272</a></span><span class="line">    xlabel(<span class="string">'time sec'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,273" id="srcline273">273</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,274" id="srcline274">274</a></span><span class="line">    figure(<span class="string">'name'</span>,<span class="string">'ConTrackedFailed'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,275" id="srcline275">275</a></span><span class="line">    plot(<span class="var type0" id="S40T0U1135">ConTrackedFailed</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,276" id="srcline276">276</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,277" id="srcline277">277</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,278" id="srcline278">278</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,279" id="srcline279">279</a></span><span class="line">    <span class="var type0" id="S78T0U1138">FailTrackFlagNum</span> = sum( <span class="var type0" id="S21T0U1142">TrackFlag</span>&lt;=0 );</span></span>
<span class="srcline"><span class="lineno"><a href="49,280" id="srcline280">280</a></span><span class="line">    fprintf( <span class="string">'FailTrackFlagNum=%d ( %0.3f ) \n'</span>,<span class="var type0" id="S78T0U1148">FailTrackFlagNum</span>,<span class="var type0" id="S78T0U1150">FailTrackFlagNum</span>/length(<span class="var type0" id="S21T0U1153">TrackFlag</span>) );</span></span>
<span class="srcline"><span class="lineno"><a href="49,281" id="srcline281">281</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,282" id="srcline282">282</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,283" id="srcline283">283</a></span><span class="line"><span class="comment">%% 阈值参数设置</span></span></span>
</pre>
