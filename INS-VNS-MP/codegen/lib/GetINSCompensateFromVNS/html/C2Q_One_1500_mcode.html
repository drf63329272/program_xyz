<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="126,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="126,22" id="srcline22">22</a></span><span class="line"><span class="comment">%% 利用非对角线的6个数的方法</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,23" id="srcline23">23</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S12T62U52">Q</span> = C2Q_One_1(<span class="var type1" id="S13T28U55">Cnb</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="126,24" id="srcline24">24</a></span><span class="line">coder.extrinsic(<span class="string">'format'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="126,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo" id="T90:U3"><span class="extrinsicFcn" id="F581N41:B63">format</span> <span class="mxinfo" id="T88:U4"><span class="string">long</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="126,26" id="srcline26">26</a></span><span class="line"><span class="comment">% 根据初始姿态矩阵Cnb计算初始姿态四元数</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,27" id="srcline27">27</a></span><span class="line"><span class="comment">% 参考《高钟毓P17》</span></span></span>
<span class="srcline"><span class="lineno"><a href="126,28" id="srcline28">28</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="126,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo" id="T2:U5"><span class="var type1" id="S16T2U67">q0</span> = <span class="mxinfo" id="T2:U7"><span class="mxinfo" id="T2:U8">1/2</span>*<span class="mxinfo" id="T2:U9">sqrt( <span class="mxinfo" id="T2:U10"><span class="mxinfo" id="T2:U11"><span class="mxinfo" id="T2:U12"><span class="mxinfo" id="T2:U13">1</span>+<span class="mxinfo" id="T2:U14"><span class="var type1" id="S13T28U79">Cnb</span>(<span class="mxinfo" id="T2:U16">1</span>,<span class="mxinfo" id="T2:U17">1</span>)</span></span>+<span class="mxinfo" id="T2:U18"><span class="var type1" id="S13T28U83">Cnb</span>(<span class="mxinfo" id="T2:U20">2</span>,<span class="mxinfo" id="T2:U21">2</span>)</span></span>+<span class="mxinfo" id="T2:U22"><span class="var type1" id="S13T28U87">Cnb</span>(<span class="mxinfo" id="T2:U24">3</span>,<span class="mxinfo" id="T2:U25">3</span>)</span></span> )</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="126,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo" id="T2:U26"><span class="var type1" id="S18T2U92">q1</span> = <span class="mxinfo" id="T2:U28"><span class="mxinfo" id="T2:U29"><span class="mxinfo" id="T2:U30">1</span>/(<span class="mxinfo" id="T2:U31"><span class="mxinfo" id="T2:U32">4</span>*<span class="var type1" id="S16T2U99">q0</span></span>)</span>*(<span class="mxinfo" id="T2:U34"><span class="mxinfo" id="T2:U35"><span class="var type1" id="S13T28U103">Cnb</span>(<span class="mxinfo" id="T2:U37">2</span>,<span class="mxinfo" id="T2:U38">3</span>)</span>-<span class="mxinfo" id="T2:U39"><span class="var type1" id="S13T28U107">Cnb</span>(<span class="mxinfo" id="T2:U41">3</span>,<span class="mxinfo" id="T2:U42">2</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,31" id="srcline31">31</a></span><span class="line"><span class="mxinfo" id="T2:U43"><span class="var type1" id="S19T2U112">q2</span> = <span class="mxinfo" id="T2:U45"><span class="mxinfo" id="T2:U46"><span class="mxinfo" id="T2:U47">1</span>/(<span class="mxinfo" id="T2:U48"><span class="mxinfo" id="T2:U49">4</span>*<span class="var type1" id="S16T2U119">q0</span></span>)</span>*(<span class="mxinfo" id="T2:U51"><span class="mxinfo" id="T2:U52"><span class="var type1" id="S13T28U123">Cnb</span>(<span class="mxinfo" id="T2:U54">3</span>,<span class="mxinfo" id="T2:U55">1</span>)</span>-<span class="mxinfo" id="T2:U56"><span class="var type1" id="S13T28U127">Cnb</span>(<span class="mxinfo" id="T2:U58">1</span>,<span class="mxinfo" id="T2:U59">3</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo" id="T2:U60"><span class="var type1" id="S20T2U132">q3</span> = <span class="mxinfo" id="T2:U62"><span class="mxinfo" id="T2:U63"><span class="mxinfo" id="T2:U64">1</span>/(<span class="mxinfo" id="T2:U65"><span class="mxinfo" id="T2:U66">4</span>*<span class="var type1" id="S16T2U139">q0</span></span>)</span>*(<span class="mxinfo" id="T2:U68"><span class="mxinfo" id="T2:U69"><span class="var type1" id="S13T28U143">Cnb</span>(<span class="mxinfo" id="T2:U71">1</span>,<span class="mxinfo" id="T2:U72">2</span>)</span>-<span class="mxinfo" id="T2:U73"><span class="var type1" id="S13T28U147">Cnb</span>(<span class="mxinfo" id="T2:U75">2</span>,<span class="mxinfo" id="T2:U76">1</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,33" id="srcline33">33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="126,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo" id="T62:U77"><span class="var type1" id="S12T62U152">Q</span>=<span class="mxinfo" id="T62:U79">[<span class="var type1" id="S16T2U155">q0</span>;<span class="var type1" id="S18T2U157">q1</span>;<span class="var type1" id="S19T2U159">q2</span>;<span class="var type1" id="S20T2U161">q3</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo" id="T62:U84"><span class="var type1" id="S12T62U164">Q</span>=<span class="mxinfo" id="T62:U86"><span class="var type1" id="S12T62U166">Q</span>/<span class="mxinfo" id="T2:U88">norm(<span class="var type1" id="S12T62U169">Q</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="126,36" id="srcline36">36</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="126,37" id="srcline37">37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="126,38" id="srcline38">38</a></span><span class="line"><span class="comment">%% 只利用对角线的方法</span></span></span>
</pre>
