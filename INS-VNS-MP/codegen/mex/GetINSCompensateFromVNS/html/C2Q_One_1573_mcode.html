<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="136,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="136,22" id="srcline22">22</a></span><span class="line"><span class="comment">%% 利用非对角线的6个数的方法</span></span></span>
<span class="srcline"><span class="lineno"><a href="136,23" id="srcline23">23</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S12T71U52">Q</span> = C2Q_One_1(<span class="var type1" id="S13T29U55">Cnb</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="136,24" id="srcline24">24</a></span><span class="line">coder.extrinsic(<span class="string">'format'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="136,25" id="srcline25">25</a></span><span class="line">format <span class="string">long</span></span></span>
<span class="srcline"><span class="lineno"><a href="136,26" id="srcline26">26</a></span><span class="line"><span class="comment">% 根据初始姿态矩阵Cnb计算初始姿态四元数</span></span></span>
<span class="srcline"><span class="lineno"><a href="136,27" id="srcline27">27</a></span><span class="line"><span class="comment">% 参考《高钟毓P17》</span></span></span>
<span class="srcline"><span class="lineno"><a href="136,28" id="srcline28">28</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="136,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo" id="T2:U3"><span class="var type1" id="S16T2U67">q0</span> = <span class="mxinfo" id="T2:U5"><span class="mxinfo" id="T2:U6">1/2</span>*<span class="mxinfo" id="T2:U7">sqrt( <span class="mxinfo" id="T2:U8"><span class="mxinfo" id="T2:U9"><span class="mxinfo" id="T2:U10"><span class="mxinfo" id="T2:U11">1</span>+<span class="mxinfo" id="T2:U12"><span class="var type1" id="S13T29U79">Cnb</span>(<span class="mxinfo" id="T2:U14">1</span>,<span class="mxinfo" id="T2:U15">1</span>)</span></span>+<span class="mxinfo" id="T2:U16"><span class="var type1" id="S13T29U83">Cnb</span>(<span class="mxinfo" id="T2:U18">2</span>,<span class="mxinfo" id="T2:U19">2</span>)</span></span>+<span class="mxinfo" id="T2:U20"><span class="var type1" id="S13T29U87">Cnb</span>(<span class="mxinfo" id="T2:U22">3</span>,<span class="mxinfo" id="T2:U23">3</span>)</span></span> )</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="136,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo" id="T2:U24"><span class="var type1" id="S18T2U92">q1</span> = <span class="mxinfo" id="T2:U26"><span class="mxinfo" id="T2:U27"><span class="mxinfo" id="T2:U28">1</span>/(<span class="mxinfo" id="T2:U29"><span class="mxinfo" id="T2:U30">4</span>*<span class="var type1" id="S16T2U99">q0</span></span>)</span>*(<span class="mxinfo" id="T2:U32"><span class="mxinfo" id="T2:U33"><span class="var type1" id="S13T29U103">Cnb</span>(<span class="mxinfo" id="T2:U35">2</span>,<span class="mxinfo" id="T2:U36">3</span>)</span>-<span class="mxinfo" id="T2:U37"><span class="var type1" id="S13T29U107">Cnb</span>(<span class="mxinfo" id="T2:U39">3</span>,<span class="mxinfo" id="T2:U40">2</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="136,31" id="srcline31">31</a></span><span class="line"><span class="mxinfo" id="T2:U41"><span class="var type1" id="S19T2U112">q2</span> = <span class="mxinfo" id="T2:U43"><span class="mxinfo" id="T2:U44"><span class="mxinfo" id="T2:U45">1</span>/(<span class="mxinfo" id="T2:U46"><span class="mxinfo" id="T2:U47">4</span>*<span class="var type1" id="S16T2U119">q0</span></span>)</span>*(<span class="mxinfo" id="T2:U49"><span class="mxinfo" id="T2:U50"><span class="var type1" id="S13T29U123">Cnb</span>(<span class="mxinfo" id="T2:U52">3</span>,<span class="mxinfo" id="T2:U53">1</span>)</span>-<span class="mxinfo" id="T2:U54"><span class="var type1" id="S13T29U127">Cnb</span>(<span class="mxinfo" id="T2:U56">1</span>,<span class="mxinfo" id="T2:U57">3</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="136,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo" id="T2:U58"><span class="var type1" id="S20T2U132">q3</span> = <span class="mxinfo" id="T2:U60"><span class="mxinfo" id="T2:U61"><span class="mxinfo" id="T2:U62">1</span>/(<span class="mxinfo" id="T2:U63"><span class="mxinfo" id="T2:U64">4</span>*<span class="var type1" id="S16T2U139">q0</span></span>)</span>*(<span class="mxinfo" id="T2:U66"><span class="mxinfo" id="T2:U67"><span class="var type1" id="S13T29U143">Cnb</span>(<span class="mxinfo" id="T2:U69">1</span>,<span class="mxinfo" id="T2:U70">2</span>)</span>-<span class="mxinfo" id="T2:U71"><span class="var type1" id="S13T29U147">Cnb</span>(<span class="mxinfo" id="T2:U73">2</span>,<span class="mxinfo" id="T2:U74">1</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="136,33" id="srcline33">33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="136,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo" id="T71:U75"><span class="var type1" id="S12T71U152">Q</span>=<span class="mxinfo" id="T71:U77">[<span class="var type1" id="S16T2U155">q0</span>;<span class="var type1" id="S18T2U157">q1</span>;<span class="var type1" id="S19T2U159">q2</span>;<span class="var type1" id="S20T2U161">q3</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="136,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo" id="T71:U82"><span class="var type1" id="S12T71U164">Q</span>=<span class="mxinfo" id="T71:U84"><span class="var type1" id="S12T71U166">Q</span>/<span class="mxinfo" id="T2:U86">norm(<span class="var type1" id="S12T71U169">Q</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="136,36" id="srcline36">36</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="136,37" id="srcline37">37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="136,38" id="srcline38">38</a></span><span class="line"><span class="comment">%% 只利用对角线的方法</span></span></span>
</pre>
